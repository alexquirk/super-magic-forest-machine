<!DOCTYPE html>
<html lang="en">

<!-- HEAD-->
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Magic Forest Machine</title>
    <link rel="stylesheet" href="styles.CSS">
    <style> @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap'); </style>
    
    <!-- TRYING TO DISABLE PULL-DOWN REFRESH -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/inobounce/0.2.0/inobounce.js"></script>

    <!-- TRYING TO DISABLE PINTEREST, via   https://help.pinterest.com/en/business/article/prevent-saves-to-pinterest-from-your-site -->
    <meta name="pinterest" content="nopin" />

</head>
<body>


<!-- THE MACHINE -->

<!-- XXXXXXXXXX bring this back when done testing -->
<img id="titlecard" src="./extraimages/titlecard.png" onclick="startGame()">
<img id="titlecardtext" src="./extraimages/titlecardtext.png" onclick="startGame()">
<video id="sparkles" autoplay="autoplay" muted playsinline loop onclick="startGame()">
    <source src="./extraimages/sparkles.mp4" type="video/mp4" control="none">
</video>


<div id="largecutsceneviewer" >
    <video poster="./cutscenes/loadingleaf.gif"  id="largecutscenevideo" autoplay="autoplay" muted playsinline onclick="doubleTapSkip()">
        <source src="./cutscenes/introcutscene.mp4" type="video/mp4" control="none">
    </video>
</div>

<div id="wificard">
    Slow internet detected!<br><br>
    For the best experience wait<br>
    for an improved connection or<br>
    proceed with cutscenes disabled.<br>
    <br><br>
    <button type="button" onclick="disableCutscenes()">continue without cutscenes</button>
    <br>
    <button type="button" onclick="hideWifiCard()">continue with cutscenes</button>
</div>

<div id="errorcard">
    ERROR!<br>
    You busted up the game.<br>
    Enter password to continue:<br>
    <div id="errorinputarea">
        <input type="text" id="erroruserinput" maxlength="30" placeholder="password">
        <input type="button" id="errorenterbutton" value="ENTER" onclick="checkErrorPassword()">
    </div>
</div>

<!-- <div id="loadingscreen">
    <div>
        <div id="loadingword">Loading...</div>
        <img src="./cutscenes/smallloading.gif" id="loadingword">
        <div id="loadingbarcontainer">
            <div id="loadingbar"></div>
        </div>
    </div>
</div> -->

<article id="themachine">

    <!-- VIEWER -->
    <div id="viewbox">

        <!-- border -->
        <img id="border1" src="./roomimages/border 1.png">

        <div id="viewer">
            <!-- black background -->
            <div id="blackbackground"></div>
            <!-- navigation arrows -->
            <img class="compasstriangles" id="northtriangle" src="./compasstriangles/north.png" onclick="goNorth()"><img class="compasstriangles" id="westtriangle" src="./compasstriangles/west.png" onclick="goWest()"><img class="compasstriangles" id="southtriangle" src="./compasstriangles/south.png" onclick="goSouth()"><img class="compasstriangles" id="easttriangle" src="./compasstriangles/east.png" onclick="goEast();"><img class="compasstriangles" id="uptriangle" src="./compasstriangles/up.png" onclick="goUp()"><img class="compasstriangles" id="downtriangle" src="./compasstriangles/down.png" onclick="goDown()">
            <!-- main viewer -->
            
            <div id="mapbox">
                <div id="cutsceneviewer">
                    <video poster=""  id="cutscenevideo" autoplay="autoplay" muted playsinline onclick="doubleTapSkip()">
                        <source src="./cutscenes/transitioncutscene.mp4" type="video/mp4" control="none">
                    </video>
                </div>
                <div id= "map">
                    <img class="room" id="room1"><img class="room" id="room2"><img class="room" id="room3"><img class="room" id="room4"><img class="room" id="room5"><img class="room" id="room6" src=""><img class="room" id="room7"><img class="room" id="room8"><img class="room" id="room9"><img class="room" id="room10"><img class="room" id="room11"><img class="room" id="room12"><img class="room" id="room13" src=""><img class="room" id="room14" src="./roomimages/smfmroom14.png"><img class="room" id="room15" src=""><img class="room" id="room16"><img class="room" id="room17"><img class="room" id="room18"><img class="room" id="extraroom">
                </div>       
            </div>     
            <div id="closeinventory" onclick="closeInventory()">back</div>
            <img id= "inventory1" src="./inventoryimages/rope.png">
                <button class="inventorybutton" id= "ropebutton" onclick="chestClick()" ></button>
                <button class="inventorybutton" id= "chestbutton" onclick="ropeClick()" ></button>
            <img id= "inventory2" src="./inventoryimages/ribbon.png">
                <button class="inventorybutton" id= "ribbonbutton" onclick="ribbonClick()"></button>
            <img id= "inventory3" src="./inventoryimages/mug.png">
                <button class="inventorybutton" id= "mugbutton" onclick="mugClick()"></button>
            <img id= "inventory4" src="./inventoryimages/key.png">
                <button class="inventorybutton" id= "keybutton" onclick="keyClick()"></button>
            <img id= "inventory5" src="./inventoryimages/crystal.png">
                <button class="inventorybutton" id= "crystalbutton" onclick="crystalClick()"></button>
            <img id= "inventory6" src="./inventoryimages/flower.png">
                <button class="inventorybutton" id= "flowerbutton" onclick="flowerClick()"></button>
            <img id= "inventory7" src="./inventoryimages/rock.png">
                <button class="inventorybutton" id= "rockbutton" onclick="rockClick()" ></button>
            <img id= "inventory8" src="./inventoryimages/stick.png">
                <button class="inventorybutton" id= "stickbutton" onclick="stickClick()"></button>
            <img id= "inventory9" src="./inventoryimages/battery.png">
                <button class="inventorybutton" id= "batterybutton" onclick="batteryClick()"></button>
            <img id= "book">
            <div id= "maptiles">
                <img class="roomtile" id="maparrow" src="./maptiles/maparrow.png"><img class="roomtile" id="room1tile" onclick="room1Switch()"><img class="roomtile" id="room2tile" onclick="room2Switch()"><img class="roomtile" id="room3tile" onclick="room3Switch()"><img class="roomtile" id="room4tile" onclick="room4Switch()"><img class="roomtile" id="room5tile" onclick="room5Switch()"><img class="roomtile" id="room6tile" onclick="room6Switch()"><img class="roomtile" id="room7tile" onclick="room7Switch()"><img class="roomtile" id="room8tile" onclick="room8Switch()"><img class="roomtile" id="room9tile" onclick="room9Switch()"><img class="roomtile" id="room10tile" onclick="room10Switch()"><img class="roomtile" id="room11tile" onclick="room11Switch()"><img class="roomtile" id="room12tile" onclick="room12Switch()"><img class="roomtile" id="room14tile" onclick="room14Switch()"><img class="roomtile" id="room15tile" onclick="room15Switch()">
            </div>   
        
        </div>

        <!-- border 2 -->
        <img id="border2" src="./roomimages/border 2.png">
    </div>

    <!-- OUTPUT AREA -->
    <div id="outputarea" onclick="clearMap()">
        <div id="output" >

                <!-- READ THIS :) -->

        </div>
        <div id="extraoutput" >

        </div>
        <div class="dialoguearea">
            <button type="button" id="dialogue1" class="dialogue" onclick="whiteButtonFlash(d1)">Option 1</button>
            <button type="button" id="dialogue2" class="dialogue" onclick="whiteButtonFlash(d2)">Option 2</button>
            <button type="button" id="leavebutton" class="dialogue" onclick="whiteButtonFlash(leaveButton)">leave conversation</button>
            <input type="button" id="bookbutton" class="dialogue" value="> Read Journal" onclick="whiteButtonFlash(bookButton)">
        </div>
        <div id = "scrollicon"></div>
    </div>
    
     <!-- INPUT AREA -->
<div id="inputarea">
    <input type="text" id="userinput" maxlength="30" onclick="clearMap()" placeholder="type something">
    <input type="button" id="enterbutton" value="ENTER" >
</div>
</article>



</body>











<!-- SCRIPT -->
<script>

// PRESS ANY KEY TO CONTINUE

const titleCard = document.getElementById('titlecard');
const titleCardText = document.getElementById('titlecardtext');

const wifiCard = document.getElementById('wificard');

const sparkles = document.getElementById('sparkles');

const theMachine = document.getElementById('themachine');

const viewbox = document.getElementById('viewbox');

let introCutscenePlayed = false;
let introCutsceneDonePlaying = false;
let introCutsceneFirstHalfDonePlaying = false;

let cutscenesEnabled = true;

// show wificard

const showWifiCard = () => {
    // show wificard
    // setTimeout(function() {
        wifiCard.style.display = "table";
        wifiCard.classList.add('machinefadein');
        largeCutsceneVideo.classList.add('blur');
    // }, 1000)
}

const hideWifiCard = () => {
    wifiCard.classList.add('fadeout');
    setTimeout(function() {wifiCard.style.display = "none"}, 1000);
    largeCutsceneVideo.play();
    largeCutsceneVideo.classList.remove('blur');

    // cutsceneVideo.play();
}

const disableCutscenes = () => {
    cutscenesEnabled = false;
    endCutscene();
    hideWifiCard();
}

// const hideWifiCard = () =>

//start game
const startGame = () => {
    // hide the title cards
    titleCard.classList.add('fadeout');
    sparkles.classList.add('fadeout');
    titleCardText.classList.add('longfadeout');
    setTimeout(function() {titleCard.style.display = "none"; sparkles.style.display = "none"}, 1000);
    setTimeout(function() {titleCardText.style.display = "none"}, 1500);
    // make the machine appear
    setTimeout(function() {
        theMachine.style.display = "flex";
        // theMachine.classList.add('machinefadein');
        largeCutsceneViewer.classList.add('machinefadein');
        document.getElementById('border1').style.opacity= "0";
        document.getElementById('border2').style.opacity= "0";
        // play the cutscene
        playCutscene();
        // how much time after pressing space on the title card must pass before pressing space again will skip the first cutscene?
        setTimeout(function() {introCutscenePlayed = true}, 1000);
    }, 1000)
};
    
//start game if enter is pressed
document.onkeydown = e => { 
    if (!introCutscenePlayed)
        {
        startGame();
        }
};

// big intro screen shift

const introScreenShift = () => {
        //move the input and output around
        outputArea.classList.add('boxfadein');
        inputArea.classList.add('textfadein');
        outputArea.style.display = "block";
        inputArea.style.display = "flex";
        output.style.display = 'block';
        output.style.opacity = "0";
        outputArea.style.zIndex = "-1";
        // bring the output back to the top (we pushed it to the back above because it looked weird over the viewbox while stuff was moving around)
        setTimeout(function() { 
            outputArea.style.zIndex = "0";
            }, 
            2000);
            // how long till the text appears
        setTimeout(function() { 
            output.style.opacity = "1";
            output.classList.add('textfadein'); 
            }, 
            1400);
        // move the viewbox around
        viewbox.style.top = "0%";
        viewbox.style.transform = "translate(0, 0%)";
        viewbox.classList.add('movetheviewbox');
        document.getElementById('viewer').classList.add('vieweradjustmaxwidth');
        // make borders visible
        document.getElementById('border1').classList.add('machinefadein');
        document.getElementById('border2').classList.add('machinefadein');
        document.getElementById('viewer').classList.add('viewerborderfadein');
        // document.getElementById('viewer').style.border = "1px solid white";
        // document.getElementById('southtriangle').classList.add('textfadein');
        // setTimeout(function() {
        //     document.getElementById('southtriangle').classList.remove('southtrianglefadein');
        //     // document.getElementById('southtriangle').style.display = "inline";
        //     }, 1200)
        // get the game started
        room14Switch();
        room14.style.zIndex = "0";
        document.getElementById("room14tile").src="./maptiles/room14tile.png";
        roomNum = 14;
}


// CUTSCENES

    // list of cutscenes:
        // "intro"
        // "transition"
        // "robot waking"
        // "robot scanning"
        // "riding boat"
        // "ghost appearing"
        // "owl appearing"
        // "cat jumping"
        // "fireflies emerging"
        // "tree climb"
        // "well fall"
        // "swimming"
        // "basket"
        // "riding basket"
        // "ghost given mug"
        // "crystal break"
        
    let currentCutscene = "intro";

    const cutsceneVideo = document.getElementById("cutscenevideo");

    const cutsceneViewer = document.getElementById('cutsceneviewer');

    const largeCutsceneVideo = document.getElementById("largecutscenevideo");

    const largeCutsceneViewer = document.getElementById('largecutsceneviewer');

    let videoLoaded = false;

    // skipping cutscene function
    const skipCutscene = () => {
        if (introCutscenePlayed === true) // wait to let into cutscene load
                    if (currentCutscene !== "intro" && currentCutscene !== "transition"){
                        endCutscene(); // ends most cutscenes
                        introCutsceneDonePlaying = true;
                        introCutsceneFirstHalfDonePlaying = true;
                    } else if (inCutscene === true){ // ends intro cutscenes together
                        southTriangle.style.opacity = "75%";

                        cutsceneViewer.style.display = "none";
                        largeCutsceneViewer.style.display = "none";
                        currentCutscene = "";

                        introScreenShift();

                        // bring the leaf poster back
                        document.getElementById('cutscenevideo').setAttribute('poster','./cutscenes/loadingleaf.gif');
            
                        introCutsceneDonePlaying = true;
                        introCutsceneFirstHalfDonePlaying = true;
                    }
    }

    // skip cutscene if doubleclicked
    let tappedOnce = false;
    let spaceHitOnce = false;

    const doubleTapSkip = () => {
        if (tappedOnce === true) {
            skipCutscene(); 
            focusOnInputOnDesktop();
        };
        tappedOnce = true;
        setTimeout( function() { tappedOnce = false }, 300);
    }

    //skip cutscene if spacebar is pressed
    document.addEventListener('keyup', event => {
        if (event.code === 'Space'
                // uncomment line below to make first cutscene unskippable?
                // && introCutsceneDonePlaying === true 
            )

                {
                    // if (spaceHitOnce === true) {
                        skipCutscene(); 
                        // focusOnInputOnDesktop();
                    // };
                    // spaceHitOnce = true;
                    // setTimeout( function() { spaceHitOnce = false }, 400);
            }});

            
    // hide the video when its ended
    cutsceneVideo.addEventListener('ended', ()=> {
        endCutscene();
        });

        // hide the video when its ended
    largeCutsceneVideo.addEventListener('ended', ()=> {
        endCutscene();
        });

    // play the cutscene
    const playCutscene = () => {

        if (cutscenesEnabled === true) {

            videoLoaded = false;
            inCutscene = true;
            switch (true) {

                //intro cutscene
                case currentCutscene === "intro":
                    //make cutscene visible
                    largeCutsceneViewer.style.display = "flex";
                    // put it in the middle
                    viewbox.style.top = "50%";
                    viewbox.style.transform = "translate(0, -50%)";
                    //set source to correct video file
                    largeCutsceneVideo.src="./cutscenes/introcutscene.mp4";
                    // pause it to let it load
                    largeCutsceneVideo.pause();
                    // test user's wifi
                    setTimeout(function() { 
                        if (videoLoaded === false && inCutscene === true && introCutsceneFirstHalfDonePlaying === false) {
                            showWifiCard();
                            largeCutsceneVideo.pause();
                            cutsceneVideo.pause();
                        }
                        }, 
                        // this is how many seconds to load before showing wifi card / 2
                        10
                        *
                        1000 );

                    // unpause after 2.5 seconds
                    // setTimeout(()=> {
                        // just play it vvv
                        // largeCutsceneVideo.play();

                    // or wait till it can play through vvv
                    largeCutsceneVideo.addEventListener("canplaythrough", (event) => {
                        largeCutsceneVideo.play();
                        videoLoaded = true;
                        }
                        );

                        
                    
                        //     },
                        // 2500
                        // );

                    
                    break;



                // transition cutscene
                case currentCutscene === "transition":
                    //make cutscene visible
                    cutsceneViewer.style.display = "flex";
                    //set source to correct video file
                    cutsceneVideo.src="./cutscenes/transitioncutscene.mp4";
                    break;


                // robot waking
                case currentCutscene === "robot waking":
                    //make cutscene visible
                    cutsceneViewer.style.display = "flex";
                    //set source to correct video file
                    cutsceneVideo.src="./cutscenes/robotcutscene.mp4";
                    //change map image
                    room12.src="./roomimages/smfmroom12c.png";
                    break;

                // robot scanning
                case currentCutscene === "robot scanning":
                    //make cutscene visible
                    cutsceneViewer.style.display = "flex";
                    //set source to correct video file
                    cutsceneVideo.src="./cutscenes/robotscanningcutscene.mp4";
                    break;

                // ride the boat
                case currentCutscene === "riding boat":
                    //make cutscene visible
                    cutsceneViewer.style.display = "flex";
                    //set source to correct video file
                    cutsceneVideo.src="./cutscenes/boatcutscene.mp4";
                    break;

                // ghost appearing
                case currentCutscene === "ghost appearing":
                    //make cutscene visible
                    cutsceneViewer.style.display = "flex";
                    //set source to correct video file
                    cutsceneVideo.src="./cutscenes/ghostcutscene.mp4";
                    break;

                // fireflies emerging
                case currentCutscene === "fireflies emerging":
                    //make cutscene visible
                    cutsceneViewer.style.display = "flex";
                    //set source to correct video file
                    cutsceneVideo.src="./cutscenes/fireflycutscene.mp4";
                    break;

                // cat jumping
                case currentCutscene === "cat jumping":
                    //make cutscene visible
                    cutsceneViewer.style.display = "flex";
                    //set source to correct video file
                    cutsceneVideo.src="./cutscenes/marblecutscene.mp4";
                    break;

                // tree climb
                case currentCutscene === "tree climb":
                    //make cutscene visible
                    cutsceneViewer.style.display = "flex";
                    //set source to correct video file
                    cutsceneVideo.src="./cutscenes/treeclimbcutscene.mp4";
                    break;

                // swimming
                case currentCutscene === "swimming":
                    //make cutscene visible
                    cutsceneViewer.style.display = "flex";
                    //set source to correct video file
                    if (haveBoxKey === true) {
                        cutsceneVideo.src="./cutscenes/swimmingcutscene.mp4";
                    } else {
                        cutsceneVideo.src="./cutscenes/keycutscene.mp4";
                    }                
                    break;


                // well fall
                case currentCutscene === "well fall":
                    //make cutscene visible
                    cutsceneViewer.style.display = "flex";
                    //set source to correct video file
                    cutsceneVideo.src="./cutscenes/welljumpcutscene.mp4";
                    break;

                // basket
                case currentCutscene === "basket":
                    //make cutscene visible
                    cutsceneViewer.style.display = "flex";
                    //set source to correct video file
                    cutsceneVideo.src="./cutscenes/basketcutscene.mp4";
                    break;

                // basket ride
                case currentCutscene === "riding basket":
                //     //make cutscene visible
                    cutsceneViewer.style.display = "flex";
                //     //set source to correct video file
                    cutsceneVideo.src="./cutscenes/basketridecutscene.mp4";
                    break;

                // ghost given mug
                case currentCutscene === "ghost given mug":
                //     //make cutscene visible
                    cutsceneViewer.style.display = "flex";
                //     //set source to correct video file
                    cutsceneVideo.src="./cutscenes/ghostmugcutscene.mp4";
                    break;

                // crystal break
                case currentCutscene === "crystal break":
                //     //make cutscene visible
                    cutsceneViewer.style.display = "flex";
                //     //set source to correct video file
                    cutsceneVideo.src="./cutscenes/crystalbreak.mp4";
                    break;

                }
            };
        }

    // end the cutscene
    const endCutscene = () => {
        videoLoaded = false;
        inCutscene = false;
        switch (true) {
        //intro cutscene
        case currentCutscene === "intro":
            inCutscene = true;
            largeCutsceneViewer.style.display = "none";
            cutsceneViewer.style.display = "flex";
            currentCutscene = "transition";
            playCutscene();
            
            // do all the shit to get the game started
            setTimeout(function(){

                    introScreenShift();

                    },
                    2000);

            introCutsceneFirstHalfDonePlaying = true;

            break;

        // transition
        case currentCutscene === "transition":
            // bring the leaf poster back
            document.getElementById('cutscenevideo').setAttribute('poster','./cutscenes/loadingleaf.gif');
            cutsceneViewer.classList.add('longfadeout');
            setTimeout(function(){
                cutsceneViewer.classList.remove('longfadeout');
                cutsceneViewer.style.display = "none";
            },
            1500
            );
            
            introCutsceneDonePlaying = true;
            introCutsceneFirstHalfDonePlaying = true;
            break;

        // robot waking
        case currentCutscene === "robot waking":
            createRobotConversation();
            break;

        // robot scanning
        case currentCutscene === "robot scanning":
             
            break;

        // ride the boat
        case currentCutscene === "riding boat":
             
            break;

        // ghost appearing
        case currentCutscene === "ghost appearing":
            output.innerHTML = "A <span><button onclick='spanClick(\"inspect ghost\")'>ghost</button></span> appears!!"
            break;

        // fireflies emerging
        case currentCutscene === "fireflies emerging":
             
            break;

        // cat jumping
        case currentCutscene === "cat jumping":
                
            break;

        // tree climb
        case currentCutscene === "tree climb":
                
            break;

        // swimming
        case currentCutscene === "swimming":
            findKey();
            break;

        // ghost given mug
        case currentCutscene === "ghost given mug":
                
            break;

        // crystal break
        case currentCutscene === "crystal break":
            breakTheGame();
            break;
    
        // well fall
        case currentCutscene === "well fall":
            gamePoints += 5;
            output.innerHTML = "Oops...<br><br>You find yourself standing in front of an old <span><button onclick='spanClick(\"inspect well\")'>stone well.</button></span>";
            break;

        }    
        
        // generic
        if (currentCutscene !== 'transition') {
        setTimeout(function(){
            cutsceneViewer.style.display = "none";
            currentCutscene = "";
            }, 
            10);
        }
        theMachine.style.display = "flex";
        
    }


// the evil button
//                       <span><button onclick='spanClick(\"XOXOX\")'>XOXOX</button></span>
//                       <span><button onclick='spanClick(\"inspect box\")'>wooden box</button></span>

// BREAK THE GAME

const errorCard = document.getElementById('errorcard');

const breakTheGame = () => {
    theMachine.style.display = "none";
    showErrorCard();
};

const showErrorCard = () => {
    errorCard.style.display = "table";
    errorCard.classList.add('machinefadein');
};

//DECLARE VARIABLES

    const userInput = document.getElementById('userinput');
    const inputArea = document.getElementById('inputarea');
    
    const enterButton = document.getElementById('enterbutton');
    const mapArrow = document.getElementById('maparrow');
    const d1 = document.getElementById("dialogue1");
    const d2 = document.getElementById("dialogue2");
    const leaveButton = document.getElementById("leavebutton");
    const bookButton = document.getElementById("bookbutton");
    const map = document.getElementById("map");

    const northTriangle = document.getElementById("northtriangle");
    const southTriangle = document.getElementById("southtriangle");
    const eastTriangle = document.getElementById("easttriangle");
    const westTriangle = document.getElementById("westtriangle");

    const removeItem = (item) => {
        for ( var i = 0; i < inventory.length; i++) { 
            if (inventory[i] === (item)) { 
                inventory.splice(i, 1); 
            }    
        };               
    };    

    let roomNum = 14;

    let gamePoints = 0;

    let inCutscene = false;

    let checkingInventory = false;
    let inventoryAsk = false;
    let fixingBoat = false;
    let fixingMill = false;

    let currentPage = 0;
    let reading = false;
    let readingAsk = false;

    let checkingMap = false;
    let mapAsk = false;

    let currentRobotConversation = 0;
    let currentOwlConversation = 0; // needs to be 0
    let dialogueAsk = false;
    let inDialogue = false;

    let newGame = true;
    let doorUnlocked = false;
    let treeClimbed = false;
    let flowerSmelled = false;
    let treeHugged = false;
    let stumpSatOn = false;
    let catPet = false;
    let putRibbonInHair = false;
    let ropeSwing = false;
    let triedToThrowBox = false;
    let catAttacked = false;
    let decorateBox1 = false;
    let decorateBox2 = false;
    let decorateBox3 = false;
    let haveRock = false;
    let haveFlower = false;
    let bellRung = false;
    let basketRidden = false;
    let haveStick = false;
    let haveBattery = false;
    let boxUnlocked = false;
    let catDiscovered = false;
    let marbleDown = false;
    let marbleReunited = false;
    let marbleGone = false;
    let ropeTaken = false;
    let haveRope = false;
    let ropeSet = false;
    let haveBox = false;
    let haveBoxKey = false;
    let mugTaken = false;
    let haveMug = false;
    let crystalPlaced = false;
    let millSwitchOn = false;
    let ghostGivenFlower = false;
    let ghostGivenMug = false;
    let robotAwake = false;
    let haveCrystal = false;
    let haveFireflies = false;
    let firefliesReleased = false;
    let electroVineTaken = false;
    let haveRibbon = false;
    let foundBook = false;
    let haveMushy = false;
    let ghostDiscovered = false;
    let triedKeyOnDoor = false;
    let lakeDiscovered = false;
    let firefliesSeen = false;
    let waterSearchedOnce = false;
    let boatFixed = false;
    let mushyTaken = false;

    // taking the first mushroom sets the mushy-time-passed to 10. So, if mushy taken when mushy value is <1, set the time pass
    // taking any mushroom increased mushy value by 9
    // if, when mushy time passed = 0, mushy value is greater than 1, activate mushy!
    let mushyValue = 0;
    let mushyTimePassed = 0;

    let currentlyMoving = false;

    let haveMap = false; 
    let caveInspected = false;
    let doorInspected = false;

    let firstHint = false;
    let thingsTried = 0;
    let thingsTriedSinceLastBigThing = 0;
    let profanityCounter = 0;
    let sassyHint = false;
    let boxSmashed = 0;

    const roomVisited = ["", false, false, false, false, false, false, false, false, false, false, false, false, false, true, false, false, false, false];
    const inventory = [];

    profanityResponse = ["Hey now! This is a nice game.", "Oh c'mon.", ".....Alright...", "Seriously...?", "Okay, I'm gonna need you to stop that.", "This is getting old now.", "This is getting old now.", "This is getting REAALY old now.", "STOOOPPPPP", "I'M GONNA RESET THE GAME", "I'LL DO IT", "I'LL RESET THE GAME DON'T MAKE ME DO IT", "...", "...", "...", ">:(", "Okay I'm seriously done this time.", "Okay I'm seriously done this time.", "Okay for real I'm seriously done this time.", "I said I'M DONE THIS TIME", "Can't say I didn't warn you :P"]

// ZOOM FUNCTIONS

const robotZoom = () => {
    document.getElementById("room12").style.width = "200%";
    document.getElementById("room12").style.bottom = "-42%";
    document.getElementById("room12").style.left = "-15%";
};
const robotUnZoom = () => {
    document.getElementById("room12").style.width = "100%";
    document.getElementById("room12").style.bottom = "0%";
    document.getElementById("room12").style.left = "0%";
};
const wellZoom = () => {
    document.getElementById("room10").style.width = "180%";
    document.getElementById("room10").style.bottom = "-38%";
    document.getElementById("room10").style.left = "-38%";
};
const wellUnZoom = () => {
    document.getElementById("room10").style.width = "100%";
    document.getElementById("room10").style.bottom = "0%";
    document.getElementById("room10").style.left = "0%";
};
const doorZoom = () => {
    document.getElementById("room1").style.width = "160%";
    document.getElementById("room1").style.bottom = "-30%";
    document.getElementById("room1").style.left = "-32%";
};
const doorUnZoom = () => {
    document.getElementById("room1").style.width = "100%";
    document.getElementById("room1").style.bottom = "0%";
    document.getElementById("room1").style.left = "0%";
};
const stumpZoom = () => {
    document.getElementById("room3").style.width = "180%";
    document.getElementById("room3").style.bottom = "-28%";
    document.getElementById("room3").style.left = "-38%";
};
const bellZoom = () => {
    document.getElementById("room18").style.width = "200%";
    document.getElementById("room18").style.bottom = "-40%";
    document.getElementById("room18").style.left = "-47.5%";
};

const stumpUnZoom = () => {
    document.getElementById("room3").style.width = "100%";
    document.getElementById("room3").style.bottom = "0%";
    document.getElementById("room3").style.left = "0%";
};
const boatZoom = () => {
    document.getElementById("room6").style.width = "210%";
    document.getElementById("room6").style.bottom = "-25%";
    document.getElementById("room6").style.left = "-46%";
};
const watermillZoom = () => {
    document.getElementById("room16").style.width = "180%";
    document.getElementById("room16").style.bottom = "-20%";
    document.getElementById("room16").style.left = "-76%";
};
const boatUnZoom = () => {
    document.getElementById("room6").style.width = "100%";
    document.getElementById("room6").style.bottom = "0%";
    document.getElementById("room6").style.left = "0%";
};

const rocksZoom = () => {
    document.getElementById("room4").style.width = "180%";
    document.getElementById("room4").style.bottom = "-20%";
    document.getElementById("room4").style.left = "-10%";
};
const rocksUnZoom = () => {
    document.getElementById("room4").style.width = "100%";
    document.getElementById("room4").style.bottom = "0%";
    document.getElementById("room4").style.left = "0%";
};
const catTreeZoom = () => {
    document.getElementById("room4").style.width = "150%";
    document.getElementById("room4").style.bottom = "-54%";
    document.getElementById("room4").style.left = "-20%";
};
const catTreeUnZoom = () => {
    document.getElementById("room4").style.width = "100%";
    document.getElementById("room4").style.bottom = "0%";
    document.getElementById("room4").style.left = "0%";
};
const ghostZoom = () => {
    document.getElementById("room9").style.width = "200%";
    document.getElementById("room9").style.bottom = "-50%";
    document.getElementById("room9").style.left = "-45%";
};
const ghostUnZoom = () => {
    document.getElementById("room9").style.width = "100%";
    document.getElementById("room9").style.bottom = "0%";
    document.getElementById("room9").style.left = "0%";
};
const watermillUnZoom = () => {
    document.getElementById("room16").style.width = "100%";
    document.getElementById("room16").style.bottom = "0%";
    document.getElementById("room16").style.left = "0%";
};
const bellUnZoom = () => {
    document.getElementById("room18").style.width = "100%";
    document.getElementById("room18").style.bottom = "0%";
    document.getElementById("room18").style.left = "0%";
};

// GET POINTS AWARD POINTS

const getPoints = (points, condition) => {
    if (condition === false) {
        gamePoints = gamePoints + points;
        if (points < 0) {
            return "<span class = 'points'><br><br>" + points +" points<br>current score: " + gamePoints + "</span>";
        } else {
            return "<span class = 'points'><br><br>+" + points +" points<br>current score: " + gamePoints + "</span>";
        };
    } else { return "" }
};

const feelBad = () => {
    extraoutput.style.display = "block";
    extraoutput.innerHTML = "You feel bad about being mean to the cat." + getPoints(-10, false);
};

// SCROLLING SHADOWS via https://css-tricks.com/thats-just-how-i-scroll/

const outputArea = document.getElementById('outputarea');
const output = document.getElementById('output'); 
const extraoutput = document.getElementById('extraoutput');
const scrollicon = document.getElementById('scrollicon');

const makeScrollArrow = () => {
    if (outputArea.offsetHeight < (output.offsetHeight + extraoutput.offsetHeight) ) {
        scrollicon.style.display = "block";
    } else {
        scrollicon.style.display = "none";
    }
};

outputArea.onscroll = function() {
    scrollicon.style.display = "none";
};

// INVENTORY
    const checkInventory = () => {
        if (inventory.length === 0) {
            return "You don't have anything in your pockets.<br><br>Maybe there is something useful nearby you can take with you."
        } else {
            // undo finding objects animations
            // document.getElementById("inventory1").classList.remove('findobject');
            document.getElementById("inventory3").classList.remove('findobject');
            document.getElementById("inventory4").classList.remove('findkey');
            document.getElementById("inventory5").classList.remove('findobject');
            document.getElementById("inventory6").classList.remove('findobject');
            document.getElementById("inventory7").classList.remove('findobject');
            document.getElementById("inventory8").classList.remove('findobject');
            document.getElementById("inventory9").classList.remove('findobject');

            // display text
            let inventoryText = ["You have "];
            for (var i = 0; i < inventory.length - 1; i++) {
                inventoryText.push(" " + inventory[i] + ",");
            };
            if (inventory.length > 1) {
                inventoryText.push(" and " + inventory[inventory.length -1]+ " in your pocket.")
            } else {
                inventoryText.push(" " + inventory[inventory.length -1]+ " in your pocket.")
            };
            return inventoryText.join('');
        };
        // document.getElementById("map").classList.toggle('blur');
    };

    // Displaying Inventory Images
    const switchChestRopeImage = () => {
        if (haveFireflies === true && haveRope === true) {
                document.getElementById("inventory1").src="./inventoryimages/boxglowrope.png";
            } else if (haveFireflies === true && haveRope === false) {
                document.getElementById("inventory1").src="./inventoryimages/boxglow.png";
            } else if (boxUnlocked === true && haveRope === true) {
                document.getElementById("inventory1").src="./inventoryimages/boxopenrope.png";
            } else if (boxUnlocked === true && haveRope === false) {
                document.getElementById("inventory1").src="./inventoryimages/boxopen.png";
            } else if (haveBox === true && haveRope === true) {
                document.getElementById("inventory1").src="./inventoryimages/boxrope.png";
           } else if (haveBox === true) {
                document.getElementById("inventory1").src="./inventoryimages/box.png";
            } else if (haveRope === true) {
                document.getElementById("inventory1").src="./inventoryimages/rope.png";
            };
    };

    const displayInventory = () => {
            // if still in the animation to find, it removes it
            // document.getElementById("inventory1").classList.remove('findobject');
            document.getElementById("inventory3").classList.remove('findobject');
            document.getElementById("inventory4").classList.remove('findkey');
            document.getElementById("inventory5").classList.remove('findobject');
            document.getElementById("inventory6").classList.remove('findobject');
            document.getElementById("inventory7").classList.remove('findobject');
            document.getElementById("inventory8").classList.remove('findobject');
            document.getElementById("inventory9").classList.remove('findobject');

            if (inventory.length > 0) {
                checkingInventory = true;
                inventoryAsk = true;
                // blur the backfground
                map.classList.add('blur');
            };
            // bring buttons forward
            document.getElementById("chestbutton").zIndex = "200";   
            document.getElementById("ropebutton").zIndex = "201"; 
            document.getElementById("ribbonbutton").zIndex = "202"; 
            document.getElementById("mugbutton").zIndex = "203"; 
            document.getElementById("keybutton").zIndex = "204"; 
            document.getElementById("crystalbutton").zIndex = "205"; 
            document.getElementById("flowerbutton").zIndex = "206"; 
            document.getElementById("rockbutton").zIndex = "207"; 
            document.getElementById("stickbutton").zIndex = "208";    
            document.getElementById("batterybutton").zIndex = "200";     
 
            // display stuff by bringing it forward
            if (inventory.length > 0) {
                document.getElementById("closeinventory").style.zIndex = "200";
            };
            if (haveFlower === true) {
                    document.getElementById("inventory6").style.zIndex = "106";
            };
            if (haveRibbon === true) {
                    document.getElementById("inventory2").style.zIndex = "102";
            };
            if (haveBoxKey === true) {
                    document.getElementById("inventory4").style.zIndex = "104";
            };
            if (haveStick === true) {
                    document.getElementById("inventory8").style.zIndex = "108";
            };
            if (haveCrystal === true) {
                    document.getElementById("inventory5").style.zIndex = "105";
            };
            if (haveRock === true) {
                    document.getElementById("inventory7").style.zIndex = "107";
            };
            if (haveBattery === true) {
                    document.getElementById("inventory9").style.zIndex = "101";
            };
            if (haveBox === true || haveRope === true) {
                    document.getElementById("inventory1").style.zIndex = "101";
            };
            if (haveMug === true) {
                document.getElementById("inventory3").src="./inventoryimages/mug.png";
                document.getElementById("inventory3").style.zIndex = "103";
            } else if (haveMushy === true) {
                document.getElementById("inventory3").src="./inventoryimages/mushy.png";
                document.getElementById("inventory3").style.zIndex = "103";
            };
            // move stuff around when inventory is small
            if (inventory.length === 1) {
                // move mug
                document.getElementById("inventory3").style.left = "-26%";
                // move rock
                document.getElementById("inventory7").style.bottom = "20%"; 
                document.getElementById("inventory7").style.left = "28%";
                // move flower
                document.getElementById("inventory6").style.bottom = "10%"; 
                document.getElementById("inventory6").style.left = "13%";
                // move stick
                document.getElementById("inventory8").style.bottom = "25%"; 
                document.getElementById("inventory8").style.left = "-22%";
                // move rock button
                document.getElementById("rockbutton").style.top = "50%"; 
                document.getElementById("rockbutton").style.left = "47%";
                if (haveRock === true) {
                    document.getElementById("rockbutton").style.zIndex = "210";
                } else {
                    document.getElementById("rockbutton").style.zIndex = "207";
                };
                // move stick button
                document.getElementById("stickbutton").style.top = "36%"; 
                document.getElementById("stickbutton").style.left = "50%";
                if (haveStick === true) {
                    document.getElementById("stickbutton").style.zIndex = "210";
                } else {
                    document.getElementById("stickbutton").style.zIndex = "20";
                };
                // move flower button
                document.getElementById("flowerbutton").style.top = "40%"; 
                document.getElementById("flowerbutton").style.left = "45%";
                if (haveFlower === true) {
                    document.getElementById("flowerbutton").style.zIndex = "210";
                } else {
                    document.getElementById("flowerbutton").style.zIndex = "206";
                };                
            } else if (inventory.length === 2 && haveFlower === true && haveRock === true) {
                // move rock
                document.getElementById("inventory7").style.bottom = "10%"; 
                document.getElementById("inventory7").style.left = "20%";
                // move flower
                document.getElementById("inventory6").style.bottom = "14%"; 
                document.getElementById("inventory6").style.left = "23%";
                // move rock button
                document.getElementById("rockbutton").style.top = "60%"; 
                document.getElementById("rockbutton").style.left = "40%";
                document.getElementById("rockbutton").style.zIndex = "207";
                // move flower button
                document.getElementById("flowerbutton").style.top = "36%"; 
                document.getElementById("flowerbutton").style.left = "55%";
                document.getElementById("flowerbutton").style.zIndex = "206";
            } else if (inventory.length === 2 && haveFlower === true && haveStick === true) {
                // move flower
                document.getElementById("inventory6").style.bottom = "14%"; 
                document.getElementById("inventory6").style.left = "23%";
                // move stick
                document.getElementById("inventory8").style.bottom = "5%"; 
                document.getElementById("inventory8").style.left = "-15%";
                // move flower button
                document.getElementById("flowerbutton").style.top = "36%"; 
                document.getElementById("flowerbutton").style.left = "55%";
                document.getElementById("flowerbutton").style.zIndex = "206";
                // move stick button
                document.getElementById("stickbutton").style.top = "55%"; 
                document.getElementById("stickbutton").style.left = "57%";
                document.getElementById("stickbutton").style.zIndex = "208";
            } else if (inventory.length === 2 && haveRock === true && haveStick === true) {
                // move rock
                document.getElementById("inventory7").style.bottom = "10%"; 
                document.getElementById("inventory7").style.left = "20%";
                // move stick
                document.getElementById("inventory8").style.bottom = "5%"; 
                document.getElementById("inventory8").style.left = "-15%";
                // move rock button
                document.getElementById("rockbutton").style.top = "60%"; 
                document.getElementById("rockbutton").style.left = "40%";
                document.getElementById("rockbutton").style.zIndex = "207";
                // move stick button
                document.getElementById("stickbutton").style.top = "55%"; 
                document.getElementById("stickbutton").style.left = "57%";
                document.getElementById("stickbutton").style.zIndex = "208";
            } else if (inventory.length < 4 && haveFlower === true && haveRock === true && haveStick === true) {
                // move rock
                document.getElementById("inventory7").style.bottom = "10%"; 
                document.getElementById("inventory7").style.left = "12%";
                // move flower
                document.getElementById("inventory6").style.bottom = "14%"; 
                document.getElementById("inventory6").style.left = "23%";
                // move stick
                document.getElementById("inventory8").style.bottom = "5%"; 
                document.getElementById("inventory8").style.left = "-15%";
                // move rock button
                document.getElementById("rockbutton").style.top = "60%"; 
                document.getElementById("rockbutton").style.left = "32%";
                document.getElementById("rockbutton").style.zIndex = "207";
                // move flower button
                document.getElementById("flowerbutton").style.top = "36%"; 
                document.getElementById("flowerbutton").style.left = "55%";
                document.getElementById("flowerbutton").style.zIndex = "206";
                // move stick button
                document.getElementById("stickbutton").style.top = "55%"; 
                document.getElementById("stickbutton").style.left = "57%";
                document.getElementById("stickbutton").style.zIndex = "208";
            } else {
                // move mug
                document.getElementById("inventory3").style.left = "0%";
                // move rock
                document.getElementById("inventory7").style.bottom = "0%";
                document.getElementById("inventory7").style.left = "0%";
                // move flower
                document.getElementById("inventory6").style.bottom = "0%";
                document.getElementById("inventory6").style.left = "0%";
                // move stick
                document.getElementById("inventory8").style.bottom = "0%"; 
                document.getElementById("inventory8").style.left = "0%";
                // move rock button
                document.getElementById("rockbutton").style.top = "70%"; 
                document.getElementById("rockbutton").style.left = "19.5%";
                document.getElementById("rockbutton").style.zIndex = "207";
                // move stick button
                document.getElementById("stickbutton").style.top = "62%"; 
                document.getElementById("stickbutton").style.left = "71%";
                document.getElementById("stickbutton").style.zIndex = "208";
                // move flower button
                document.getElementById("flowerbutton").style.top = "50%"; 
                document.getElementById("flowerbutton").style.left = "32%";
                document.getElementById("flowerbutton").style.zIndex = "206";
            };
            // move triangles back
            northTriangle.style.zIndex = "-2";
            southTriangle.style.zIndex = "-2";
            eastTriangle.style.zIndex = "-2";
            westTriangle.style.zIndex = "-2";

    };

    // clicking inventory items / fixing boat
    const stickClick = () => {
        if (fixingBoat === true && haveStick === true) {
            output.innerHTML = "You push the stick into the hole, but it's too small, and water continues to leak into the boat."
        };
        if (fixingMill === true && haveStick === true) {
            millSwitchOn = true;
            room16Switch();
            currentCutscene = "basket";
            playCutscene();
            output.innerHTML = "You push the stick into the broken part of the mechanism, and you hear something click. After a few moments, the water mill begins to spin on it's axle.<br><br>Apparently set in motion by the watermill's mechanism, a rope with a basket large enough to sit in is lowered from the top of the wall.";
        };
    };
    const mugClick = () => {
        if (fixingBoat === true && haveMug === true) {
            output.innerHTML = "You push the mug into the hole, but it's a bit too big and the handle is in the way. Maybe something else will fit better."
        };
        if (fixingBoat === true && haveMushy === true) {
            boatFixed = true;
            removeItem("a <span><button onclick='spanClick(\"inspect mushroom\")'>wild mushroom</button></span>");
            haveMushy = false;
            boatZoom();
            room6Switch();
            closeInventory();
            output.innerHTML = "You push the mushroom into the hole, and it's a perfect fit. After bailing out water for a few minutes, the boat starts to float again." + getPoints(10, boatFixed);
        };
        if (fixingMill === true && haveMug === true) {
            output.innerHTML = "You don't see how that's going to work."
        };
    };
    const chestClick = () => {
        if (fixingBoat === true && haveBox === true) {
            output.innerHTML = "You try to stick the chest into the hole, but it's much too big."
        };
        if (fixingMill === true && haveBox === true) {
            output.innerHTML = "That's not going to work."
        };
    };
    const ropeClick = () => {
        if (fixingBoat === true && haveRope === true) {
            output.innerHTML = "You try to cram the rope into the hole, but there's too much if it and water keeps leaking through the cracks."
        };
        if (fixingMill === true && haveRope === true) {
            output.innerHTML = "You tie the rope to the wheel and give it a pull to try to jump-start it, but it remains idle."
        };
    };
    const crystalClick = () => {
        if (fixingBoat === true && haveCrystal === true) {
            output.innerHTML = "You push the crystal into the hole, but it's too smooth and slides right out."
        };
        if (fixingMill === true && haveCrystal === true) {
            output.innerHTML = "You don't see a way to use that here."
        };
    };
    const flowerClick = () => {
        if (fixingBoat === true && haveFlower === true) {
            output.innerHTML = "You try to plug the hole with the flower, but it's too small and fragile."
        };
        if (fixingMill === true && haveFlower === true) {
            output.innerHTML = "That's not going to be of any use here."
        };
    };
    const keyClick = () => {
        if (fixingBoat === true && haveBoxKey === true) {
            output.innerHTML = "You try to plug the hole with the key, but it's too small."
        };
        if (fixingMill === true && haveBoxKey === true) {
            output.innerHTML = "You push the key into the hole where the switch used to be, but it's not a very good fit."
        };
    };
    const ribbonClick = () => {
        if (fixingBoat === true && haveRibbon === true) {
            output.innerHTML = "You try to plug the hole with the ribbon, but it's much too small."
        };
        if (fixingMill === true && haveRibbon === true) {
            output.innerHTML = "You can't find a way to use that here."
        };
    };
    const rockClick = () => {
        if (fixingBoat === true && haveRock === true) {
            boatFixed = true;
            removeItem("a <span><button onclick='spanClick(\"inspect rock\")'>rock</button></span>");
            haveRock = false;
            boatZoom();
            room6Switch();
            closeInventory();
            output.innerHTML = "You plug the hole in the bottom of the boat with a rock. After bailing out water for a few minutes, the boat starts to float again." + getPoints(10, boatFixed);
        };
        if (fixingMill === true && haveRock === true) {
            output.innerHTML = "You try to unjam the mechanism with a rock, but without success. You'll need something longer to reach into where the lever has broken off.";
        };
    };
    const batteryClick = () => {
        if (fixingBoat === true && haveBattery === true) {
            output.innerHTML = "You try to plug the hole with the battery, but it's too smooth and pops right out."
        };
        if (fixingMill === true && haveRibbon === true) {
            output.innerHTML = "The mill is mechanical and doesn't need a battery."
        };
    };

    // close inventory
    const closeInventory = () => {
        checkingInventory = false;
        inventoryAsk = false;
        // output.innerHTML = "";
        document.getElementById("closeinventory").style.zIndex = "-2";
        document.getElementById('map').classList.remove('blur');
        document.getElementById("inventory1").style.zIndex = "-2";document.getElementById("inventory2").style.zIndex = "-2";document.getElementById("inventory3").style.zIndex = "-2";document.getElementById("inventory4").style.zIndex = "-2";document.getElementById("inventory5").style.zIndex = "-2";document.getElementById("inventory6").style.zIndex = "-2";document.getElementById("inventory7").style.zIndex = "-2";document.getElementById("inventory8").style.zIndex = "-2";document.getElementById("inventory9").style.zIndex = "-2";
        // move triangles back
        northTriangle.style.zIndex = "50";
        southTriangle.style.zIndex = "50";
        eastTriangle.style.zIndex = "50";
        westTriangle.style.zIndex = "50";
        // move buttons back
        document.getElementById("chestbutton").zIndex = "-2";   
        document.getElementById("ropebutton").zIndex = "-2"; 
        document.getElementById("ribbonbutton").zIndex = "-2"; 
        document.getElementById("mugbutton").zIndex = "-2"; 
        document.getElementById("keybutton").zIndex = "-2"; 
        document.getElementById("crystalbutton").zIndex = "-2"; 
        document.getElementById("flowerbutton").zIndex = "-2"; 
        document.getElementById("rockbutton").zIndex = "-2"; 
        document.getElementById("stickbutton").zIndex = "-2";     
        // focus
        if (!( 
                   navigator.userAgent.match(/Android/i)
                || navigator.userAgent.match(/webOS/i)
                || navigator.userAgent.match(/iPhone/i)
                || navigator.userAgent.match(/iPad/i)
                || navigator.userAgent.match(/iPod/i)
                || navigator.userAgent.match(/BlackBerry/i)
                || navigator.userAgent.match(/Windows Phone/i)
                )) {
            userInput.focus(); 
                } 
    };

    // Finding Things Animations
    const findKey = () => {
        document.getElementById("inventory4").style.zIndex = "104";
        document.getElementById("inventory4").style.bottom = "10%";
        document.getElementById("inventory4").style.left = "-4%";
        document.getElementById("inventory4").classList.add('findkey');
        setTimeout(function() {
            if (!checkingInventory && !inventoryAsk) {
                document.getElementById("inventory4").style.bottom = "0%";
                document.getElementById("inventory4").style.left = "0%";
                document.getElementById("inventory4").style.zIndex = "-2"}
                document.getElementById("inventory4").classList.remove('findkey');
            },
                2500
        )};

    const findObject = (objectFound) => {
        if (objectFound === "rock") {
            document.getElementById("inventory7").style.zIndex = "107";
            document.getElementById("inventory7").style.bottom = "20%"; 
            document.getElementById("inventory7").style.left = "28%";
            document.getElementById("inventory7").classList.add('findobject');
            setTimeout(function() {
                if (!checkingInventory && !inventoryAsk) {
                    document.getElementById("inventory7").style.zIndex = "-2";
                    document.getElementById("inventory7").style.bottom = "0%"; 
                    document.getElementById("inventory7").style.left = "0%";
                    document.getElementById("inventory7").classList.remove('findobject');}
                },
                    2500
        )};
        if (objectFound === "stick") {
            document.getElementById("inventory8").style.zIndex = "108";
            document.getElementById("inventory8").style.bottom = "25%"; 
            document.getElementById("inventory8").style.left = "-22%";
            document.getElementById("inventory8").classList.add('findobject');
            setTimeout(function() {
                if (!checkingInventory && !inventoryAsk) {
                document.getElementById("inventory8").style.zIndex = "-2";
                document.getElementById("inventory8").style.bottom = "0%"; 
                document.getElementById("inventory8").style.left = "0%";
                document.getElementById("inventory8").classList.remove('findobject');}
            },
                2500
        )};
        if (objectFound === "flower") {
            document.getElementById("inventory6").style.zIndex = "106";
            document.getElementById("inventory6").style.bottom = "10%"; 
            document.getElementById("inventory6").style.left = "13%";
            document.getElementById("inventory6").classList.add('findobject');
            setTimeout(function() {
                if (!checkingInventory && !inventoryAsk) {
                document.getElementById("inventory6").style.zIndex = "-2";
                document.getElementById("inventory6").style.bottom = "0%"; 
                document.getElementById("inventory6").style.left = "0%";
                document.getElementById("inventory6").classList.remove('findobject');}
            },
                2500
        )};
        if (objectFound === "mug") {
            document.getElementById("inventory3").style.zIndex = "106";
            document.getElementById("inventory3").style.bottom = "-10%"; 
            document.getElementById("inventory3").style.left = "-17%";
            document.getElementById("inventory3").style.height = "85%";
            document.getElementById("inventory3").classList.add('findobject');
            setTimeout(function() {
                if (!checkingInventory && !inventoryAsk) {
                document.getElementById("inventory3").style.zIndex = "-2";
                document.getElementById("inventory3").style.bottom = "0%"; 
                document.getElementById("inventory3").style.left = "0%";
                document.getElementById("inventory3").style.height = "100%";
                document.getElementById("inventory3").classList.remove('findobject');}
            },
                2500
        )};
        if (objectFound === "crystal") {
            document.getElementById("inventory5").style.zIndex = "105";
            document.getElementById("inventory5").style.bottom = "18%"; 
            document.getElementById("inventory5").style.left = "-17%";
            document.getElementById("inventory5").classList.add('findobject');
            setTimeout(function() {
                if (!checkingInventory && !inventoryAsk) {
                document.getElementById("inventory5").style.zIndex = "-2";
                document.getElementById("inventory5").style.bottom = "0%"; 
                document.getElementById("inventory5").style.left = "0%";
                document.getElementById("inventory5").classList.remove('findobject');}
            },
                2500
        )};
        // if (objectFound === "rope") {
        //     document.getElementById("inventory1").style.zIndex = "105";
        //     document.getElementById("inventory1").style.bottom = "-15%"; 
        //     document.getElementById("inventory1").style.left = "23%";
        //     document.getElementById("inventory1").style.height = "65%";
        //     document.getElementById("inventory1").classList.add('findobject');
        //     setTimeout(function() {
        //         if (!checkingInventory && !inventoryAsk) {
        //         document.getElementById("inventory1").style.zIndex = "-2";
        //         document.getElementById("inventory1").style.bottom = "0%"; 
        //         document.getElementById("inventory1").style.left = "0%";
        //         document.getElementById("inventory1").style.height = "100%";
        //         document.getElementById("inventory1").classList.remove('findobject');}
        //     },
        //         2500
        // )};
        // if (objectFound === "box" && haveRope === false) {
        //     document.getElementById("inventory1").style.zIndex = "105";
        //     document.getElementById("inventory1").style.bottom = "-18%"; 
        //     document.getElementById("inventory1").style.left = "20%";
        //     document.getElementById("inventory1").style.height = "70%";
        //     document.getElementById("inventory1").classList.add('findobject');
        //     setTimeout(function() {
        //         if (!checkingInventory && !inventoryAsk) {
        //         document.getElementById("inventory1").style.zIndex = "-2";
        //         document.getElementById("inventory1").style.bottom = "0%"; 
        //         document.getElementById("inventory1").style.left = "0%";
        //         document.getElementById("inventory1").style.height = "100%";
        //         document.getElementById("inventory1").classList.remove('findobject');}
        //     },
        //         2500
        // )}
        };





// OWL DIALOGUE
    // your dialogue
const owlDialogueButtonTexts = ["", //1
                             "", //2
                             "", //3
                             "", //4
                             "", //5
                             "", //6
                             "", //7
                             "", //8
                             "", //9
                             "", //10
                             "", //11
                             "", //12
                             "", //13
                            ];

    // owl responses
const owlDialogueTexts = [""

                            ];

const owlConversationMap = [[],[],[],[],[],[],[],[],[]];

const createOwlConversation = () => {
    // zoom
    owlZoom();

    // show the owl's speech
    output.innerHTML = owlDialogueTexts[currentOwlConversation];

    // let the rest of the game know you're in dialogue
    dialogueAsk = true;
    inDialogue = true;

    // make "leave" button visible
    leaveButton.style.display = "block";

    if (owlConversationMap[currentOwlConversation][0] > -1) {
        d1.innerHTML = owlDialogueButtonTexts[owlConversationMap[currentowlConversation][0]];
        d1.style.display = "block";
    } else {d1.style.display = "none"};
    if (owlConversationMap[currentOwlConversation][1] > -1) {
        d2.innerHTML = owlDialogueButtonTexts[owlConversationMap[currentowlConversation][1]];
        d2.style.display = "block";
    } else {d2.style.display = "none"};
    if (currentOwlConversation === 7) {haveMap = true};
    outputArea.scroll(0,0);
};

continueOwlConversation1 = () => {
    currentOwlConversation = owlConversationMap[currentOwlConversation][0];
    createOwlConversation();
};

d1.addEventListener('click', continueOwlConversation1);

continueOwlConversation2 = () => {
    currentOwlConversation = owlConversationMap[currentOwlConversation][1];
    createOwlConversation();
};

d2.addEventListener('click', continueOwlConversation2);

leaveOwlConversation = () => {
    dialogueAsk = false;
    inDialogue = false;
    d1.style.display = "none";
    d2.style.display = "none";
    leaveButton.style.display = "none";
    output.innerHTML = "";
    setCurrentOwlConversation();
    owlUnZoom();
};

setCurrentOwlConversation = () => {
    currentOwlConversation = 0;
};

leaveButton.addEventListener('click', leaveOwlConversation);





// ROBOT DIALOGUE
    // your dialoge
const robotDialogueButtonTexts = ["", //0
                             "> I'm not sure, I just got here.", //1
                             "> Where am I?", //2
                             "> Who are you?", //3
                             "> What were the humans doing?", //4
                             "> How do I get out of here?", //5
                             "> Let's do it!", //6
                             "> Sure, I'll take a look.", //7
                             "> Can you come with me?", //8
                             "", //9
                             "> Nothing yet!", //10
                             "> I met a rude owl.", //11
                             "> Whats the deal with that door?", //12
                             "> I found a strange dark cave to the north.", //13
                             "> No, it was too dark.", //14
                             "> Do you know how to light up the cave?", //15
                             "> I found a crystal in the cave!", //16
                             "> Go ahead!", //17
                             "> Rounding error? What does that mean?", //18
                             "> What about two? Or a half?", //19
                             "> This is a bunch of nonsense.", //20
                             "> What does this have to do with this crystal?", //21
                             "> Ok so what does that mean for us?", //22
                             "> Really? Thats great!", //23
                             "> Is everything alright?", //24
                             "> The cave is too dark to see around.", //25
                             "> Im gonna check it out.", //26
                             "> It's full of strange crystals!", //27
                             "> Sure!", //28
                             "> Who are you?" //29

                            ];
    
    //robot responses
    const robotDialogueTexts = ["You approach the strange figure, and it suddenly lights up. It stands, and speaks in a metallic voice:<br><br><span class='robot'>Wow! How long was I asleep for?</span>", //0
                                "<span class='robot'>Huh. I must have slept for a while. Time is hard to tell around here.</span>", //1
                                "<span class='robot'>Are you lost? Thats not too surprising. A lot of lost things tend to end up here. This forest is a strange place.</span>", //2
                                "<span class='robot'>My name is Analysis Robot TK421. But you can call me Alys for short. A long time ago I helped the humans do some work in this forest.</span>", //3
                                "<span class='robot'>Oh, the same thing humans are always doing, I suppose. Industry. Building. Burning. Digging things out of the ground. Using Javascript. Humans are always so busy. I think they were here studying something, but I was asleep for such a long time, I cant quite remember.</span>", //4
                                "<span class='robot'>Im not sure, but if you give me a second I can scan the area for a way out.</span>", //5
                                "<span class='robot'>Its so odd this forest seems to go on forever. The lake too But theres some kind of anomaly to the north. A dark patch a charged space static. I cant tell. You should check it out. Maybe theres a clue there that can help you find a way out of here.</span>", //6
                                "<span class='robot'>Here, take this map. Itll help you navigate the forest. Im guessing theres a reason youre here.</span><br><br>Type <span><button onclick='spanClick(\"map\")'>map</button></span> to view your map.", //7
                                "<span class='robot'>To be honest Im pretty drained after conducting that analysis. Besides, the static from the anomaly to the north is really messing with me. Id better stay here for now.</span>", //8
                                "<span class='robot'>Hows it going? Did you find anything useful?</span>", //9
                                "<span class='robot'>I can still sense an anomaly to the north... I think it's worth checking out!</span>", //10
                                "<span class='robot'>Oh yeah. That owl is a real jerk. Dont pay them any mind.</span>", //11
                                "<span class='robot'>I think the humans who brought me here built the door... but I cant really remember.</span>", //12
                                "<span class='robot'>Really? I bet thats the anomaly I discovered! Did you find anything in it?</span>", //13
                                "<span class='robot'>Hmm there must be a way to light it up or explore it. Maybe theres something in the forest that can help?</span>", //14
                                "<span class='robot'>No, unfortunately the static energy coming from the cave is really messing with my system.</span>", //15
                                "<span class='robot'>Woah! Thats really something do you mind if I analyze it?</span>", //16
                                "<span class='robot'>This crystal is how do I explain it its made of everything. And nothing. It shouldnt exist. Its some kind of rounding error.</span>", //17
                                "<span class='robot'>Hmm maybe I can explain it like this. Everything exists, right? And things that dont exist, dont exist. Theres something, and nothing. True, or false. Everything is either a 1, or a 0. Right? 1 can be added to 0 to get 1. Thats creation by definition. And 1 can be subtracted from 1 to make 0. Thats destruction by deletion. So in the end, everything is just a 1 or a 0.</span>", //18
                                "<span class='robot'>Well, obviously, 2 exists. Two apples, two inches, two seconds, two electrons. But, in another sense, you cant REALLY add two apples together. They will always be just one apple, and another completely different apple next to it. Even at the sub-atomic level, particles cant be superimposed or split without creating something new I guess things get weird at the quantum level, but Im a binary machine, and as far as I can tell, so are you.</span>", //19
                                "<span class='robot'>Yeah, kind of. What Im trying to say is that this crystal isnt like that. Not to brag, but Im one of the most advanced analytical machines to ever exist. But this crystal it has elements so complex, I cant even tell if they exist or not. Its composition doesnt fit the 0 or 1 paradigm. its structure is a paradox.</span>", //20
                                "<span class='robot'>Well thats just it this crystal is composed of parts neither 1 nor 0.</span>", //21
                                "<span class='robot'>It means it means Im not sure what it means but I think your way out of here is somewhere in that cave.</span>", //22
                                "<span class='robot'>Yeah I guess.</span>", //23
                                "<span class='robot'>Im not sure I think so. Just be careful, ok?</span>", //24
                                "<span class='robot'>There has to be a way to bring a light source in there with you</span>", //25
                                "<span class='robot'>Good luck!</span>", //26
                                "<span class='robot'>Crystals? Really? Do you think you could bring one back for me to analyze?</span>", //27
                                "<span class='robot'>Crystals... so strange...</span>", //28
                                "<span class='robot'>My name is Analysis Robot TK421. But you can call me Alys for short. A long time ago I helped the humans do some work in this forest.</span>", //29
                                ];
    
                        //      0     1     2     3      4      5      6      7      8       9       10      11      12      13      14      15      16      17      18      19      20      21      22      23      24      25      26      27       28     29
const robotConversationMap = [[1,2],[3,2],[3,5],[5,4],[5,-1],[6,-1],[7,-1],[8,-1],[-1,-1],[-1,10],[-1,-1],[12,-1],[-1,-1],[14,-1],[15,29],[-1,-1],[17,-1],[18,-1],[19,20],[20,21],[21,22],[22,-1],[23,25],[24,26],[26,25],[15,26],[-1,-1],[28,-1],[-1,-1],[15,-1]];                      

const createRobotConversation = () => {
    // zoom
    // robotZoom();

    // change image
    room12.src="./roomimages/smfmroom12c.png";

    // change dialogue map if certain criteria are met
    if (roomVisited[7] === true || caveInspected === true) 
        {robotConversationMap[9][1] = 13; robotConversationMap[11][1] = 13; robotConversationMap[12][0] = 13; };
    if (firefliesReleased === true) 
        {robotConversationMap[22][1] = -1; robotConversationMap[24][1] = -1; };
    if (doorInspected === true) 
        {robotConversationMap[9][0] = 11; };
    if (firefliesReleased === true && haveCrystal === false) 
        {robotConversationMap[13][0] = 27; }
    if (haveCrystal === true) 
        {robotConversationMap[13][0] = 16; };
    
    // play cutscenes
    if (currentRobotConversation === 6) {
        currentCutscene = "robot scanning";
        playCutscene();
    };
    
    // show the robot's speech
    output.innerHTML = robotDialogueTexts[currentRobotConversation];


    // let the rest of the game know you're in dialogue
    dialogueAsk = true;
    inDialogue = true;

    // make "leave" button visible
    leaveButton.style.display = "block";

    if (robotConversationMap[currentRobotConversation][0] > -1) {
        d1.innerHTML = robotDialogueButtonTexts[robotConversationMap[currentRobotConversation][0]];
        d1.style.display = "block";
    } else {d1.style.display = "none"};
    if (robotConversationMap[currentRobotConversation][1] > -1) {
        d2.innerHTML = robotDialogueButtonTexts[robotConversationMap[currentRobotConversation][1]];
        d2.style.display = "block";
    } else {d2.style.display = "none"};
    if (currentRobotConversation === 7) {haveMap = true};
    outputArea.scroll(0,0);
};

continueRobotConversation1 = () => {
    currentRobotConversation = robotConversationMap[currentRobotConversation][0];
    createRobotConversation();
};

d1.addEventListener('click', continueRobotConversation1);

continueRobotConversation2 = () => {
    currentRobotConversation = robotConversationMap[currentRobotConversation][1];
    createRobotConversation();
};

d2.addEventListener('click', continueRobotConversation2);

leaveRobotConversation = () => {
    dialogueAsk = false;
    inDialogue = false;
    d1.style.display = "none";
    d2.style.display = "none";
    leaveButton.style.display = "none";
    output.innerHTML = "";
    setCurrentRobotConversation();
    // robotUnZoom();
    room12.src="./roomimages/smfmroom12b.png";
    
};

setCurrentRobotConversation = () => {
    if (haveMap === false) {currentRobotConversation = 0}
    else (currentRobotConversation = 9);
};

leaveButton.addEventListener('click', leaveRobotConversation);


// BOOK BUTTONS
    //page texts
    const journalText = ["The journal begins:<br><br><span class='journal'>          Day 14<br><br>Still no sign of it. <br><br>Our readings indicated that it should be near, but as soon as we got close, all our instruments went haywire. We'll have to continue our search manually until the equipment is repaired.</span>",
                         "<span class='journal'>                                                  Day 15<br><br>A preliminary search of the area was conducted without result. The forest is dense and difficult to travel through. <br><br>Equipment problems persist - possible satellite failure or solar activity. We are forced to leave the proximity zone to contact HQ, which slows progress considerably.</span>", 
                         "<span class='journal'>                                                  Day 19<br><br>That silly young intern keeps wandering off. Kids these days! No discipline.<br><br>I will admit, there is something odd about this place. I cant put my finger on it. I will attempt an explanation my next report.</span>",
                         "<span class='journal'>                                                  Day 23<br><br>Im beginning to wonder if were going to find it here after all. We have search every corner of the proximity zone, and still no sign of it. <br><br>Maybe HQ made a mistake. That seems unlikely good luck trying to explain that to the board. The wild variety is said to be 10.8 to 11.3 times stronger than the domesticated variety, with a potential yield to match. Failure is not an option.</span>",
                         "<span class='journal'>                                                  Day 28<br><br>There is a scientific explanation for everything.<br><br>On day 13 we found a cave at to the northwest end of the proximity zone. As soon as we entered, all our flashlights fizzled out, leaving us in total darkness and with no choice but to feel our way back to the entrance.<br><br>If I believed in luck, I would say we are having the worst.<br><br>The cave doesnt seem like a likely place to find it anyway, since all research indicates that it prefers bright sunlight. The search continues.</span>",
                         "<span class='journal'>                                                  Day 56<br><br>What does it mean to be lost? What does it mean to be at all? This place makes me feel Nevermind. The board will launch an inquiry, and everything will be explained in due time. <br><br>The intern has wandered off again. So sentimental I caught them drinking out of the lake. Can you imagine We brought ample hydration packets, even the FlavorMax variety, yet they prefer to drink dirty lake water</span>",
                         "<span class='journal'>                                                  Day ??<br><br>The days the weeks Ive almost entirely lost track of time.<br><br>HQ has recalled us. The intern disappeared a few nights ago and hasnt returned. We searched for hours. Oh well. They probably prefer it here anyway. </span>" 
                        ];

    //change button according to input value
    const showBookButton = (buttonText) => {
        bookButton.value = buttonText;
        bookButton.style.display = "block"; 
    };

    // function to show the book
    const showBook = () => {
        document.getElementById("book").src="./inventoryimages/book.png";
        document.getElementById("book").classList.add('bookgrab');
        document.getElementById('map').classList.add('blurless');
    }
    // function to hide the book
    const hideBook = () => {
        document.getElementById("book").src="";
        document.getElementById('map').classList.remove('blurless');
        document.getElementById("book").classList.remove('bookgrab');

    }


    //display journal texts according to position in array
    const showBookText = () => {
        if (reading === true || readingAsk === true) {
            output.innerHTML = journalText[currentPage];
            // document.getElementById("book").src="./inventoryimages/book.png";
            currentPage = currentPage + 1;
            reading = true;
            readingAsk = false;
            bookButton.value = '> Keep Reading';
            // document.getElementById('map').classList.add('blurless');
            showBook();
            if (currentPage === 7) {
                bookButton.value = "> Done";
                userInput.value = "";
            } 
            else if (currentPage >= 8 ) {
                output.innerHTML = "";
                currentPage = 0;
                bookButton.style.display = "none";
                reading = false;
                // document.getElementById("book").src="";
                // document.getElementById('map').classList.remove('blurless');
                hideBook();
            }
        };
        outputArea.scroll(0,0);
    };

    //hit button to show book text
    bookButton.addEventListener('click', showBookText);


// ROOM SWITCHING FUNCTIONS

const room1 = document.getElementById("room1");
const room2 = document.getElementById("room2");
const room3 = document.getElementById("room3");
const room4 = document.getElementById("room4");
const room5 = document.getElementById("room5");
const room6 = document.getElementById("room6");
const room7 = document.getElementById("room7");
const room8 = document.getElementById("room8");
const room9 = document.getElementById("room9");
const room10 = document.getElementById("room10");
const room11 = document.getElementById("room11");
const room12 = document.getElementById("room12");
const room13 = document.getElementById("room13");
const room14 = document.getElementById("room14");
const room15 = document.getElementById("room15");
const room16 = document.getElementById("room16");
const room17 = document.getElementById("room17");
const room18 = document.getElementById("room18");
const extraRoom = document.getElementById("extraroom");

allRooms = [room1, room2, room3, room4, room5, room6, room7, room8, room9, room10, room11, room12, room13, room14, room15, room16, room17, room18, extraRoom]

    const moveAllRoomsBack = () => {
        allRooms[roomNum-1].style.zIndex = "-2";
        };

    const goEastAnimation = () => {
        map.classList.add('goeast');
        setTimeout( 
            function() {map.classList.remove('goeast')}, 
            1000
        )
    };

    const goSouthAnimation = () => {
        map.classList.add('gosouth');
        setTimeout( 
            function() {map.classList.remove('gosouth')}, 
            1000
        )
    };

    const goWestAnimation = () => {
        map.classList.add('gowest');
        setTimeout( 
            function() {map.classList.remove('gowest')}, 
            1000
        )
    };

    const goNorthAnimation = () => {
        map.classList.add('gonorth');
        setTimeout( 
            function() {map.classList.remove('gonorth')}, 
            1000
        )
    };

    const climbDownAnimation = () => {
        map.classList.add('climbdown');
        setTimeout( 
            function() {map.classList.remove('climbdown')}, 
            1000
        )
    };

    const climbUpAnimation = () => {
        map.classList.add('climbup');
        setTimeout( 
            function() {map.classList.remove('climbup')}, 
            1000
        )
    };

    const enterShrineAnimation = () => {
        map.classList.add('entershrine');
        setTimeout( 
            function() {map.classList.remove('entershrine')}, 
            1000
        )
    };

    const goEastThenSouthAnimation = () => {
        map.classList.add('goeastthensouth');
        setTimeout( 
            function() {map.classList.remove('goeastthensouth')}, 
            1000
        )
    };

    const goNorthThenWestAnimation = () => {
        map.classList.add('gonorththenwest');
        setTimeout( 
            function() {map.classList.remove('gonorththenwest')}, 
            1000
        )
    };

    const room1Switch = () => {
        mapArrow.style.top = "53%";
        mapArrow.style.left = "42.6%";
        output.innerHTML = "You find yourself in a clearing in the middle of the forest, where a <span><button onclick='spanClick(\"inspect door\")'>strange wooden door</button></span> is standing.";
        roomVisited[2] = true;
        setTimeout(  ()=> {
            moveAllRoomsBack();
            room1.style.zIndex = "0";
            document.getElementById("room1tile").src="./maptiles/room1tile.png";
            roomNum = 1;
            northTriangle.style.opacity = "75%";
            southTriangle.style.opacity = "75%";
            eastTriangle.style.opacity = "75%";
            westTriangle.style.opacity = "75%";
            },
            400
        );
    };
    const room2Switch = () => {
        if (roomVisited[2] === false) {
            output.innerHTML = "The forest grows darker. Large leafy branches block out almost at the light from the fading sun.<br><br>In the middle of the clearing, the glowing light of countless fireflies illuminate the forest.";
        } else {
            output.innerHTML = "The forest is dark, but the air is filled with fireflies. It's rather magical.";
        };
        roomVisited[2] = true;
        mapArrow.style.top = "32%";
        mapArrow.style.left = "55.3%";
        setTimeout(  ()=> {
            moveAllRoomsBack();
            room2.style.zIndex = "0";
            document.getElementById("room2tile").src="./maptiles/room2tile.png";
            roomNum = 2;
            northTriangle.style.opacity = "4%";
            southTriangle.style.opacity = "4%";
            eastTriangle.style.opacity = "4%";
            westTriangle.style.opacity = "75%";
            },
            400
        );
    };
    const room3Switch = () => {
        if (roomVisited[12] === false) {room12.src = "./roomimages/smfmroom12a.png"};

        if (roomVisited[3] === false) { 
            if (roomNum === 1 || roomNum === 6) {
                output.innerHTML = "The trees grow more dense as you travel through the forest.<br><br>You arrive at a shady knoll with an old <span><button onclick='spanClick(\"inspect stump\")'>stump</button></span> in the middle.";
            } else {
                output.innerHTML = "You make your way south through the forest.<br><br>You arrive at a shady knoll with an old <span><button onclick='spanClick(\"inspect stump\")'>stump</button></span> in the middle.";
            }
        } else {
            output.innerHTML = "An old <span><button onclick='spanClick(\"inspect stump\")'>stump</button></span> sits in the center of a shady knoll.";
        };
        roomVisited[3] = true;
        mapArrow.style.top = "53%";
        mapArrow.style.left = "55.3%";
        setTimeout(  ()=> {
            moveAllRoomsBack();
            room3.style.zIndex = "0";
            document.getElementById("room3tile").src="./maptiles/room3tile.png";
            roomNum = 3;
            northTriangle.style.opacity = "75%";
            southTriangle.style.opacity = "4%";
            eastTriangle.style.opacity = "75%";
            westTriangle.style.opacity = "4%";
            },
            400
        );
    };
    const room4Switch = () => {
        if (roomNum === 2 && marbleDown === false && catDiscovered === true) {
            output.innerHTML = "You travel west until you arrive at glade with a large tree in the middle.<br><br>A <span><button onclick='spanClick(\"inspect cat\")'>cat</button></span> is rustling up in the tree's branches.";
        } else if (roomNum === 2 && marbleDown === false) {
            output.innerHTML = "You arrive at a glade with a large tree in the middle.<br><br><span><button onclick='spanClick(\"inspect tree\")'>Something</button></span> is rustling around up in the tree's branches...";
        } else if (marbleDown === false  && catDiscovered === true) {
            output.innerHTML = "You arrive at a glade with a large tree in the middle.<br><br>A <span><button onclick='spanClick(\"inspect cat\")'>cat</button></span> is rustling around up in the tree's branches...";
        } else if (marbleDown === false ) {
            output.innerHTML = "You arrive at a glade with a large tree in the middle.<br><br><span><button onclick='spanClick(\"inspect tree\")'>Something</button></span> is rustling around up in the tree's branches...";
        } else if (marbleDown === true && marbleReunited === false && marbleGone === false ) {
            output.innerHTML = "You arrive at the glade with a large tree in the middle. The <span><button onclick='spanClick(\"inspect cat\")'>cat</button></span> is playing with the ribbon near the base of the tree.";
        } else {
            output.innerHTML = "You arrive at the glade with a large tree in the middle. The cat is gone.";
        };
        roomVisited[4] = true;
        mapArrow.style.top = "32%";
        mapArrow.style.left = "42.6%";
        setTimeout(  ()=> {
            moveAllRoomsBack();
            if (marbleDown === false) {room4.src="./roomimages/smfmroom4a.png"}
            else if (marbleReunited === false && marbleGone === false) {room4.src="./roomimages/smfmroom4b.png"}
            else {room4.src="./roomimages/smfmroom4c.png"};
            room4.style.zIndex = "0";
            document.getElementById("room4tile").src="./maptiles/room4tile.png";
            roomNum = 4;
            northTriangle.style.opacity = "75%";
            southTriangle.style.opacity = "4%";
            eastTriangle.style.opacity = "4%";
            westTriangle.style.opacity = "4%";
            },
            400
        );
    };
    const room5Switch = () => { 
        // get next rooms ready
        if (roomVisited[4] === false) {room4.src="./roomimages/smfmroom4a.png"};
        if (roomVisited[11] === false) {room11.src="./roomimages/smfmroom11.png"};

        if (haveBox === true) {
            if (roomNum === 9) {
                output.innerHTML = "You travel west into a clearing. The path continues to the <span><button onclick='spanClick(\"go south\")'>south.</button></span> To the <span><button onclick='spanClick(\"go east\")'>east,</button></span> a gap in the trees leads to a dark wooded hollow.";
            } else if (roomNum === 6) {
                output.innerHTML = "You travel east into a clearing. The path continues to the <span><button onclick='spanClick(\"go south\")'>south.</button></span> To the <span><button onclick='spanClick(\"go east\")'>east,</button></span> a gap in the trees leads to a dark wooded hollow.";
            } else if (roomNum === 4 ) {
                output.innerHTML = "You travel north into a clearing. The path continues to the <span><button onclick='spanClick(\"go south\")'>south.</button></span> To the <span><button onclick='spanClick(\"go east\")'>east,</button></span> a gap in the trees leads to a dark wooded hollow.";
            } else {
                output.innerHTML = "You arrive at a clearing. The path continues to the <span><button onclick='spanClick(\"go south\")'>south.</button></span> To the <span><button onclick='spanClick(\"go east\")'>east,</button></span> a gap in the trees leads to a dark wooded hollow.";
            };
        } else {
            if (roomNum === 9) {
                output.innerHTML = "You travel west into a clearing. A <span><button onclick='spanClick(\"inspect box\")'>wooden box</button></span> sits on a tuft of grass in the center.<br><br>The path continues to the <span><button onclick='spanClick(\"go south\")'>south.</button></span> To the <span><button onclick='spanClick(\"go east\")'>east,</button></span> a gap in the trees leads to a dark wooded hollow.";
            } else if (roomNum === 6) {
                output.innerHTML = "You travel east into a clearing. A <span><button onclick='spanClick(\"inspect box\")'>wooden box</button></span> sits on a tuft of grass in the center.<br><br>The path continues to the <span><button onclick='spanClick(\"go south\")'>south.</button></span> To the <span><button onclick='spanClick(\"go east\")'>east,</button></span> a gap in the trees leads to a dark wooded hollow.";
            } else if (roomNum === 4 ) {
                output.innerHTML = "You travel north into a clearing. A <span><button onclick='spanClick(\"inspect box\")'>wooden box</button></span> sits on a tuft of grass in the center.<br><br>The path continues to the <span><button onclick='spanClick(\"go south\")'>south.</button></span> To the <span><button onclick='spanClick(\"go east\")'>east,</button></span> a gap in the trees leads to a dark wooded hollow.";
            } else {
                output.innerHTML = "You arrive at a clearing. A <span><button onclick='spanClick(\"inspect box\")'>wooden box</button></span> sits on a tuft of grass in the center.<br><br>The path continues to the <span><button onclick='spanClick(\"go south\")'>south.</button></span> To the <span><button onclick='spanClick(\"go east\")'>east,</button></span> a gap in the trees leads to a dark wooded hollow.";
            };
        };
        roomVisited[5] = true;
        mapArrow.style.top = "73%";
        mapArrow.style.left = "42.6%";
        setTimeout(  ()=> {
            moveAllRoomsBack();
            if (robotAwake === false ) 
                {room5.src="./roomimages/smfmroom5a.png"}
            else
                {room5.src="./roomimages/smfmroom5b.png"}
            room5.style.zIndex = "0";
            document.getElementById("room5tile").src="./maptiles/room5tile.png";
            roomNum = 5;
            northTriangle.style.opacity = "4%";
            southTriangle.style.opacity = "75%";
            eastTriangle.style.opacity = "75%";
            westTriangle.style.opacity = "75%";
            },
            400
        );
    };
    const room6Switch = () => {
        // load next room images
        if (roomVisited[15] === false) {room15.src = "./roomimages/smfmroom15.png"};
        if (roomVisited[9] === false) {room9.src = "./roomimages/smfmroom9b.png"};

        if (ropeTaken === false && boatFixed === false && roomNum === 5)
                {output.innerHTML = "You travel west along the lake shore until you arrive at the wooded point where the half-sunk <span><button onclick='spanClick(\"inspect boat\")'>boat</button></span> is tied up.<br><br>The path continues to the <span><button onclick='spanClick(\"go north\")'>north.</button></span>"}
            else if (ropeTaken === false && boatFixed === false && roomNum === 10)
                {output.innerHTML = "You travel south through the forest until you arrive at the wooded shoreline, where a half-sunk <span><button onclick='spanClick(\"inspect boat\")'>boat</button></span> is tied up.<br><br>The path continues through the woods to the <span><button onclick='spanClick(\"go east\")'>east.</button></span>"}
            else if (roomNum === 17) 
                {output.innerHTML = "You allow the lake's gentle current to guide the boat to a nearby shore.<br><br>As you step out of the boat, the bottom of the boat strikes a rock and begins to leak.<br><br>You have to find a way to patch the hole before you can use the boat again."}
            else if (boatFixed === false && ropeTaken === false)
                {output.innerHTML = "You arrive at the wooded point where the half-sunk <span><button onclick='spanClick(\"inspect boat\")'>boat</button></span> is tied up."}
            else if (boatFixed === false && ropeTaken === true)
                {output.innerHTML = "You arrive at the wooded point where the half-sunk <span><button onclick='spanClick(\"inspect boat\")'>boat</button></span> sits in the water."}
            else if (boatFixed === true && ropeTaken === false)
                {output.innerHTML = "You arrive at the wooded point where your <span><button onclick='spanClick(\"inspect boat\")'>boat</button></span> is tied up."}
            else
                {output.innerHTML = "You arrive at the wooded point where your <span><button onclick='spanClick(\"inspect boat\")'>boat</button></span> sits in the water."};
        roomVisited[6] = true;
        mapArrow.style.top = "73%";
        mapArrow.style.left = "55.3%";
        setTimeout(  ()=> {
            moveAllRoomsBack();
            if (ropeTaken === false && boatFixed === false) 
                {room6.src="./roomimages/smfmroom6a.png"}
            else if (ropeTaken === true && boatFixed === false)
                {room6.src="./roomimages/smfmroom6b.png"}
            else if (ropeTaken === true && boatFixed === true)
                {room6.src="./roomimages/smfmroom6d.png"}  
            else {
                room6.src="./roomimages/smfmroom6c.png"
            };
            room6.style.zIndex = "0";
            document.getElementById("room6tile").src="./maptiles/room6tile.png";
            roomNum = 6;
            northTriangle.style.opacity = "75%";
            southTriangle.style.opacity = "4%";
            eastTriangle.style.opacity = "75%";
            westTriangle.style.opacity = "4%";
            },
            400
        );
    }; 
    const room7Switch = () => {
        if (firefliesReleased === false) {
            output.innerHTML = "You make your way inside the cave. The light slowly fades behind you until you find yourself in almost complete darkness.<br><br>Soon you can barely see your hands in front of you.";
        } else {
            output.innerHTML = "The cave is filled with the light of countless fireflies. The strange <span><button onclick='spanClick(\"inspect crystals\")'>crystals</button></span> glow faintly.";
        };
        roomVisited[7] = true;
        mapArrow.style.top = "16%";
        mapArrow.style.left = "29.8%";
        setTimeout(  ()=> {
            moveAllRoomsBack();
            room7.style.zIndex = "0";
            roomNum = 7;
            northTriangle.style.opacity = "4%";
                southTriangle.style.opacity = "75%";
                eastTriangle.style.opacity = "4%";
                westTriangle.style.opacity = "4%";
            if (firefliesReleased === false) {
                room7.src="./roomimages/smfmroom7a.png"
                document.getElementById("room7tile").src="./maptiles/room7tiledark.png";
            }
            else {
                room7.src="./roomimages/smfmroom7b.png";
                document.getElementById("room7tile").src="./maptiles/room7tile.png";
            }
            },
            400
        );
    }; 
    const room8Switch = () => {
        if (roomVisited[8] === false) {
            output.innerHTML = "You make your way west through the dimly-lit cave and arrive at large grotto. A single beam of light from far above illuminates an island in the center of an underground lake.";
        } else {
            output.innerHTML = "You arrive at large grotto, where single beam of light from far above illuminates an island in the center of an underground lake.";
        };
        roomVisited[8] = true;
        mapArrow.style.top = "16%";
        mapArrow.style.left = "16.9%";
        setTimeout(  ()=> {
            moveAllRoomsBack();
            room8.style.zIndex = "0";
            document.getElementById("room8tile").src="./maptiles/room8tile.png";
            roomNum = 8;   
            northTriangle.style.opacity = "4%";
            southTriangle.style.opacity = "4%";
            eastTriangle.style.opacity = "75%";
            westTriangle.style.opacity = "4%";
            },
            400
        );
    };
    const room9Switch = () => {
        // load next room images
        if (roomVisited[5] === false) {room5.src = "./roomimages/smfmroom5a.png"};

        if (roomVisited[9] === false) {
            output.innerHTML = "A narrow path leads you east through the forest. The air grows stale as dried and rotting tree branches grab at your clothes.<br><br>You arrive at a murky hollow and a circle of <span><button onclick='spanClick(\"inspect mushrooms\")'>mushrooms</button></span>";
        } else if (ghostDiscovered === true && ghostGivenMug === false) {
            output.innerHTML = "A narrow path leads you east through the forest.<br><br>You arrive at the murky hollow, where a <span><button onclick='spanClick(\"inspect ghost\")'>ghost</button></span> hovers eerily over a circle of <span><button onclick='spanClick(\"inspect mushrooms\")'>mushrooms.</button></span>";
        } else if (roomNum === 5) {
            output.innerHTML = "A narrow path leads you east through the forest.<br><br>You arrive at a murky hollow and a circle of <span><button onclick='spanClick(\"inspect mushrooms\")'>mushrooms.</button></span>";
        } else if (roomNum === 11) {
            output.innerHTML = "A narrow path leads you west through the forest.<br><br>You arrive at a murky hollow and a circle of <span><button onclick='spanClick(\"inspect mushrooms\")'>mushrooms.</button></span>";
        } else {
            output.innerHTML = "A narrow path leads you through the forest.<br><br>You arrive at a murky hollow and a circle of <span><button onclick='spanClick(\"inspect mushrooms\")'>mushrooms.</button></span>";
        };
        roomVisited[9] = true;
        mapArrow.style.top = "32%";
        mapArrow.style.left = "68%";
        setTimeout(  ()=> {
            moveAllRoomsBack();
            room9.style.zIndex = "0";
            roomNum = 9;
            if (ghostGivenMug === true || ghostDiscovered === false ) 
                {room9.src="./roomimages/smfmroom9b.png"}
            else if (ghostGivenFlower === true) 
                {room9.src="./roomimages/smfmroom9c.png"}
            else
                 {room9.src="./roomimages/smfmroom9a.png"};
            document.getElementById("room9tile").src="./maptiles/room9tile.png";
            northTriangle.style.opacity = "4%";
            southTriangle.style.opacity = "4%";
            if (ghostGivenMug === true || ghostDiscovered === false) {
                eastTriangle.style.opacity = "75%";
            } else {
                eastTriangle.style.opacity = "16%";
            };
            westTriangle.style.opacity = "75%";
            },
            400
        );
    }; 
    const room10Switch = () => {
        // load next room images
        if (roomVisited[6] === false) {room6.src="./roomimages/smfmroom6a.png"};
        if (roomVisited[13] === false) {room13.src="./roomimages/smfmroom13a.png"};

        if (newGame === true) {
            // wellZoom();
            output.innerHTML = "You travel south along the narrow path. Soon, you find yourself standing in front of an old <span><button onclick='spanClick(\"inspect well\")'>stone well.</button></span>";
        } else if (roomNum === 6) {
            output.innerHTML = "You travel north and find a <span><button onclick='spanClick(\"inspect well\")'>stone well.</button></span>";
        } else if (roomNum === 14) {
            output.innerHTML = "You travel south and find a <span><button onclick='spanClick(\"inspect well\")'>stone well.</button></span>";
        } else if (roomNum === 13) {
            output.innerHTML = "You climb out of the well."
        } else {
            output.innerHTML = "You find yourself in front of a <span><button onclick='spanClick(\"inspect well\")'>stone well.</button></span>"
        };
        roomVisited[10] = true;
        mapArrow.style.top = "53%";
        mapArrow.style.left = "29.8%";
        setTimeout(  ()=> {
            moveAllRoomsBack();
            room10.style.zIndex = "0";
            if (ropeSet === false) {room10.src="./roomimages/smfmroom10a.png"}
            else {room10.src="./roomimages/smfmroom10b.png"};
            document.getElementById("room10tile").src="./maptiles/room10tile.png";
            roomNum = 10;
            northTriangle.style.opacity = "75%";
            southTriangle.style.opacity = "75%";
            eastTriangle.style.opacity = "4%";
            westTriangle.style.opacity = "4%";
            },
            400
        );
        newGame = false;

    }; 
    const room11Switch = () => {
        // get next rooms ready
        if (roomVisited[2] === false) {room2.src = "./roomimages/smfmroom2.png"};
        if (roomVisited[3] === false) {room3.src = "./roomimages/smfmroom3.png"};
        if (roomVisited[7] === false) {room7.src = "./roomimages/smfmroom7a.png"};

        if (roomVisited[11] === false) {
            output.innerHTML = "You find yourself at the mouth of a large <span><button onclick='spanClick(\"inspect cave\")'>cave.</button></span>";
        } else if (roomNum === 7) {
            output.innerHTML = "You follow the light back to the entrance of the cave."
        } else {
            output.innerHTML = "You find yourself at the mouth of the large <span><button onclick='spanClick(\"inspect cave\")'>cave.</button></span>";
        };
        roomVisited[11] = true;
        mapArrow.style.top = "32%";
        mapArrow.style.left = "29.8%";
        setTimeout(  ()=> {
            moveAllRoomsBack();
            room11.style.zIndex = "0";
            document.getElementById("room11tile").src="./maptiles/room11tile.png";
            roomNum = 11;
            northTriangle.style.opacity = "75%";
            southTriangle.style.opacity = "75%";
            eastTriangle.style.opacity = "75%";
            westTriangle.style.opacity = "75%";
            },
            400
        );
    };

    const room12Switch = () => {
        if (haveBox === false) {
            if (roomNum === 5 || roomNum === 6 || roomNum === 3) {
                output.innerHTML = "You travel west along the lakeshore until you arrive at at a large willow tree where a <span><button onclick='spanClick(\"talk robot\")'>strange figure</button></span> is laying.";
            } else if (roomNum === 14) { 
                output.innerHTML = "You walk east and arrive at a <span><button onclick='spanClick(\"look lake\")'>lake shore</button></span>, where a <span><button onclick='spanClick(\"talk robot\")'>strange figure</button></span> is laying against a large willow tree." 
            } else {
                output.innerHTML = "You walk south until you arrive at a <span><button onclick='spanClick(\"look lake\")'>lake shore</button></span>, where a <span><button onclick='spanClick(\"talk robot\")'>strange figure</button></span> is laying against a large willo tree.";
            }
        } else {
            if (roomNum === 5 || roomNum === 6 || roomNum === 3) {
                output.innerHTML = "You travel west along the lakeshore until you arrive at the lakeshore, where the <span><button onclick='spanClick(\"talk robot\")'>robot</button></span> is standing under a large willow tree.";
            } else if (roomNum === 14) { 
                output.innerHTML = "You travel east and  you arrive at the lakeshore, where the <span><button onclick='spanClick(\"talk robot\")'>robot</button></span> is standing under a large willow tree." 
            } else {
                output.innerHTML = "You walk south and arrive at the lakeshore, where the <span><button onclick='spanClick(\"talk robot\")'>robot</button></span> is standing under a large willow tree.";
            }
        };
        roomVisited[12] = true;
        mapArrow.style.top = "73%";
        mapArrow.style.left = "29.8%";
        setTimeout(  ()=> {
                moveAllRoomsBack();
                if (haveBox === false) {room12.src="./roomimages/smfmroom12a.png"}
                else {room12.src="./roomimages/smfmroom12b.png"};
                room12.style.zIndex = "0";
                document.getElementById("room12tile").src="./maptiles/room12tile.png";
                roomNum = 12;
                northTriangle.style.opacity = "4%";
                southTriangle.style.opacity = "4%";
                eastTriangle.style.opacity = "4%";
                westTriangle.style.opacity = "75%";
            },
            400
        );
    }; 
    const room13Switch = () => {
        // get next room ready
        room16.src="./roomimages/smfmroom16a.png";

        output.innerHTML = "You carefully climb down the rope to the bottom of the well.";
        roomVisited[13] = true;
        setTimeout(  ()=> {
            moveAllRoomsBack();
            if (mugTaken === false) {room13.src="./roomimages/smfmroom13a.png"}
            else {room13.src="./roomimages/smfmroom13b.png"};
            room13.style.zIndex = "0";
            roomNum = 13;
            northTriangle.style.opacity = "4%";
            southTriangle.style.opacity = "4%";
            eastTriangle.style.opacity = "75%";
            westTriangle.style.opacity = "4%";
            },
            400
        );
    }; 
    const room14Switch = () => { 
        if (roomVisited[10] === false) {room10.src="./roomimages/smfmroom10a.png"};

        if (newGame === false && roomNum === 10) {
            output.innerHTML = "You travel north and return to the glade where you awoke.";
        } else if (newGame === false ) {
            output.innerHTML = "You return to the glade where you awoke.";
        } else {
            output.innerHTML = "You open your eyes and find yourself in a forest clearing.<br><br>You try to remember how you got here, but your mind is fuzzy. \"I guess I fell asleep,\" you think to yourself. \"Maybe I should <span><button onclick='spanClick(\"look around\")'>look around.\"</button></span><br><br>The woods around you are dense and dark. There is a narrow path leading <span><button onclick='spanClick(\"go south\")'>south.</button></span>";
        };
        roomVisited[14] = true;
        mapArrow.style.top = "73%";
        mapArrow.style.left = "16.9%";
        setTimeout(  ()=> {
            moveAllRoomsBack();
            room14.style.zIndex = "0";
            document.getElementById("room14tile").src="./maptiles/room14tile.png";
            roomNum = 14;
            northTriangle.style.opacity = "4%";
            southTriangle.style.opacity = "75%";
            eastTriangle.style.opacity = "4%";
            westTriangle.style.opacity = "4%";
            },
            400
        );
    };

    const room15Switch = () => { 
        output.innerHTML = "You ride the boat out into the lake, and arrive at an island.";
        roomVisited[15] = true;
        mapArrow.style.top = "63%";
        mapArrow.style.left = "74.5%";
        setTimeout(  ()=> {
            moveAllRoomsBack();
            room15.src="./roomimages/smfmroom15.png";
            room15.style.zIndex = "0";
            document.getElementById("room15tile").src="./maptiles/room15tile.png";
            roomNum = 15;
            northTriangle.style.opacity = "4%";
            southTriangle.style.opacity = "4%";
            eastTriangle.style.opacity = "4%";
            westTriangle.style.opacity = "4%";
            },
            400
        );
    };

    const room16Switch = () => { 
        // what to say
        if (roomNum === 17 && millSwitchOn === false) {
            output.innerHTML = "You ride the basket back down the side of the dam and return to the watermill.";
        } else if (roomNum === 13 && millSwitchOn === false) {
            output.innerHTML = "You crawl through the tunnel. Soon you emerge from the darkness and find yourself at the edge of a creek, where a large stone <span><button onclick='spanClick(\"inspect dam\")'>dam</button></span> looms over a motionless wooden <span><button onclick='spanClick(\"inspect water mill\")'>watermill.</button></span>";
        } else if (millSwitchOn === false) {
            output.innerHTML = "You arrive at the edge of a creek, where a large stone <span><button onclick='spanClick(\"inspect dam\")'>dam</button></span> looms over a motionless wooden <span><button onclick='spanClick(\"inspect water mill\")'>watermill.</button></span>";
        } else {
            output.innerHTML = "You arrive at the edge of a creek, where the large stone <span><button onclick='spanClick(\"inspect dam\")'>dam</button></span> looms over the wooden <span><button onclick='spanClick(\"inspect water mill\")'>watermill.</button></span>.<br><br>A wicker basket on a rope is waiting to take you <span><button onclick='spanClick(\"take basket\")'>to the top</button></span> of the dam.";
        } ;
        // mark that the room has been visited
        roomVisited[16] = true;
        // get the next room ready
        document.getElementById("room17").src="./roomimages/smfmroom17.png";
        // display the right stuff
        mapArrow.style.top = "73%";
        mapArrow.style.left = "16.9%";
        setTimeout(  ()=> {
            moveAllRoomsBack();
            if (millSwitchOn === false && haveStick === false) {room16.src="./roomimages/smfmroom16a.png"}
            else if (millSwitchOn === false) {room16.src="./roomimages/smfmroom16b.png"}
            else {room16.src="./roomimages/smfmroom16c.png"};
            room16.style.zIndex = "0";
            document.getElementById("room14tile").src="./maptiles/room14tile.png";
            roomNum = 16;
            northTriangle.style.opacity = "75%";
            southTriangle.style.opacity = "4%";
            if (millSwitchOn === false) {
                eastTriangle.style.opacity = "4%";
            } else {
                eastTriangle.style.opacity = "75%";
            };
            westTriangle.style.opacity = "4%";
            },
            400
        );
        newGame = false;
    };

    const room17Switch = () => { 
        // what to say
        if (basketRidden === false) {
            currentCutscene = "riding basket";
            playCutscene();
            basketRidden = true;
        };
        if (roomNum === 16 && bellRung === false) {
            output.innerHTML = "You ride the basket up the side of the dam, and arrive at a platform at the top.<br><br>An elevated wooden walkway leads over the lake to an <span><button onclick='spanClick(\"inspect shrine\")'>old shrine.</button></span> Light shines from within the shrine's windows.";
        } else {
            output.innerHTML = "You exit the shrine.";
        };
        // mark the room visited
        roomVisited[17] = true;
        // get the next rooms ready
        document.getElementById("room18").src="./roomimages/smfmroom18a.png";
        // display the stuff
        mapArrow.style.top = "73%";
        mapArrow.style.left = "16.9%";
        setTimeout(  ()=> {
            moveAllRoomsBack();
            room17.style.zIndex = "0";
            roomNum = 17;
            northTriangle.style.opacity = "4%";
            southTriangle.style.opacity = "4%";
            eastTriangle.style.opacity = "75%";
            westTriangle.style.opacity = "75%";
            },
            400
        );
    };

    const room18Switch = () => { 
        // what to say
        output.innerHTML = "You enter the shrine.<br><br>The inside of the shrine is dimly lit. In the center, a large <span><button onclick='spanClick(\"inspect bell\")'>golden bell</button></span> hangs above a <span><button onclick='spanClick(\"inspect dias\")'>wooden dias.</button></span>";
        // mark room visited
        roomVisited[18] = true;
        // get the next rooms ready
        document.getElementById("room6").src="./roomimages/smfmroom6a.png";
        // display the stuff
        mapArrow.style.top = "73%";
        mapArrow.style.left = "16.9%";
        setTimeout(  ()=> {
            moveAllRoomsBack();
            if (crystalPlaced === true) {room18.src = "./roomimages/smfmroom18b.png"}
            else {room18.src = "./roomimages/smfmroom18a.png"};
            room18.style.zIndex = "0";
            roomNum = 18;
            northTriangle.style.opacity = "4%";
            southTriangle.style.opacity = "4%";
            eastTriangle.style.opacity = "4%";
            westTriangle.style.opacity = "75%";
            },
            400
        );
    };

    // CHEATER MAP CLICKING FUNCTIONS

    const goNorth = () =>
        { if (currentlyMoving === false) {
            currentlyMoving = true;
            setTimeout(function() {currentlyMoving = false},1000);
            reading = false;
            triangleButtonFlash(northTriangle);
            userInput.value = "go north";
            processInput();
        }
            // focus on input if on desktop
            if (!( 
                   navigator.userAgent.match(/Android/i)
                || navigator.userAgent.match(/webOS/i)
                || navigator.userAgent.match(/iPhone/i)
                || navigator.userAgent.match(/iPad/i)
                || navigator.userAgent.match(/iPod/i)
                || navigator.userAgent.match(/BlackBerry/i)
                || navigator.userAgent.match(/Windows Phone/i)
                )) {
            userInput.focus(); 
                }
        };
    const goSouth = () =>
        { if (currentlyMoving === false) {
            currentlyMoving = true;
            setTimeout(function() {currentlyMoving = false},1000);
            reading = false;
            triangleButtonFlash(southTriangle);
            userInput.value = "go south";
            processInput();
        }
            if (!( 
                   navigator.userAgent.match(/Android/i)
                || navigator.userAgent.match(/webOS/i)
                || navigator.userAgent.match(/iPhone/i)
                || navigator.userAgent.match(/iPad/i)
                || navigator.userAgent.match(/iPod/i)
                || navigator.userAgent.match(/BlackBerry/i)
                || navigator.userAgent.match(/Windows Phone/i)
                )) {
            userInput.focus(); 
                }
        };
    const goEast = () =>
        { if (currentlyMoving === false) {
            currentlyMoving = true;
            setTimeout(function() {currentlyMoving = false},1000);
            reading = false;
            triangleButtonFlash(eastTriangle);
            userInput.value = "go east";
            processInput();
        }
            if (!( 
                   navigator.userAgent.match(/Android/i)
                || navigator.userAgent.match(/webOS/i)
                || navigator.userAgent.match(/iPhone/i)
                || navigator.userAgent.match(/iPad/i)
                || navigator.userAgent.match(/iPod/i)
                || navigator.userAgent.match(/BlackBerry/i)
                || navigator.userAgent.match(/Windows Phone/i)
                )) {
            userInput.focus(); 
                }
        };
    const goWest = () =>
        { if (currentlyMoving === false) {
            currentlyMoving = true;
            setTimeout(function() {currentlyMoving = false},1000);
            reading = false;
            triangleButtonFlash(westTriangle);
            userInput.value = "go west";
            processInput();
        }
            if (!( 
                   navigator.userAgent.match(/Android/i)
                || navigator.userAgent.match(/webOS/i)
                || navigator.userAgent.match(/iPhone/i)
                || navigator.userAgent.match(/iPad/i)
                || navigator.userAgent.match(/iPod/i)
                || navigator.userAgent.match(/BlackBerry/i)
                || navigator.userAgent.match(/Windows Phone/i)
                )) {
            userInput.focus(); 
                }
        };

    const triangleButtonFlash = (triangleID) => {
        triangleID.classList.add('brightfadeoutfortriangles');
        setTimeout(()=> {triangleID.classList.remove('brightfadeoutfortriangles')}, 200);
    };



// VIEWING THE MAP
    const checkMap = () => {
        checkingMap = true;
        mapAsk = true;
        document.getElementById('maptiles').style.zIndex = "400";
        map.classList.add('darken');
    };

    const clearMap = () => {
        if (checkingMap === true || mapAsk === true) {
            document.getElementById('maptiles').style.zIndex = "-2"
            // output.innerHTML = "You close your <span>map</span>.";
            output.innerHTML = "";
            map.classList.remove('darken');
            // userInput.focus(); 
            };
        };

// const inputFocus = () => {
//     userInput.focus()
// };

// TAKE MUSHROOM

// taking the first mushroom sets the mushy-time-passed to 10. So, if mushy taken when mushy value is <1, set the time pass
// taking any mushroom increased mushy value by 9
// if, when mushy time passed = 0, mushy value is greater than 1, activate mushy!
const takeMushy = () => {
    mushyTaken = true;

    if (mushyValue < 1) { mushyTimePassed = 10};

    mushyValue = mushyValue + 9;
}
// FOCUS ON INPUT ON DESKTOP ONLY

const focusOnInputOnDesktop = () => {
    if (!( 
                   navigator.userAgent.match(/Android/i)
                || navigator.userAgent.match(/webOS/i)
                || navigator.userAgent.match(/iPhone/i)
                || navigator.userAgent.match(/iPad/i)
                || navigator.userAgent.match(/iPod/i)
                || navigator.userAgent.match(/BlackBerry/i)
                || navigator.userAgent.match(/Windows Phone/i)
                )) {
            userInput.focus(); 
                }   
}

// SPAN CLICK

const spanClick = (whatToDo) => {
    userInput.value = whatToDo;
    processInput();
    if (!( 
                   navigator.userAgent.match(/Android/i)
                || navigator.userAgent.match(/webOS/i)
                || navigator.userAgent.match(/iPhone/i)
                || navigator.userAgent.match(/iPad/i)
                || navigator.userAgent.match(/iPod/i)
                || navigator.userAgent.match(/BlackBerry/i)
                || navigator.userAgent.match(/Windows Phone/i)
                )) {
            userInput.focus(); 
                }   
}

// USER INPUT

    let inp = (arg) => {
        return userInput.value.toLowerCase().includes(arg);
    };

    const processInput = () => {

        //clear inventory / close inventory / hide inventory
        closeInventory();

        //clear map
        document.getElementById('maptiles').style.zIndex = "-2";
        map.classList.remove('darken');

        // hide extra room
        document.getElementById('extraroom').style.zIndex = "-2";


        // not being asked
        readingAsk = false;
        mapAsk = false;
        inventoryAsk = false;
        dialogueAsk = false;
        fixingBoat = false;
        fixingMill = false;

        //clear buttons
        bookButton.style.display = "none";
        document.getElementById("book").src="";
        document.getElementById('map').classList.remove('blurless');
        document.getElementById("book").classList.remove('bookgrab');
        d1.style.display = "none";
        d2.style.display = "none";
        leaveButton.style.display = "none";
        
        // clear zoom / unzoon
        // robotUnZoom();
        if (inDialogue === false && robotAwake === true) {room12.src="./roomimages/smfmroom12b.png";}
        wellUnZoom();
        doorUnZoom();
        stumpUnZoom();
        boatUnZoom();
        rocksUnZoom();
        ghostUnZoom();
        catTreeUnZoom();
        watermillUnZoom();
        bellUnZoom();

        // feel bad?
        if (marbleGone === true) {feelBad()};

        // GET INPUT
        switch (true) {
    
        // GLOBAL
            case (inp('points')||inp('score')) && (inp('what')||inp('how'))  :
                output.innerHTML =  "<span class = 'points'>Current score: " + gamePoints + "</span>";
                break;
            case inp('mushy test'):
                takeMushy();
                output.innerHTML = "on mushys? " + mushyTaken + "<br><br>Mushy time passed: " + mushyTimePassed + "<br><br>Mushy value: " +mushyValue;
                break;
            case inp('mushy check'):
                output.innerHTML = "on mushys? " + mushyTaken + "<br><br>Mushy time passed: " + mushyTimePassed + "<br><br>Mushy value: " +mushyValue;
                break;
            case inp('get inventory length'):
                output.innerHTML = inventory.length;
                break;
            case inp('var status'):
                output.innerHTML = "robotConversationMap: " + robotConversationMap + "<br><br>haveMap: " + haveMap + "<br><br>boatFixed: " + boatFixed + "<br><br>ropeTaken: " + ropeTaken + "<br><br>haveBox: " + haveBox
                break;
            case inp('talk test'):
                output.innerHTML = "";
                createRobotConversation();
                break;
            case inp('get room num'):
                output.innerHTML = roomNum;
                break;
            case inp('getvars'):
                output.innerHTML = "inCutscene: " + inCutscene;
                break;
            case inp('wake') && inp('up'):
                output.innerHTML = "You rub your eyes and pinch yourself, but nothing happens.";
                break;
            case inp("nap") || inp("sleep"):
                output.innerHTML = "You're not really tired.";
                break; 
            case inp('chill') || (inp('not') && inp('much')):
                output.innerHTML = "cool cool";
                break;
            case inp('how') && inp('are') && inp('you') :
                output.innerHTML = "I'm good! How are you?";
                break;
            case inp('reset'):
                room1Switch();
                roomNum = 1;
                userInput.value = "";
                output.innerHTML = "";
                break;
            case inp('marco') :
                output.innerHTML = "Polo!";
                break;
            case inp("fart") :
                output.innerHTML = "Pfpffpf.";
                break;
            case inp("peepee") :
                output.innerHTML = "Poopoo.";
                break;
            case inp("sexy") :
                output.innerHTML = ";)";
                break;
            case (inp('poop')||(inp('butt')&&!inp('butte')&&!inp('butto'))||inp("fuck")||inp("sex")||inp("shit")||inp("cunt")||inp("pussy")||inp("dick")||inp("penis"))||inp('cock')||inp('boner')||inp('crap')||inp('wank')||inp("piss")||inp('shart')||inp('balls')||inp('vagina')||inp('gooch')||inp('retard')||inp('asshole')||inp('ass hole')||inp('bitch')||inp('you die')||inp('hate')||(inp('flesh')&&inp('light'))  :
                if (profanityCounter < 21) {
                    output.innerHTML = profanityResponse[profanityCounter];
                    profanityCounter++;
                    break;
                } else {
                    document.body.style.display = 'none';
                    break;
                };
            case (inp("this is")||inp('game')) && (inp('stupid')||inp('dumb')) :
                output.innerHTML = "No u.";
                break;
            case (inp("this is")||inp('game')) && (inp('stupid')||inp('terrible')||inp('lame')) :
                output.innerHTML = "Whatever.";
                break;
            case (inp("this is")||inp('game')) && (inp('weird')) :
                output.innerHTML = "Weird is good. I can work with weird.";
                break;
            case (inp("this")||inp('game')) && (inp('suck')||inp('blow')) :
                output.innerHTML = "lol u wish.";
                break;
            case ((inp("you")&inp('are'))||inp('you\'re')) && inp('mean') :
                output.innerHTML = "No you're mean!";
                break;
            case inp("boob")||inp("tits")||inp("titties")||inp("titty") :
                output.innerHTML = "(.)(.)";
                break;
            case inp('how') && inp('it') && inp('going') :
                output.innerHTML = "Pretty good! Playing a game with a cool person.";
                break;
            case inp('moon') && roomNum !== 7 && roomNum !== 8 && roomNum !== 13:
                output.innerHTML = "The moon is just beginning to rise over the forest.";
                break;
            case inp('moon') :
                output.innerHTML = "You can't see the moon from here.";
                break;
            case inp('sun') || inp('sky') && roomNum !== 7 && roomNum !== 8 && roomNum !== 13:
                output.innerHTML = "The sun is beginning to set over the forest, painting the trees a shadowy hue.";
                break;
            case inp('sun') || inp('sky') :
                output.innerHTML = "You can't see the sky from here.";
                break;
            
        // GET HINT
                // initial hints
            case (inp("hint") || inp("help") || inp("clue")) && firstHint === false && haveBox === false && ropeTaken === false && haveBoxKey === false && roomVisited[5] === false && roomVisited[3] === false && roomVisited[10] === false && roomVisited[4] === false    :
                output.innerHTML = "There is something strange about this place...<br><br>You can type commands like <span><button onclick='spanClick(\"look around\")'>look around</button></span>, <span><button onclick='spanClick(\"walk east\")'>walk east</button></span>, or interact with things around you.";
                firstHint = true;
                break;
            case (inp("hint") || inp("help") || inp("clue")) && thingsTriedSinceLastBigThing < 6 && haveBox === false && ropeTaken === false && haveBoxKey === false && roomVisited[5] === false && roomVisited[3] === false && roomVisited[10] === false && roomVisited[4] === false :
                output.innerHTML = "You can type commands like <span><button onclick='spanClick(\"look around\")'>look around</button></span>, <span><button onclick='spanClick(\"walk east\")'>walk east</button></span>, or interact with things around you.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) &&  roomVisited[10] === false  && roomVisited [5] === false:
                output.innerHTML = "There's a lot of forest to explore... you can travel quickly by clicking the arrows in the corners of the screen above.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && inventory.length === 0 :
                output.innerHTML = "The objects around you can be interacted with. Try typing <span><button onclick='spanClick(\"take rock\")'>pick up a rock</button></span>, then type <span><button onclick='spanClick(\"check pockets\")'>check pockets</button></span> to see what items you've picked up so far.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && haveBoxKey === false && haveBox === false &&  boxUnlocked === false && roomNum !== 12 && roomNum !== 5 && roomNum !== 6:
                output.innerHTML = "You can travel around the forest by typing things like <span><button onclick='spanClick(\"go north\")'>go north.</button></span><br><br>You can also move around quickly by clicking on the triangles in the corners of the screen above.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && haveBoxKey === false && haveBox === false &&  boxUnlocked === false :
                output.innerHTML = "It's always helpful to <span><button onclick='spanClick(\"look around\")'>look around</button></span> any time you arrive in a new area.<br><br>You can move around the forest quickly by clicking on triangles in the corners of the screen above.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && haveBoxKey === true && haveBox === false && triedKeyOnDoor === false &&  boxUnlocked === false:
                output.innerHTML = "You found a key!<br><br>Maybe it unlocks something nearby.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && haveBoxKey === true && haveBox === false && triedKeyOnDoor === true &&  boxUnlocked === false:
                output.innerHTML = "Looks like this is key doesn't fit the lock on the door...<br><br>Maybe it fits something else nearby.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && haveBoxKey === false && haveBox === true &&  boxUnlocked === false && thingsTriedSinceLastBigThing < 80 :
                output.innerHTML = "You shake the box, and can hear something inside. There has to be a way to open it...";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && haveBoxKey === false && haveBox === true &&  boxUnlocked === false && thingsTriedSinceLastBigThing < 100 :
                output.innerHTML = "I'm sure you can get this box open somehow!";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && haveBoxKey === false && haveBox === true &&  boxUnlocked === false :
                output.innerHTML = "There has to be a way to open this box...";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && boxUnlocked === false && haveBox === true && haveBoxKey === true:
                output.innerHTML = "Try checking your <span><button onclick='spanClick(\"check pockets\")'>pockets</button></span> to see what you have with you.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && boxUnlocked === true && boxSmashed < 3 && haveFireflies === false && firefliesReleased === false && thingsTriedSinceLastBigThing < 20:
                output.innerHTML = "You used the key to open box, and there was a red ribbon inside.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && boxUnlocked === true && haveFireflies === false && firefliesReleased === false && boxSmashed > 2 && (thingsTriedSinceLastBigThing < 10 || sassyHint === false):
                output.innerHTML = "You really think I'm gonna give you a hint after you smashed the box like that? HA.<br><br>This one's on you.";
                sassyHint = true;
                break;
            case (inp("hint") || inp("help") || inp("clue")) && boxUnlocked === true && haveFireflies === false && firefliesReleased === false && boxSmashed > 2  && thingsTriedSinceLastBigThing < 20:
                output.innerHTML = "I told you I wasn't gonna give you a hint.<br><br>Shouldn't've smashed the box.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && boxUnlocked === true && haveFireflies === false && firefliesReleased === false && boxSmashed > 2  && thingsTriedSinceLastBigThing > 19:
                output.innerHTML = "Ok fine. Here's a hint: something in your pockets can be used to help explore an area nearby. That's all I'm gonna say.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && boxUnlocked === true && boxSmashed < 3 && haveFireflies === false && firefliesReleased === false && thingsTriedSinceLastBigThing > 19 && roomVisited[7] === false:
                output.innerHTML = "Try exploring!";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && boxUnlocked === true && boxSmashed < 3 && haveFireflies === false && firefliesReleased === false && thingsTriedSinceLastBigThing > 19:
                output.innerHTML = "There is something strange about that cave... Maybe you can find a way to light it up?";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && firefliesReleased === true && robotAwake === false :
                output.innerHTML = "You used the fireflies to light up the cave, and found it was full of strange crystals.";
                break;
            case (inp("hint") || inp("help") || inp("clue"))  :
                output.innerHTML = "You got this!";
                break;

        // MAP CHECKING
            case inp('map') :
                if (haveMap === true) {
                    endCutscene();
                    closeInventory();
                    checkMap();
                    output.innerHTML = "You open your map.<br><br>Press 'ENTER' to return."
                    userInput.value = "";
                    break;
                } else {
                    output.innerHTML = "Don't have a map."
                    userInput.value = "";
                    break;
                };
                

        // CHECK INVENTORY
            case ((inp("check")||inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('what'))   &&    inp('pocket')) || inp('inventory')  :
                userInput.value = "";
                output.innerHTML = checkInventory();
                displayInventory();
                break;
            
        // TRAVEL

            // SPECIAL CASE FOR 16 BECAUSE OF THE DAM
            case roomNum === 16 && inp(' up') && (inp('dam')||inp('wall')) &&  millSwitchOn === false :
                output.innerHTML = "The dam are too tall and steep to climb.";
                break;
            case roomNum === 16 && inp(' up') && (inp('dam')||inp('wall')||inp('go ')) &&  millSwitchOn === true :
                room17Switch();
                climbUpAnimation();
                break;

                // SPECIAL CASE FOR 17 BECAUSE OF THE DAM
            case roomNum === 17 && inp('down') && (inp('dam')||inp('wall')||inp('go '))  :
                room16Switch();
                climbDownAnimation();
                break;

            // GOING EAST
            case roomNum !== 13 && (((inp("walk")||inp('go ')||inp('travel')||(inp('take')&&inp('me')))   &&    inp('right'))  || inp('east') ):
                switch (roomNum) {
                    case 9:
                        if (ghostDiscovered === false) {
                            currentCutscene = "ghost appearing";
                            playCutscene();
                            ghostDiscovered = true;
                            room9Switch();
                            ghostZoom();
                            output.innerHTML = "You start to walk past the mushrooms...";
                        } else if (ghostDiscovered === true && ghostGivenMug === false) {
                            ghostZoom();
                            output.innerHTML = "The <span><button onclick='spanClick(\"inspect ghost\")'>ghost</button></span> is blocking the path.";
                        } else {
                            room5Switch();
                            goEastAnimation();
                        };
                        break;
                    case 1:
                        room3Switch();
                        goEastAnimation();
                        break;
                    case 4:
                        output.innerHTML = "You can't go any futher east."
                        break;
                    case 5:
                        room11Switch();
                        goEastAnimation();
                        break;
                    case 3:
                        room12Switch();
                        goEastAnimation();
                        break;
                    case 6:
                        room9Switch();
                        goEastAnimation();
                        break;
                    case 16:
                        if (millSwitchOn === false)
                            {output.innerHTML = "The dam is too steep to climb."}
                        else 
                            {room17Switch();
                            climbUpAnimation(); 
                            };
                        break;
                    case 11:
                        room2Switch();
                        goEastAnimation();
                        break;
                    case 8:
                        room7Switch();
                        goEastAnimation();
                        break;
                    case 10:
                        output.innerHTML = "The forest is too dense to go any further east.";
                        break;
                    case 14:
                        output.innerHTML = "The forest is too dense to go any further east.";
                        break;
                    case 2:
                        output.innerHTML = "The forest is too dense to go any further east.";
                        break;
                    case 12:
                        output.innerHTML = "The forest is too dense to go any further east.";
                        break;
                    case 17:
                        room18Switch();
                        enterShrineAnimation();
                        break;
                    case 7:
                        if (firefliesReleased === false) {
                            output.innerHTML = "If you go any further you'll get lost in the darkness."
                        } else {
                            output.innerHTML = "There's nowhere to go that way."
                        };
                        break;
                };
                break;

            // GOING NORTH
            case roomNum !== 13 && ((inp("walk")||inp('go ')||inp('travel')||(inp('take')&&inp('me')))   &&    inp('up')||inp('straight')||inp('forward'))  || inp('north')  :
                switch (roomNum) {
                    case 3:
                        room11Switch();
                        goNorthAnimation();
                        break;
                    case 5:
                        output.innerHTML = "The forest is too dense to go any further north.";
                        break;
                    case 4:
                        room5Switch();
                        goNorthAnimation();
                        break;
                    case 2:
                        output.innerHTML = "The forest is too dense to go any further north.";
                        break;
                    case 14:
                        output.innerHTML = "The forest is too dense to go north.";
                        break;
                    case 9:
                        output.innerHTML = "The forest is too dark and dense to go any further north.";
                        break;
                    case 1:
                        room4Switch();
                        goNorthAnimation();
                        break;
                    case 6:
                        room10Switch();
                        goNorthAnimation();
                        break;
                    case 12:
                        output.innerHTML = "The forest is too dark and dense to go any further north.";
                        break;
                    case 10:
                        room14Switch();
                        goNorthAnimation();
                        break;
                    case 7:
                        if (firefliesReleased === false) {
                            output.innerHTML = "If you go any further you'll get lost in the darkness."
                        } else {
                            output.innerHTML = "There's nowhere to go that way."
                        };
                        break;
                    case 11:
                        room7Switch();
                        goNorthAnimation();
                        break;
                    case 16:
                        room13Switch();
                        goNorthThenWestAnimation();
                        break;
                    case 17:
                        output.innerHTML = "There's nowhere to go that direction.";
                        break;
                };
                break;

            // GOING WEST
            case ((inp("walk")||inp('go ')||inp('travel')||(inp('take')&&inp('me')))   &&    inp('left'))  || inp('west')  :
                switch (roomNum) {
                    case 14:
                        output.innerHTML = "The forest is too dense to go west.";
                        break;
                    case 11:
                        room5Switch();
                        goWestAnimation();
                        break;
                    case 10:
                        output.innerHTML = "The forest is too dense to go any further west.";
                        break;
                    case 13:
                        output.innerHTML = "There's nowhere to go!";
                        break;
                    case 16:
                        output.innerHTML = "The forest is too dense to go any further west.";
                        break;
                    case 12:
                        room3Switch();
                        goWestAnimation();
                        break;
                    case 3:
                        output.innerHTML = "The forest is too dense to go any further west.";
                        break;
                    case 2:
                        room11Switch();
                        goWestAnimation();
                        break;
                    case 6:
                        // room14Switch();
                        // goWestAnimation();
                        // output.innerHTML = "You travel west and return to the glade where you awoke.";
                        output.innerHTML = "You can't go any futher west."
                        break;
                    case 9:
                        room6Switch();
                        goWestAnimation();
                        break;
                    case 4:
                        output.innerHTML = "You can't go any further west.";
                        break;
                    case 1:
                        room10Switch();
                        goWestAnimation();
                        break;
                    case 5:
                        room9Switch();
                        goWestAnimation();
                        break;
                    case 17:
                        room16Switch();
                        climbDownAnimation();
                        break;
                    case 18:
                        room17Switch();
                        enterShrineAnimation();
                        break;
                    case 7:
                        if (firefliesReleased === false) {
                            output.innerHTML = "If you go any further you'll get lost in the darkness."
                        } else {
                            output.innerHTML = "There's nowhere to go that way."
                        }
                        break;
                };
                break;

            // GOING SOUTH
            case roomNum !== 10 && (((inp("walk")||inp('go ')||inp('travel')||(inp('take')&&inp('me')))   &&    (inp('down'))) || inp('south'))  :
                switch (roomNum) {
                    case 9:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dark and dense to go any further south.";
                        break;
                    case 2:
                        output.innerHTML = "The forest is too dark and dense to go any further south.";
                        break;
                    case 1:
                        room5Switch();
                        goSouthAnimation();
                        break;
                    case 4:
                        output.innerHTML = "You can't go any further south.";
                        break;
                    case 3:
                        output.innerHTML = "The forest is too dense to go any further south.";
                        break;
                    case 5:
                        room4Switch();
                        goSouthAnimation();
                        break;
                    case 14:
                        room10Switch();
                        goSouthAnimation();
                        break;
                    case 13:
                        output.innerHTML = "There's nowhere to go!";
                        break;
                    case 16:
                        output.innerHTML = "You can't go any farther south.";
                        break;
                    case 6:
                        output.innerHTML = "You can't go any farther south.";
                        break;
                    case 12:
                        output.innerHTML = "You can't go any farther south.";
                        break;
                    case 7:
                        room11Switch();
                        goSouthAnimation();
                        break;
                    case 11:
                        room3Switch();
                        goSouthAnimation();
                        break;
                };
                break;

            // SPECIAL CASE FOR ROOM 10 BECAUSE OF GOING "DOWN" THE WELL
            case roomNum === 10 && inp("go")   &&    inp('down')  && ropeSet === true  :
                room13Switch();
                climbDownAnimation();
                output.innerHTML = "You test the rope, and then carefully lower yourself into the well...<br><br>The bottom of the well is dry, and littered with some rocks and other objects that have fallen down throughout the years.<br><br>A <span><button onclick='spanClick(\"enter tunnel\")'>tunnel</button></span> in the stone wall leads deeper into the darkness.";
                break;
            case roomNum === 10 && (((inp("walk")||inp('go')||inp('travel')||(inp('take')&&inp('me')))   &&    (inp('down')))  || inp('south') ) && !inp("well") :
                room6Switch();
                goSouthAnimation();
                break;

            // SPECIAL CASE FOR ROOM 13
            case roomNum === 13 && inp("go")   &&    inp('up') :
                room10Switch();
                climbUpAnimation();
                break;
            case roomNum === 13 && (inp("walk")||inp('go')||inp('travel'))   &&    (inp('up')||inp('forward')||inp('straight')||inp('north'))   :  // XXX supposedly this doesn't return a value to output
                output.innerHTML = "There's nowhere to go!";
                break;
            
            // ROOM 14
            case roomNum === 14 &&    (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('forest')||inp('around'))  && (newGame === true || inventory.length === 0 ) :
                output.innerHTML = "It's twilight. The forest is dark and dense. The glade where you awoke is covered with <span><button onclick='spanClick(\"take flower\")'>blue flowers</button></span> and scattered <span><button onclick='spanClick(\"take rock\")'>rocks.</button></span><br><br>A narrow path leads <span><button onclick='spanClick(\"go south\")'>south</button></span> out of the glade.";
                break;
            case roomNum === 14 &&    (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('forest')||inp('around')) :
                output.innerHTML = "The glade is littered with beautiful <span><button onclick='spanClick(\"take flower\")'>blue flowers</button></span> and scattered <span><button onclick='spanClick(\"take rock\")'>rocks.</button></span><br><br>A narrow path leads <span><button onclick='spanClick(\"go east\")'>east</button></span> out of the glade.";
                break;
            case roomNum === 14 &&    (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in <span><button onclick='spanClick(\"take flower\")'>blue flowers.</button></span> There are some <span><button onclick='spanClick(\"take rock\")'>rocks</button></span> strewn about too.";
                break;
            // case roomNum === 14 &&  ( inp('jump') || inp('hop'))|| inp('fence') :
            //     // output.innerHTML = "You start to jump the fence, but you suddenly realize that there's literally nothing on the other side, because nothing was programmed there, and you would simply float through a spaceless void for eternity.<br><br>You decide to stay on this side of the fence.";
            //     room16Switch();
            //     goSouthAnimation();
            //     break;

            // ROOM 1
                // look around
            case roomNum === 1 &&  ( ( (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('forest')||inp('around')) )  ):
                if (firstCutscene === false) {
                    // playFirstCutscene();
                    firstCutscene = true;
                }
                output.innerHTML = "It's twilight. There is a <span><button onclick='spanClick(\"inspect door\")'>strange door</button></span> standing in a grassy clearing surrounded by trees.<br><br>To the <span><button onclick='spanClick(\"go north\")'>north</button></span> and <span><button onclick='spanClick(\"go east\")'>east</button></span> the forest grows dark and dense. To the <span><button onclick='spanClick(\"go south\")'>south</button></span>, you can hear the distant sound of water.";
                break;
            case roomNum === 1 &&    (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass, with scattered <span><button onclick='spanClick(\"take rock\")'>rocks</button></span> and <span><button onclick='spanClick(\"take flower\")'>flowers.</button></span>";
                break;
                // try to open door
            case roomNum === 1 && doorUnlocked === false && haveBoxKey === false &&    (inp('open')||inp('try')||inp('use'))    &&    (inp('door')||inp('handle')||inp("knob"))  :
                output.innerHTML = "The door is locked.";
                doorZoom();
                break;
            case roomNum === 1   &&  doorUnlocked === false  && haveBoxKey === true && triedKeyOnDoor === false &&    (inp('unlock')||inp('key')||inp('open')||inp('try')||inp('use'))   &&    (inp('door')||inp('handle')||inp('knob'))  :
                output.innerHTML = "You try to unlock the door with the key you found down by the lake...<br><br>but it doesn't fit the lock.<br><br>Maybe this key fits something else.";
                triedKeyOnDoor = true;
                doorZoom();
                break;
            case roomNum === 1    &&  doorUnlocked === false  && haveBoxKey === true  &&    (inp('unlock')||inp('key')||inp('open')||inp('try')||inp('use'))   &&    (inp('door')||inp('handle')||inp('knob'))  :
                doorZoom();
                output.innerHTML = "You try to unlock the door with the key you found down by the lake, but it doesn't fit the lock.<br><br>Now that you look closer, the key is shiny silver, but the lock on the door is a dull iron.<br><br>Maybe this key fits something else nearby.";
                break;
            case roomNum === 1    &&  doorUnlocked === false  &&    inp('unlock')   &&    (inp('door')||inp('handle'))   :
                output.innerHTML = "You don't have the key. Maybe it's nearby?";
                doorZoom();
                break;
                // inspect door
            case roomNum === 1 &&    (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))    &&    (inp('door')||inp('frame'))     :
                output.innerHTML = "The door is made of a dark wood, and it's handle and lock are iron. It's worn, but sturdy. Something tells you it's been here a long time.";
                doorZoom();
                break;
            case roomNum === 1 &&    (inp('beyond'))    &&    (inp('door')||inp('frame'))     :
                output.innerHTML = "You press your hand against the door, and a chill goes up your spine.<br><br>There must be a way to open it...";
                doorZoom();
                break;
            case roomNum === 1 &&    (inp('behind')||inp('other side'))    &&    (inp('door')||inp('frame'))     :
                output.innerHTML = "You walk all the way around the door frame, but it's not connected to anything besides the ground.";
                doorZoom();
                break;
            case roomNum === 1 &&    (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('try')||inp('what'))   &&    (inp('lock')||inp('handle')||inp('knob'))     :
                output.innerHTML = "The door's gnob and lock are simple and a bit rusty, but strong. You try to push it open, but it won't budge.";
                doorZoom();
                break;
                // weird attemps
            case roomNum === 1 &&  inp ("ask") && inp('please') :
                output.innerHTML = "You ask the door nicely to open, but nothing happens. You feel kind of silly for talking to a door.";
                doorZoom();
                break;
            case roomNum === 1 &&  inp ("sesame") :
                output.innerHTML = "'One Thousand and One Arabian Nights', huh? Good stuff.<br><br>The door still doesn't open, and now you kind of want a bagel.";
                break;
            case roomNum === 1 &&  inp ("password") :
                output.innerHTML = "You say aloud every weird phrase, magical word, or secret-agent style code you can think of, but the door stubbornly remains closed.";
                doorZoom();
                break;
            case roomNum === 1 &&  inp ("flower") && inp('door'):
                output.innerHTML = "You offer the door a flower, but it doesn't seem interested.";
                doorZoom();
                break;
            case roomNum === 1 &&    inp('knock') :
                output.innerHTML = "You knock on the door, but nothing happens. I guess no one is home";
                doorZoom();
                break;
            case roomNum === 1 &&    (inp('who') && inp('there')) || inp('nok'):
                output.innerHTML = "Lol you thought";
                break;
            case roomNum === 1  && doorUnlocked === false&&    (inp('take')||inp('grab')||inp('pocket'))    &&    (inp('door')||inp('handle')||inp("knob"))    :
                output.innerHTML = "You don't have magical pockets, just regular ones. so the door probably isn't going to fit. Besides, it's pretty solid and doesn't look like it's going to be easily moved.";
                break;
            case roomNum === 1  && doorUnlocked === false &&    (inp('hit')||inp('break')||inp('smash')||inp('rock')||inp('kick')||inp('ram ')||inp('bust')||inp('bash')||inp('punch'))    &&    (inp('door')||inp('handle')||inp("knob"))   :
                output.innerHTML = "You pick up a rock and give the door a real good whack. Seriously, you wind up and really lean into it.<br><br>But the door doesn't budge. You didn't even really dent the wood. That's a bummer.<br><br>Can doors can be angry? This door seems angry.";
                doorZoom();
                break;
            case roomNum === 1 &&    (inp('thru') || inp('through') || inp('walk') || inp('into') || (inp('in')&&inp('to'))) && inp('door'):
                output.innerHTML = "The door is closed. You try the handle, but it's locked.";
                doorZoom();
                break;
            case roomNum === 1 && inp('pick') && inp('lock') :
                output.innerHTML = "You use a stick to fiddle around with the lock for a bit, but no luck.<br><br>Guess it's not as easy as those adventure novels made it out to be.";
                doorZoom();
                break;
                // catch-all for door
            case roomNum === 1 && inp('door') :
                output.innerHTML = "The door is made of a dark wood, and it's handle and lock are iron. It's worn, but sturdy. Something tells you it's been here a long time.";
                doorZoom();
                break;
            case roomNum === 1 && doorUnlocked === false && (inp('knob')||inp('handle')) :
                output.innerHTML = "You try the door knob, but it's locked.";
                doorZoom();
                break;
            case roomNum === 1 && inp('lock') && haveBoxKey === false:
                output.innerHTML = "You wiggle the handle, but the door is securely locked.";
                doorZoom();
                break;
            case roomNum === 1 && inp('lock') && haveBoxKey === true:
                output.innerHTML = "You try to use the silver key to unlock the door, but it doesn't fit. Drat.";
                doorZoom();
                break;

            // ROOM 3
            case roomNum === 3 &&    (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "The forest is dark here. There is a <span><button onclick='spanClick(\"inspect stump\")'>stump</button></span> in the middle of the clearing with an old discarded <span><button onclick='spanClick(\"read journal\")'>notebook</button></span> alongside.<br><br>To the <span><button onclick='spanClick(\"go north\")'>north</button></span>, an overgrown path leads deeper into the forest. To the <span><button onclick='spanClick(\"go south\")'>south</button></span> you can hear the sound of running water.<br><br>The forest is too dense to travel any further east from here.";
                break;
            case roomNum === 3 &&    (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('behind')||inp('under')||inp('what'))    &&    (inp('stump'))   && foundBook === true  :
                output.innerHTML = "Looks like a good place to sit and rest. You wonder how long ago the tree was cut down, but you're stumped.";
                stumpZoom();
                break;
            case roomNum === 3 &&    (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))    &&    (inp('book')||inp('journal')||inp('diary'))   && foundBook === true  :
                output.innerHTML = "The journal has a worn leather cover.<br><br>The pages inside are water damaged, but the hand-written ink is still legibled.<br><br>There's no title, and no author.";
                showBookButton("> Read Journal?");
                stumpZoom();
                readingAsk = true;
                break;
            case roomNum === 3 &&    (inp('read') ||inp('pick'))   &&    (inp('book')||inp('journal')||inp('diary'))   :
                output.innerHTML = "You reach for the journal."
                showBookButton("> Read Journal?");
                stumpZoom();
                readingAsk = true;
                break;
            case roomNum === 3 &&    (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))    &&    (inp('book')||inp('journal')||inp('diary'))   && foundBook === false  :
                output.innerHTML = "There's a book on the ground in front of the stump. It looks like somebody used this spot to sit and read or write.";
                showBookButton("> Read Journal?");
                stumpZoom();
                readingAsk = true;
                foundBook = true;
                break;
            case roomNum === 3 &&    (inp('take')||inp('grab')||inp('pocket'))    &&    (inp('book')||inp('journal')||inp('diary'))   :
                output.innerHTML = "The book seems rather personal. You decide to leave it here in case somebody comes back for it.";
                showBookButton("> Read Journal?");
                readingAsk = true;
                foundBook = true;
                stumpZoom();
                break;
            case roomNum === 3 &&    (inp('sit')||inp('rest'))     :
                output.innerHTML = "You sit down on the stump to rest for a minute. It's comfier than you would have thought." + getPoints(30, stumpSatOn);
                stumpSatOn = true;
                stumpZoom();
                break;
            case roomNum === 3 &&    (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass, with scattered rocks and flowers.<br><br>There is an <span><button onclick='spanClick(\"read journal\")'>old book</button></span> on the ground near the stump.";
                break;
            case roomNum === 3 &&    inp('stump')  :
                output.innerHTML = "There's a <span><button onclick='spanClick(\"read journal\")'>book</button></span> on the ground in front of the stump. It looks like somebody used this spot to sit and read or write.";
                foundBook = true;
                stumpZoom();
                break;

            // ROOM 2
            case roomNum === 2 &&    (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "The forest is dark and overgrown here, and the the air is filled with fireflies that bathe the woods in a warm light.<br><br>To the <span><button onclick='spanClick(\"go east\")'>east</button></span>, a narrow path leads down into a murky hollow. A wooded glen lies to the <span><button onclick='spanClick(\"go west\")'>west.</button></span>";
                if (firefliesSeen === false) {
                    //playFireflyCutscene();
                    firefliesSeen = true;
                };
                break;
            case roomNum === 2 &&    (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('what'))    &&    (inp('fire'))     :
                output.innerHTML = "You've never seen fireflies this bright before! They illuminate the whole forest.";
                if (firefliesSeen === false) {
                    //playFireflyCutscene();
                    firefliesSeen = true;
                };
                break;
            case roomNum === 2 && (inp('box')||inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get'))   &&    inp('fire')  &&  boxUnlocked === true  && haveFireflies === false :
                output.innerHTML = 'You catch a firefly, and very carefully put it in your <span><button onclick=\'spanClick(\"inspect box\")\'>wooden box</button></span> and close the lid.<br><br>You catch another, and another... and pretty soon the box is full of fireflies!';
                removeItem("a <span><button onclick='spanClick(\"inspect box\")'>wooden box</button></span>");
                removeItem("a <span><button onclick='spanClick(\"inspect box\")'>smashed-up box</button></span>");
                inventory.push("a <span><button onclick='spanClick(\"inspect box\")'>box of fireflies</button></span>");
                haveFireflies = true;
                switchChestRopeImage();
                break;
            case roomNum === 2 && (inp('box')||inp('chest')||inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get'))   &&    inp('fire')  &&  haveFireflies === true :
                output.innerHTML = 'The box is already full of fireflies!';
                break;
            case (roomNum === 2 || (roomNum === 7 && firefliesReleased === true)) && (inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get')||inp('grab'))   &&    inp('fire') && (inp('mug')||inp('cup')) && haveMug === true  :
                output.innerHTML = 'You catch a firefly and put it in the mug, but as soon as you take your hand away it flies away.<br><br>Maybe there is something else nearby you can keep the fireflies in.';
                break;
            case roomNum === 2 && (inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get')||inp('grab'))   &&    inp('fire')  && haveBox === false  :
                output.innerHTML = 'After a couple attempts, you catch a firefly in you hands. You cup it gently and its soft glow illuminates your fingers. After a few moments, you release it to join the others.<br><br>"If only I had somewhere to keep it," you think.';
                break;
            case roomNum === 2 && (inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get')||inp('grab'))   &&    inp('fire')  && haveBox === true  :
                output.innerHTML = 'You catch a firefly in you hands, and its soft glow illuminates your fingers.<br><br>"I bet I could keep some of them in this <span><button onclick=\'spanClick(\"inspect box\")\'>wooden box</button></span> if I can get it open," you think.';
                break;
            case roomNum === 2 &&    (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass with scattered rocks and such. You don't find anything of use.";
                break;

            // ROOM 4
                // look around
            case roomNum === 4   && catDiscovered === false   &&  haveBoxKey === false  && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('forest')||inp('around')) :
                output.innerHTML = "A big tree stands in the middle of a wooded glade on the shore of the lake. The lakeshore is scattered with large <span><button onclick='spanClick(\"search rocks\")'>rocks.</button></span><br><br><span><button onclick='spanClick(\"search tree\")'>Something</button></span> is rustling around up in the tree's branches...<br><br>A narrow path leads <span><button onclick='spanClick(\"go north\")'>north</button></span> into the woods.";
                break;
            case roomNum === 4   && catDiscovered === false   &&   (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('forest')||inp('around')) :
                output.innerHTML = "A big tree stands in the middle of a wooded glade on the shore of the lake.<br><br><span><button onclick='spanClick(\"search tree\")'>Something</button></span> is rustling around up in the tree's branches...<br><br>A narrow path leads <span><button onclick='spanClick(\"go north\")'>north</button></span> into the woods.";
                break;
            case roomNum === 4    && marbleDown === false   &&  haveBoxKey === false  && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('forest')||inp('around'))  :
                output.innerHTML = "A big tree stands in the middle of a wooded glade on the shore of the lake. A <span><button onclick='spanClick(\"inspect cat\")'>cat</button></span> is perched on one of it's hightest branches.<br><br>The lakeshore is scattered with large <span><button onclick='spanClick(\"search rocks\")'>rocks.</button></span><br><br>A narrow path leads <span><button onclick='spanClick(\"go north\")'>north</button></span> into the woods.";
                break;
            case roomNum === 4    && marbleDown === false    && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('forest')||inp('around'))  :
                output.innerHTML = "A big tree stands in the middle of a wooded glade on the shore of the lake. A <span><button onclick='spanClick(\"inspect cat\")'>cat</button></span> is perched on one of it's hightest branches.<br><br>A narrow path leads <span><button onclick='spanClick(\"go north\")'>north</button></span> into the woods.";
                break;
            case roomNum === 4 &&   marbleReunited === false &&   (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('forest')||inp('around'))   :
                output.innerHTML = "The black and white cat is playing with the ribbon under the big tree.";
                break;
            case roomNum === 4 &&    (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('forest')||inp('around'))   :
                output.innerHTML = "A big tree stands in the middle of the glade.";
                break;
                // searching water for the key
            case roomNum === 4 &&   (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))    &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('pond')||inp('stream')||inp('ocean')||inp('bank')||inp('beach')) && haveBoxKey === false  && waterSearchedOnce === false   :
                waterSearchedOnce = true;
                rocksZoom();
                output.innerHTML = "The water is cool and clear, and a few fish drift lazily along.<br><br>You think you spy something shining under the water near the <span><button onclick='spanClick(\"search rocks\")'>rocks.</button></span>";
                break;
            case roomNum === 4 &&  haveBoxKey === false && boxSmashed < 3 && (    ((inp('search')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('check')||inp('what'))   &&    (inp('creek')||inp('river')||inp('lake')||inp('pond')||inp('stream')||inp('ocean')||inp('bank')||inp('beach')||inp('water')||inp('rock')||inp("debris")||inp('stone')||inp('pebble')||inp("shore")||(inp('drift')&&inp('wood'))))  || inp(' key')   ):
                output.innerHTML = "You find a key in the rocks by the shore. You put the key in your <span><button onclick='spanClick(\"check pockets\")'>pocket.</button></span>";
                haveBoxKey = true;
                findKey();
                rocksZoom();
                inventory.push("a <span><button onclick='spanClick(\"inspect key\")'>silver key</button></span>");
                break;
            case roomNum === 4 &&  haveBoxKey === false &&  (inp('search')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('check')||inp('what'))   &&    (inp('creek')||inp('river')||inp('lake')||inp('pond')||inp('stream')||inp('ocean')||inp('bank')||inp('beach')||inp('water')||inp('rock')||inp('stone')||inp('pebble')||inp("shore")||(inp('drift')&&inp('wood')))    :
                output.innerHTML = "You find a key in the rocks by the shore. Too bad you already smashed the open box, so now it's worthless.<br><br>...Or is it...?<br><br>...It is.";
                haveBoxKey = true;
                findKey();
                rocksZoom();
                inventory.push("a <span><button onclick='spanClick(\"inspect key\")'>silver key</button></span>");
                break;
            case roomNum === 4 &&  haveBoxKey === false &&  (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass, with scattered <span><button onclick='spanClick(\"take rock\")'>rocks</button></span> and <span><button onclick='spanClick(\"take flower\")'>flowers.</button></span> The lakeshore is scattered with driftwood and other <span><button onclick='spanClick(\"search rocks\")'>debris</button></span> washed in on the tide.";
                rocksZoom();
                break;
            case roomNum === 4 &&   (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))    &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('pond')||inp('stream')||inp('ocean')||inp('bank')||inp('beach'))   :
                output.innerHTML = "The water is cool and clear. A few fish drift lazily along.";
                break;
                
                // check ground
            case roomNum === 4  &&   (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass with scattered rocks and such. You don't find anything of use.";
                break;
                // ribbon and play
            case roomNum === 4  && marbleDown === false && haveRibbon === true &&    (inp('play')|| ( ( inp('cat')||inp('use')||inp('give')||inp('wave')) && inp('ribbon')) ):
                catDiscovered = true;
                haveRibbon = false;
                removeItem("a <span><button onclick='spanClick(\"inspect ribbon\")'>red ribbon</button></span>");
                room4Switch();
                currentCutscene = "cat jumping";
                playCutscene();
                output.innerHTML = "You pull the red ribbon out of your pocket, and the cat perks up.<br><br>You wave the ribbon around, and the cat leaps from the tree!" + getPoints(50, marbleDown);
                marbleDown = true;
                break;
            case ( (roomNum === 4 && marbleDown === true) || ( roomNum === 12 && marbleReunited === true ) ) &&  (   inp('play')  ||  (inp('cat')||inp('use')) && inp('ribbon')   ) :
                output.innerHTML = "You grab the ribbon and wave it around for the cat. Is there anything better than this?";
                break;
            case roomNum === 4 && marbleDown === true && marbleReunited === false && (inp('pet')||inp('stroke')||inp('purr')||inp('scratch')||inp('rub')||inp('scritch'))  :
                output.innerHTML = "The cat leans up against you leg and begins to purr." + getPoints(10, catPet);
                catPet = true;
                break;
            case roomNum === 4 && marbleDown === true && marbleReunited === false && inp('talk') && inp('cat') :
                output.innerHTML = "Meow!"
                break;
            case roomNum === 4  && marbleDown === true &&  marbleReunited === false && marbleGone === false && (inp('throw')||inp('kick')||inp('punch')||inp('slap')||inp('hit')||inp('kill'))   ||    (inp('rock')||inp('pebble')||inp('stone')) && inp('cat')   :
                marbleGone = true;
                room4Switch();
                output.innerHTML = "The cat hisses at you and darts away!" + getPoints(-200, catAttacked);
                catAttacked = true;
                break;
                // attempts at play
            case roomNum === 4  && marbleDown === false && haveFlower === true  &&    (inp('play')||inp('cat') )  &&    inp('flower')   :
                catDiscovered = true;
                catTreeZoom();
                output.innerHTML = "You use the flower to try to get the cat's attention. It seems vaguely interested for a moment, but quickly loses interest.<br><br>Maybe you can find something it likes more to play with.";
                break;
            case roomNum === 4   && marbleDown === false  && haveRibbon === true   &&    inp('play')   &&    inp('cat')    :
                catDiscovered = true;
                catTreeZoom();
                output.innerHTML = "You try to get the attention of the cat, but it doesn't seem that interested in you.<br><br>Maybe you have something in your pockets it would like to play with?";
                break;
            case roomNum === 4    && marbleDown === false   &&    inp('play')   &&    inp('cat')  :
                catDiscovered = true;
                catTreeZoom();
                output.innerHTML = "You try to get the attention of the cat, but it doesn't seem that interested in you.<br><br>Maybe you can find something to play with...";
                break;
            case roomNum === 4    && marbleDown === false   &&    inp('play')    :
                catDiscovered = true;
                catTreeZoom();
                output.innerHTML = "The cat doesn't seem interested.";
                break;
            case roomNum === 4 && marbleDown === false &&  (inp('pet')||inp('stroke')||inp('purr')||inp('scratch')||inp('rub')||inp('scritch'))  :
                output.innerHTML = "If only you could reach :(";
                catTreeZoom();
                break;
                // other weird attempts
            case roomNum === 4    && marbleDown === false && haveRope === true  &&    inp('rope')   :
                catDiscovered = true;
                catTreeZoom();
                output.innerHTML = "You toss one end of the rope up to the cat, but it doesn't really seem interested.";
                break;
            case roomNum === 4    && marbleDown === false && haveRope === true  &&  (  inp('call') || inp('here kitt') || (inp('come')&&inp('down')) ) :
                catDiscovered = true;
                catTreeZoom();
                output.innerHTML = "Your best efforts at summoning the cat< are entirely in vain.";
                break;
            case roomNum === 4    && marbleDown === false && haveRope === true  &&   ( inp('get')||inp('take')) && inp('cat')  :
                catDiscovered = true;
                catTreeZoom();
                output.innerHTML = "The cat doesn't seem like it wants to go anywhere.";
                break;
            case roomNum === 4    && marbleDown === false && haveRope === true  &&   ( inp('ask')||inp('please')||inp('plead')||inp('beg') ) :
                catDiscovered = true;
                catTreeZoom();
                output.innerHTML = "You ask the cat nicely to come down. It just rolls it's eyes.";
                break;
            case roomNum === 4    && marbleDown === false && haveRope === true  &&    (inp('shake') ||inp('push') ||inp('jostle')) :
                catDiscovered = true;
                catTreeZoom();
                output.innerHTML = "You push against the tree trunk with all your might, but boy oh boy is this tree putting up a fight. Your best efforts hardle move it.";
                break;
            case roomNum === 4    && marbleDown === false && haveRope === true  &&    inp('sneak')   :
                catDiscovered = true;
                catTreeZoom();
                output.innerHTML = "You tip-toe towards the tree and, quietly as you can, start to climb, but your foot snaps a twig.<br><br>The cat swats at you and you lose your footing and come crashing down. Ouch!";
                break;
            case roomNum === 4 &&   marbleDown === false  && marbleReunited === false && inp('talk')  :
                catDiscovered = true;
                catTreeZoom();
                output.innerHTML = "The cat doesn't really seem interested in talking.";
                break;
            case roomNum === 4  && marbleDown === false &&  (inp('throw')||inp('toss')||inp('hit')||inp('kill'))   ||    (inp('rock')||inp('pebble')||inp('stone')) && inp('cat')   :
                catDiscovered = true;
                catTreeZoom();
                output.innerHTML = "You throw a rock at the cat like the big jerk you are. The cat dodges out of the way and hisses." + getPoints(-999, catAttacked);
                catAttacked = true;
                break;
            case roomNum === 4  && marbleDown === false &&  (inp('throw')||inp('toss')||inp('hit')||inp('chuck'))   ||    (inp('stick')) && inp('branch')   :
                catDiscovered = true;
                catTreeZoom();
                if (haveStick === true) {
                    removeItem("a <span><button onclick='spanClick(\"inspect stick\")'>stick</button></span>")
                };
                haveStick = false;
                output.innerHTML = "You throw a stick at the cat like the big jerk you are. The cat dodges out of the way and hisses."+ getPoints(-999, catAttacked);
                break;
            case roomNum === 4  && marbleDown === false &&  (inp('pull')||inp('grab')||inp('hit')||inp('ask')||inp('lure')||inp('tease')||inp('take')) && inp('cat')   :
                catDiscovered = true;
                catTreeZoom();
                output.innerHTML = "The cat isn't interested in cooperating.";
                break;
            case roomNum === 4  && marbleDown === false &&  (inp('fight')||inp('punch')||inp('kick')) && inp('cat')   :
                catDiscovered = true;
                catTreeZoom();
                output.innerHTML = "The cat gives you a look, like \"Come at me, bro.\".";
                break;
                // inspecting cat
            case roomNum === 4   &&  marbleDown === false  && marbleReunited === false &&  (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))  && inp('cat')  :
                catDiscovered = true;
                catTreeZoom();
                output.innerHTML = "The cat eyes you casually. It's relaxing on one of the tallest branches of the tree. It seems perfectly content where it is.";
                break;
            case roomNum === 4   &&  marbleDown === true  && marbleReunited === false &&  (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check'))  && inp('cat')  :
                catDiscovered = true;
                output.innerHTML = "The black and white cat is preocuppied with the red ribbon.";
                break;
                // searching the tree
            case roomNum === 4  &&  marbleDown === false  && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what')||inp('behind')||inp('under')||inp('what'))   &&    (inp('tree')||inp('branch'))     :
                output.innerHTML = "You look up into the tree... There's a <span><button onclick='spanClick(\"inspect cat\")'>cat</button></span> up there! ...it doesn't seem to want to come down.";
                catDiscovered = true;
                catTreeZoom();
                break;
            case roomNum === 4  && marbleDown === false   && catDiscovered === true   && inp('climb')  &&    inp('tree') && !inp('different') && !inp('other')   :
                output.innerHTML = "You start to climb the tree, but the cat hisses and swipes a paw at you. Rude!";
                catTreeZoom();
                break;
            case roomNum === 4  && marbleDown === false  &&  inp('climb')  &&    inp('tree')  && !inp('different') && !inp('other')  :
                catTreeZoom();
                output.innerHTML = "You start to climb the tree... but there's a cat in the tree! It hisses and swipes a paw at you. Rude!";
                catDiscovered = true;
                break;
                // psp       XXX it would be funny if this worked
            case roomNum === 4  && marbleDown === false &&  inp('psp')   :
                catDiscovered = true;
                catTreeZoom();
                output.innerHTML = "The cat eyes you curiously...";
                break;
            case roomNum === 4  && marbleReunited === false &&  inp('psp')   :
                catDiscovered = true;
                catTreeZoom();
                output.innerHTML = "<span>Meow!!</span>";
                break;
                // catch-all for trees
            case roomNum === 4  && inp('tree') && !inp('climb') :
                output.innerHTML = "There's a tall tree in the center of the glade. It looks like a perfect home for an animal.";
                break;
                // catch-all for cat
            case roomNum === 4  && inp('cat ')  && marbleReunited === false && catDiscovered === false :
                output.innerHTML = "There's a cat in the tree!";
                catTreeZoom();
                catDiscovered = true;
                break;
            case roomNum === 4  && inp('cat ')  && marbleReunited === false && catDiscovered === false :
                output.innerHTML = "The cat is black with white socks.";
                break;

            // ROOM 5
                // wake up robot
            case roomNum === 5  && robotAwake === false &&  haveBattery === false && (inp('talk')||inp('inquire')||inp('strange')||inp('ask')||inp('question')||inp('converse')||inp('robot')||inp('turn on')||inp('switch')||inp('figure')||inp('person')||inp('thing')||inp('machine')||inp("button")||inp('activate')||inp('operate')||inp('speak')) :
                output.innerHTML = "The robot is turned off, or sleeping.<br><br>There's a spot where a battery could go, but it's empty.";
                robotZoom();
                break;
            case roomNum === 5  && robotAwake === false && haveBattery === true &&  (inp('talk')||inp('inquire')||inp('strange')||inp('ask')||inp('question')||inp('converse')||inp('robot')||inp('turn on')||inp('switch')||inp('figure')||inp('person')||inp('thing')||inp('machine')||inp("button")||inp('activate')||inp('operate')||inp('tree')||inp('speak')||inp('battery')) :
                currentCutscene = "robot waking";
                removeItem("a <span><button onclick='spanClick(\"inspect battery\")'>battery</button></span>");
                haveBattery = false;
                playCutscene();
                robotAwake = true;
                room12Switch();
                output.innerHTML = "You carefully put the battery in the robot...";
                // createRobotConversation();
                break;
                // talk to the robot
            case roomNum === 5 && robotAwake === true  &&  (inp('talk')||inp('inquire')||inp('ask')||inp('question')||inp('converse')||inp('robot')||inp('turn on')||inp('switch')||inp('figure')||inp('person')||inp('thing')||inp('machine')||inp("button")||inp('activate')||inp('operate')||inp('speak'))  :
                createRobotConversation();
                break;
                // looking around
            case roomNum === 5 &&    (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what')) && robotAwake === false  &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "A <span><button onclick='spanClick(\"talk robot\")'>strange figure</button></span> is lying under a tree by the lake shore.<br><br>To the <span><button onclick='spanClick(\"go west\")'>west</button></span>, a narrow path leads back the the glade where you awoke. To the <span><button onclick='spanClick(\"go north\")'>north</button></span>, a wooded path cuts into the forest.";
                break;
            case roomNum === 5 &&    (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what')) && robotAwake === true  &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "A <span><button onclick='spanClick(\"talk robot\")'>robot</button></span> is standing under a tree by the lake shore. <br><br>To the <span><button onclick='spanClick(\"go north\")'>north</button></span>, a wooded trail leads into the forest. The lake shore continues <span><button onclick='spanClick(\"go east\")'>eastward.</button></span>";
                break;
            case roomNum === 5  && robotAwake === false &&     (inp('tree')||inp('branch'))     :
                output.innerHTML = "There's a <span><button onclick='spanClick(\"talk robot\")'>robot</button></span> lying under a tree by the lake shore. It looks like it's sleeping, or powered down.";
                break;
            case roomNum === 5 &&    (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass with scattered <span><button onclick='spanClick(\"take rock\")'>rocks</button></span> and such. You don't find anything of use.";
                break;
            case roomNum === 5  &&  robotAwake === false  &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what'))   &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('pond')||inp('stream')||inp('ocean')||inp('bank')||inp('shore'))     :
                output.innerHTML = "The water is cool and clear, and a few fish drift lazily along. You search around the banks, but don't find anything particularly useful.<br><br>The <span><button onclick='spanClick(\"talk robot\")'>strange metallic figure</button></span> resting under the tree catches your eye.";
                break;

            // ROOM 6
                // Looking Around
            case roomNum === 6 &&  ropeTaken === false && boatFixed === false && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what'))   &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('pond')||inp('stream')||inp('ocean')||inp('bank')||inp('shore')||inp('beach'))     :
                output.innerHTML = "The water is cool and clear, and a few fish drift lazily along.<br><br>There is an old half-sunk <span><button onclick='spanClick(\"inspect boat\")'>boat</button></span> tied up near the shore.";
                break;
            case roomNum === 6 &&  ropeTaken === true && boatFixed === false && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what'))   &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('pond')||inp('stream')||inp('ocean')||inp('bank')||inp('shore')||inp('beach'))     :
                output.innerHTML = "The water is cool and clear, and a few fish drift lazily along.<br><br>There is an old half-sunk <span><button onclick='spanClick(\"inspect boat\")'>boat</button></span> near the shore.";
                break;
            case roomNum === 6 &&  ropeTaken === false &&  boatFixed === true && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what'))   &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "You find yourself on the eastern shore of a lake. The <span><button onclick='spanClick(\"inspect boat\")'>boat</button></span> is tied up with a thick <span><button onclick='spanClick(\"inspect rope\")'>rope.</button></span>";
                break;
            case roomNum === 6 &&  ropeTaken === false &&  boatFixed === false && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what'))   &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "You find yourself on the eastern shore of a lake, whhere a half-sunk <span><button onclick='spanClick(\"inspect boat\")'>boat</button></span> is tied up with a thick <span><button onclick='spanClick(\"inspect rope\")'>rope.</button></span>";
                break;
            case roomNum === 6 &&  ropeTaken === true &&  boatFixed === true && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what'))   &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "You're standing on the shore of a lake. The <span><button onclick='spanClick(\"inspect boat\")'>boat</button></span> has been pulled up onto the lakeshore.";
                break
            case roomNum === 6 &&    (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass with scattered rocks and such.";
                break;
                // Attempting to Ride The Boat
            case roomNum === 6    && haveBox === false  &&  boatFixed === false && (inp('get')||inp('take')||inp('ride')||inp('use'))   &&    (inp('boat'))  :
                output.innerHTML = "The <span><button onclick='spanClick(\"inspect boat\")'>boat</button></span> has a fist-size hole in the bottom and is filled with water. Maybe you can find something to plug the hole with.";
                boatZoom();
                break;
            case roomNum === 6    && haveBox === true  && boatFixed === false && (inp('get')||inp('take')||inp('ride'))   &&    (inp('boat'))  :
                boatZoom();
                output.innerHTML = "The <span><button onclick='spanClick(\"inspect boat\")'>boat</button></span> has a fist-sized hole in the bottom. Maybe you can plug it with something.";
                break;
            case roomNum === 6   && boatFixed === true  && ropeTaken === false && (inp('get')||inp('take')||inp('ride')||inp('go '))   &&    (inp('boat'))  :
                ropeTaken = true;
                haveRope = true;
                switchChestRopeImage();
                // findObject("rope");
                inventory.push("a <span><button onclick='spanClick(\"inspect rope\")'>rope</button></span>")
                currentCutscene = "riding boat";
                playCutscene();
                room15Switch();
                output.innerHTML = "You untie the rope and put it in your pocket, then push the boat out into the lake and hop in. Without paddles, you allow the tide to take you where it will.<br><br>Soon, the boat lands on the shore of an island.";
                break;
            case roomNum === 6   && boatFixed === true  && ropeTaken === true && (inp('get')||inp('take')||inp('ride')||inp('go '))   &&    (inp('boat'))  :
                currentCutscene = "riding boat";
                playCutscene();
                room15Switch();
                output.innerHTML = "You push the boat out into the lake and hop in. Without paddles, you allow the tide to take you where it will.<br><br>Soon the boat lands on the shore of an island.";
                break;
                // Fixing The Boat
            case roomNum === 6   && boatFixed === false && (inp('fix')||inp('repair')||inp('mend')||inp('patch')||inp('plug')||inp('use'))   &&  (inp('mud')||inp('clay')) :
                boatFixed = true;
                boatZoom();
                room6Switch();
                closeInventory();
                output.innerHTML = "You dig into the mud for some wet clay and mould it into shape. You carefully plug the hole, spend a few minutes bailing water out, and soon the boat begins to float again." + getPoints(10, boatFixed);
                break;
            case roomNum === 6   && boatFixed === false && inventory.length === 0 && (((inp('fix')||inp('repair')||inp('mend')||inp('patch')||inp('plug'))   &&    (inp('boat')||inp('hole')||inp('bottom'))) ||  (inp('rock') &&  (inp('hole')||inp('plug'))) ) && !inp('rock'):
                output.innerHTML = "How do you want to fix the boat?";
                break;
            case roomNum === 6   && boatFixed === false && (((inp('fix')||inp('repair')||inp('mend')||inp('patch')||inp('plug')||inp('boat')||inp('hole')||inp('bottom')||inp('with'))) &&  (inp('rock') )):
                boatFixed = true;
                removeItem("a <span><button onclick='spanClick(\"inspect rock\")'>rock</button></span>");
                haveRock = false;
                boatZoom();
                room6Switch();
                closeInventory();
                output.innerHTML = "You plug the hole in the bottom of the boat with a rock. After bailing out water for a few minutes, the boat starts to float again." + getPoints(10, boatFixed);
                break;
            case roomNum === 6   && boatFixed === false && (inp(' tool')||inp('hammer')||inp('glue') )  &&  (inp('look')||inp('search')||inp('find')):
                output.innerHTML = "You don't see any tools around.";
                break;
            case roomNum === 6   && boatFixed === false && (inp(' tool')||inp('hammer')||inp('glue')) :
                output.innerHTML = "You don't have any tools to fix the boat with.";
                break;
            case roomNum === 6   && boatFixed === false && (((inp('fix')||inp('repair')||inp('mend')||inp('patch')||inp('plug'))   &&    (inp('boat')||inp('hole')||inp('bottom'))) ||  (inp('rock') &&  (inp('hole')||inp('plug'))) ):
                displayInventory();
                fixingBoat = true;
                output.innerHTML = "What do you want to use to fix the boat?";
                break;

                // Searching The Boat
            case roomNum === 6   && ropeTaken === false  && boatFixed === false && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what')||inp('bottom')||inp('behind')||inp('under')||inp('what'))  &&    (inp('boat')||inp('moor'))  :
                boatZoom();
                output.innerHTML = "The <span><button onclick='spanClick(\"search boat\")'>boat</button></span> is half-sunk, and tied to the shore with a <span><button onclick='spanClick(\"inspect rope\")'>rope.</button></span> You look closer, and realize there is a fist-sized hole in the bottom.";
                break;
            case roomNum === 6   && ropeTaken === true  && boatFixed === false && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what')||inp('bottom')||inp('behind')||inp('under')||inp('what'))  &&    (inp('boat')||inp('moor'))  :
                boatZoom();
                output.innerHTML = "The <span><button onclick='spanClick(\"inspect boat\")'>boat</button></span> is half-sunk. You look closer, and realize there is a fist-sized hole in the bottom.";
                break;
            case roomNum === 6   && ropeTaken === false  && boatFixed === true && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what')||inp('bottom')||inp('behind')||inp('under')||inp('what'))  &&    (inp('boat')||inp('moor'))  :
                boatZoom();
                output.innerHTML = "The boat is tied to the shore with a thick <span><button onclick='spanClick(\"inspect rope\")'>rope.</button></span>";
                break;
            case roomNum === 6   && ropeTaken === true  && boatFixed === true && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what')||inp('bottom')||inp('behind')||inp('under')||inp('what'))  &&    (inp('boat')||inp('moor'))  :
                boatZoom();
                output.innerHTML = "What a nice boat!";
                break;

                //rope
            case roomNum === 6 &&   ropeTaken === false &&  boatFixed === false &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what'))   &&    (inp('rope'))     :
                output.innerHTML = "The <span><button onclick='spanClick(\"take rope\")'>rope</button></span> seems to be the only thing about the <span><button onclick='spanClick(\"inspect boat\")'>boat</button></span> that is still in decent condition.";
                boatZoom();
                break;
            case roomNum === 6 &&   ropeTaken === false &&    (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what'))   &&    (inp('rope'))     :
                output.innerHTML = "The <span><button onclick='spanClick(\"take rope\")'>rope</button></span> seems to be in decent condition.";
                boatZoom();
                break;
            case roomNum === 6    && ropeTaken === false && (    ((inp('take')||inp('grab')||inp('pocket')||inp('remove')||inp('get')||inp('use')||inp('tie'))   &&    (inp('rope')))  ||  (inp('tie') &&  inp('boat'))  ):
                haveRope = true;
                ropeTaken = true;
                switchChestRopeImage();
                // findObject("rope");
                inventory.push("a <span><button onclick='spanClick(\"inspect rope\")'>rope</button></span>")
                room6Switch();
                boatZoom();
                output.innerHTML = "You untie the rope and put it in your <span><button onclick='spanClick(\"check pockets\")'>pocket.</button></span>";
                break;
            case roomNum === 6 && ropeSet === true   &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what'))   &&    (inp('rope'))     :
                output.innerHTML = "The rope that was tied to the <span><button onclick='spanClick(\"inspect boat\")'>boat</button></span> is back at the well.";
                break;
            case roomNum === 6 &&   ropeTaken === true && (inp('take')||inp('grab')||inp('pocket')||inp('get'))   &&    (inp('rope'))     :
                output.innerHTML = "You already took the rope.";
                break;    
            case roomNum === 6 && haveRope === true && inp('rope') && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')|inp('check')||inp('what')):
                output.innerHTML = "The rope is old and worn, but strong.";
                break;
            case roomNum === 6 && haveRope === true && inp('rope'):
                output.innerHTML = "You don't need to use the rope here.";
                break;

            // ROOM 7
                // inspect / explore dark
            case roomNum === 7  && firefliesReleased === false &&  (inp('look'))   &&    (inp('cave')||inp('around')) :
                output.innerHTML = "You strain your eyes against the dark, but you can barely see your hand when you wave it in front of your eyes.";
                break;
            case roomNum === 7 && (inp('rope'))  && firefliesReleased === false && haveRope === true && haveCrystal === false :
                output.innerHTML = "You tie one end of the rope to a rock near the cave entrance and hold the other end as you walk into the darkness.<br><br>With your hands out in front of you, you slowly feel your way through through the maze of rock. Some of the walls around you feel rough and stoney, while others feel smooth and glassy.<br><br>Eventually you reach the end of the rope. Before you turn back, you fumble around the ground and grab a strange smooth rock and put it in your <span><button onclick='spanClick(\"check pockets\")'>pocket.</button></span>";
                inventory.push("a <span><button onclick='spanClick(\"inspect crystal\")'>strange crystal</button></span>");
                haveCrystal = true;
                findObject("crystal");
                break;
            case roomNum === 7 && (inp('rope'))  && firefliesReleased === true && haveRope === true :
                output.innerHTML = "You check around the cave, but it doesn't seem like the rope will be much help right now.";
                break;
            case roomNum === 7 &&  (inp('feel'))   &&    (inp('cave')||inp('around')||inp('wall')) && firefliesReleased === false :
                output.innerHTML = "The walls of the cave are rough rock. You feel your way forward as far as you can, but the light starts to disappear behind you, so you turn around and head back.";
                break;
            case roomNum === 7 &&  (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('look')||inp('what'))   &&    (inp('cave')||inp('around')||inp('there')) && firefliesReleased === false :
                output.innerHTML = "You feel your way around the cave. The ground is rocky and the walls smooth. It's much too dark to see anything...<br><br>You fumble around for a while, until you smash your shin against something hard and abandon your search.";
                break;
                
                // inspect / explore light
            case roomNum === 7 &&  (inp('look'))   &&    (inp('cave')||inp('around')) && firefliesReleased === true :
                output.innerHTML = "The cave is full of glowing <span><button onclick='spanClick(\"take crystal\")'>crystals</button></span>! The light from the fireflies catches every surface and facet of the magnificent gems.<br><br>There is another passageway leading <span><button onclick='spanClick(\"go west\")'>west.</button></span>";
                break;
            case roomNum === 7 &&  (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what'))   &&    (inp('cave')||inp('around')) && firefliesReleased === true :
                output.innerHTML = "The cave is full of magnificent glowing <span><button onclick='spanClick(\"take crystal\")'>crystals</button></span> protruding from the walls and littering the ground.<br><br>There is another passageway leading <span><button onclick='spanClick(\"go west\")'>west</button></span>";
                break;
            case roomNum === 7 &&  inp('stala') && firefliesReleased === true :
                output.innerHTML = "The cave is full of dripping stalactites and stalagmites. You used to have a hard time telling them apart, until you learned this helpful mnemonic device:<br><br>'Satactites' hang TIGHT from the ceiling, but be careful of stalagmites: you MIGHT trip over them!";
                break;
                // interact with crystal
            case roomNum === 7 &&  (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('look')||inp('behind')||inp('what'))   &&    (inp('crystal')||inp('gem')||inp('diamonds')) && firefliesReleased === true :
                output.innerHTML = "There are abudnances of <span><button onclick='spanClick(\"take crystal\")'>crystals</button></span> in every corner of the cave.";
                break;
            case (roomNum === 7 || roomNum === 8) &&  (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab'))  && (inp('crystal')||inp('gem')||inp('diamonds')) && firefliesReleased === true :
                output.innerHTML = "You pick up a small piece of crystal. It's surprisingly warm in your hand, and seems to magnify the light from the fireflies.<br><br>You put the crystal in your <span><button onclick='spanClick(\"check pockets\")'>pocket.</button></span>";
                inventory.push("a <span><button onclick='spanClick(\"inspect crystal\")'>strange crystal</button></span>");
                findObject("crystal");
                haveCrystal = true;
                break;
            case (roomNum === 7 || roomNum === 8) &&  (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab'))  && (inp('crystal')||inp('gem')||inp('diamonds')) && firefliesReleased === true  && haveCrystal === true  :
                output.innerHTML = "You already have a crystal in your <span><button onclick='spanClick(\"check pockets\")'>pocket.</button></span>";
                break;
            case roomNum === 7 && firefliesReleased===true && (inp('box')||inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get'))   &&    inp('fire')  &&  boxUnlocked === true  && haveFireflies === false :
                output.innerHTML = 'You catch a firefly, and very carefully put it in the <span><button onclick=\'spanClick(\"inspect box\")\'>wooden box</button></span> and close the lid.<br><br>You catch another, and another, and pretty soon the box is full of fireflies!';
                removeItem("a <span><button onclick='spanClick(\"inspect box\")'>wooden box</button></span>");
                removeItem("a <span><button onclick='spanClick(\"inspect box\")'>smashed-up box</button></span>");
                inventory.push("a <span><button onclick='spanClick(\"inspect box\")'>box of fireflies</button></span>");
                haveFireflies = true;
                switchChestRopeImage();
                break;
            case roomNum === 7 &&  firefliesReleased===true &&  (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The cave floor is a rough stone, and covered in stalagmites and <span><button onclick='spanClick(\"take crystal\")'>crystals</button></span>";
                break;
            case roomNum === 7 &&    (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "It's too dark to see anything.";
                break;
            case (roomNum === 7 || roomNum === 8) && (inp('exit')||inp('leave'))   &&    (inp('cave')) :
                room11Switch();
                goSouthAnimation();
                roomNum = 11;
                userInput.value = "";
                break;

            // ROOM 9
                // look around
            case roomNum === 9  && (ghostDiscovered === false || ghostGivenMug === true)  &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('forest')||inp('around'))  :
                output.innerHTML = "You find yourself in what be one of the most ancient parts of the forest. The trees here look like they haven't seen sunlight in years.<br><br>There is a circle of <span><button onclick='spanClick(\"inspect mushrooms\")'>mushrooms</button></span> in the middle of the hollow, surrounded by old and rotting trees.";
                break;
            case roomNum === 9 &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('forest')||inp('around'))   :
                output.innerHTML = "There is a <span><button onclick='spanClick(\"ask ghost\")'>ghostly figure</button></span> hovering in a circle of <span><button onclick='spanClick(\"inspect mushrooms\")'>mushrooms</button></span><br><br>This must be the oldest part of the forest. The trees here look like they haven't seen sunlight in years.";
                break;
                // take / inspect mushrooms & discover ghost
            case roomNum === 9 && ghostDiscovered === false   &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('take')||inp('grab')||inp('pocket')||inp('eat')||inp('behind')||inp('what')||inp('explore'))   &&    (inp('mushroom')||inp('circle')||inp('forest'))  :
                currentCutscene = "ghost appearing";
                playCutscene();
                ghostDiscovered = true;
                room9Switch();
                ghostZoom();
                output.innerHTML = "You reach for a mushroom...";
                break;
                // take mushrooms after ghost given mug
            case roomNum === 9 && ghostGivenMug === true && haveMushy === false  &&  ( (inp('take')||inp('grab')||inp('pocket')||inp('gather')||inp('pick'))   )  &&    (inp('mushroom')||inp('circle'))  :
                output.innerHTML = "You pick a nice looking mushroom and put it in your <span><button onclick='spanClick(\"check pockets\")'>pocket.</button></span>";
                haveMushy = true;
                inventory.push("a <span><button onclick='spanClick(\"inspect mushroom\")'>wild mushroom</button></span>");
                document.getElementById("inventory3").src="./inventoryimages/mushy.png";
                break;
                // ghost interupts mushroom picking
            case roomNum === 9 && ghostDiscovered === true  && ghostGivenMug === false  &&  (inp('search')||inp('take')||inp('grab')||inp('pocket')||inp('eat')||inp('gather')||inp('pick'))   &&    (inp('mushroom')||inp('circle'))  :
                output.innerHTML = 'You take a step towards the mushrooms, but the ghostly figure gives you an icy stare that freezes you in your tracks.<br><br>A voice whispers...<br><br>"<span class="journal">Moon... cactus... the well...</span>"';
                ghostZoom();
                break;
                // look at mushrooms
            case roomNum === 9 &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('check')||inp('what'))   &&    (inp('mushroom')||inp('circle')) :
                output.innerHTML = 'The mushrooms are red with white spots. You can\'t decide whether they look delicious, or deadly.';
                break;
                // give ghost mug
            case roomNum === 9 && ghostDiscovered === true  && ghostGivenMug === false && haveMug === true  && ( (inp('give')||inp('hand')||inp('offer')||inp('return')||inp('show')||inp('use'))   &&   ( inp('mug')||inp('cup') ) ) ||  ( ( inp('mug')||inp('cup') ) && ( (inp('ghost')||inp('figure'))) ) :
                room9Switch();
                output.innerHTML = 'The ghost fades away, and you catch a faint whisper in the wind:<br><br>"<span class="journal">Thank you...</span>"<br><br>Maybe it\'s just your imagination, but suddenly the forest around you seems a bit brighter.' + getPoints(75, ghostGivenMug);
                ghostGivenMug = true;
                haveMug = false;
                currentCutscene = "ghost given mug";
                playCutscene();
                removeItem("an <span><button onclick='spanClick(\"inspect mug\")'>old mug</button></span>");
                break;
            case roomNum === 9 && ghostDiscovered === true  && ghostGivenMug === false && haveMug === true  &&  inp('mug')  :
                output.innerHTML = "What do you want to do with the mug?"
                ghostZoom();
                break;
                // interact with ghost
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false  &&  (inp('ask')||inp('question')):
                output.innerHTML = 'You gather the courage to ask the ghost what it wants.<br><br>A voice whispers...<br><br><span class="journal">"Moon... cactus... the well..."';
                ghostZoom();
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false  &&  (inp('talk')||inp('chat')||inp('hello')||inp('say')||inp(' hi')||inp('listen')||inp('speak')):
                output.innerHTML = 'A voice whispers...<br><br><span class="journal">"Moon... cactus... the well...</span>"<br><br>What could that mean?';
                ghostZoom();
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false  &&  (inp('flirt')||inp('compliment')||inp('flatter')||inp('charm')) :
                output.innerHTML = 'The ghost seems to blush...<br><br><span class="journal">"Sorry... I don\'t like you like that.</span>"';
                ghostZoom();
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false  && haveFlower === true && ghostGivenFlower === false && inp('flower') && (inp('give')||inp('offer')||inp('hand')) :
                room9Switch();
                output.innerHTML = 'You offer the ghost a flower. Maybe it\'s just a trick of the light, but the ghost seems to blush.<br><br><span class="journal">"...Thanks..."</span><br><br>The ghost doesn\'t move from the path, but it does seem a bit cheerier.' + getPoints(25, ghostGivenFlower);
                ghostGivenFlower = true;
                ghostZoom();
                break;
            case roomNum === 9 && ghostDiscovered === true && haveFlower === false && ghostGivenFlower === false && inp('flower') && (inp('give')||inp('offer')||inp('hand')) :
                output.innerHTML = 'You don\' have a flower.';
                ghostZoom();
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false  &&  inp('boo') || inp('scare') ||  inp('frighten') ||  inp('shoo') ||  inp('curse') :
                output.innerHTML = 'The ghost doesn\'t seem scared of you...';
                ghostZoom();
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false &&  (inp('hit')||inp('push')||inp('punch')||inp('kick')||inp('beat')||inp('fight')||(inp('throw')&&inp('rock')))  &&    (inp('ghost')||inp('figure'))  :
                output.innerHTML = 'It\'s a freaking ghost yo! It would probably whip your butt.<br><br>Besides, doesn\'t look solid.';
                ghostZoom();
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false &&  (inp('touch')||inp('move'))  &&    (inp('ghost')||inp('figure'))  :
                output.innerHTML = 'The ghost is totally freaking you out... there\'s no way you\'re getting close.';
                ghostZoom();
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && inp('run') :
                goWestAnimation();
                room2Switch();
                output.innerHTML = "Got away safely!";
                break;
            case roomNum === 9 && inp('leave') && !inp('leaves') :
                goWestAnimation();
                room2Switch();
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && (inp('cast')||inp('spell')||inp('magic')||inp('exorcis')||inp('incantation')||inp('enchant')||inp('hypno')||inp('tranc')) :
                output.innerHTML = "You've never been very good at spells and encantations, especially not when standing in front of a real ghost.";
                ghostZoom();
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && haveRibbon === true && inp('ribbon')  :
                output.innerHTML = "You offer the ribbon to the ghost.<br><br><span class='journal'>\"No... thanks...\"</span>";
                ghostZoom();
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && haveRibbon === true && inp('rope')  :
                output.innerHTML = "I don't think the ghost can use that.";
                ghostZoom();
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && haveCrystal === true && (inp('crystal')||inp('gem'))  :
                output.innerHTML = "You offer the crystal to the ghost.<br><br><span class='journal'>\"Jen... would love that...\"</span><br><br>Who could 'Jen' be?";
                ghostZoom();
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && haveCrystal === true && inp('key') && haveBoxKey === true && haveBox === false  :
                output.innerHTML = "You show the key to the ghost.<br><br><span class='journal'>\"Box... boat...\"</span>";
                ghostZoom();
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && haveCrystal === true && inp('key') && haveBox === true && haveBoxKey === true :
                output.innerHTML = "You offer the key to the ghost.<br><br><span class='journal'>\"No... thanks...\"</span>";
                ghostZoom();
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && haveCrystal === true && inp('box') && haveBox === true :
                output.innerHTML = "You offer the box to the ghost.<br><br><span class='journal'>\"Not... mine...\"</span>";
                ghostZoom();
                break;
                // catch-all for ghosts and mushrooms
            // case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && inp('ghost') :
            //     output.innerHTML = "The ghost hovers eerily over the mushrooms.<br><br>It seems like it's trying to say something...";
            //     ghostZoom();
            //     break;
            // case roomNum === 9 && ghostDiscovered === true  && ghostGivenMug && inp('ghost') :
            //     output.innerHTML = "The ghost is gone, and all that's left in its place is a lingering feeling of gratitude.";
            //     break;
            case roomNum === 9 &&  inp('mushroom') && ghostDiscovered === false:
                currentCutscene = "ghost appearing";
                playCutscene();
                ghostDiscovered = true;
                room9Switch();
                ghostZoom();
                output.innerHTML = "You reach for a mushroom...";
                break;
        

            // ROOM 10
            case roomNum === 10 &&  (inp('use')||inp('tie')||inp('attach')||inp('set')||inp('throw')||inp('drop')||inp('toss'))   &&    (inp('rope')||inp('well'))   &&  haveRope === true  && ropeSet === false :
                ropeSet = true;
                haveRope = false;
                removeItem("a <span><button onclick='spanClick(\"inspect rope\")'>rope</button></span>");
                room10Switch();
                switchChestRopeImage();
                output.innerHTML = "You tie the rope to the top of the well. It seems pretty secure...";
                wellZoom();
                break;
            case roomNum === 10 &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "You find yourself standing in front of a stone <span><button onclick='spanClick(\"inspect well\")'>well</button></span> in the middle of a clearing. From here, a rocky path leads <span><button onclick='spanClick(\"go north\")'>north.</button></span> You can hear the sound of water to the <span><button onclick='spanClick(\"go south\")'>south.</button></span>";
                break;
            case roomNum === 10 && haveRope === false && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('peer')||inp('behind')||inp('what'))   &&    (inp('well'))     :
                output.innerHTML = "You peer down into the well, but it's too deep to see the bottom.<br><br>It seems old and out of use. You look around for a bucket or rope, but don't find one.";
                wellZoom();
                break;
            case roomNum === 10 &&  (inp('look')||inp('inspect')||inp('reach')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('peer')||inp('behind')||inp('what'))   &&    (inp('well'))     :
                output.innerHTML = "You peer down into the well, but it's too deep to see the bottom.<br><br>It seems old and out of use. You look around for a bucket, but don't find one.";
                wellZoom();
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('rock')    :
                output.innerHTML = "You drop a rock into the well. It clatters off the walls for a few seconds before falling silent.<br><br>No splash... it must be dry, or really deep.";
                wellZoom();
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss')||inp('chuck'))  &&  inp('stick')    :
                output.innerHTML = "You throw a stick into the well. It clatters off the walls for a few seconds before falling silent.<br><br>No splash... it must be dry, or really deep.";
                wellZoom();
                if (haveStick === true) {
                    output.innerHTML = "You throw your stick into the well. It clatters off the walls for a few seconds before falling silent.<br><br>No splash... it must be dry, or really deep.";
                    removeItem("a <span><button onclick='spanClick(\"inspect stick\")'>stick</button></span>");
                    haveStick = false;
                };
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  (inp('money')||inp('coin')||inp('penny')||inp('quarter')||inp('dime')||inp('nickel')) :
                output.innerHTML = "You search your pockets for a coin to throw in the well, but no luck.";
                wellZoom();
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('flower')  && haveFlower === true   :
                output.innerHTML = "You drop a flower into the well. It drifts lazily down into the darkness until you lose sight of it.";
                haveFlower = false;
                removeItem("a <span><button onclick='spanClick(\"inspect flower\")'>blue flower</button></span>");
                wellZoom();
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('flower')  && haveFlower === false   :
                output.innerHTML = "You don't have a flower to drop!";
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('crystal') && haveCrystal === true   :
                output.innerHTML = "You throw the crystal down the well. It hits the side and breaks apart before falling out of sight.";
                removeItem("a <span><button onclick='spanClick(\"inspect crystal\")'>strange crystal</button></span>");
                wellZoom();
                haveCrystal = false;
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('box') && haveBox === true  && ropeTaken === true && haveBoxKey === false && boxUnlocked === false :
                output.innerHTML = "Ok that's a good idea ngl. The box wouuld probably break when it hit the bottom. Points for ingenuity.<br><br>But you're gonna need the box later, ok? So you can't do that.<br><br>Try checking the rocks down by the lake, there's a key down there you can open the box with." + getPoints(10, triedToThrowBox);
                triedToThrowBox = true;
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('box') && haveBox === true  :
                output.innerHTML = "The box would probably break, which would be kind of a shame.";
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('mug') && haveMug === true   :
                output.innerHTML = "You just brought the mug up! Better not drop it again.";
                break;
            case roomNum === 10 && ropeSet === false  && (inp('jump')||inp('down')||inp('fall')||inp('go'))   &&    (inp('well'))  && !(inp('throw')||inp('drop')||inp('toss')||inp('look')||inp('peer')||inp('inspect')||inp('examine')||inp('tell me about')||inp('search')) :
                output.innerHTML = "...you climb into the well...";
                currentCutscene = "well fall";
                playCutscene();
                break;
            case roomNum === 10 &&  inp('use') &&   inp('well')  && ropeSet === false :
                wellZoom();
                output.innerHTML = "The well doesn't have a bucket or rope.";
                break;
            case roomNum === 10  && ropeSet === true   &&  (  (inp('go')&& inp('down'))   ||  (inp('use') && (inp('well')|| inp('rope'))) || inp('climb')) :
                climbDownAnimation();
                room13Switch();
                output.innerHTML = "You test the rope, and then carefully lower yourself into the well...<br><br>The bottom of the well is dry, and littered with some rocks and other objects that have fallen down throughout the years.<br><br>A <span><button onclick='spanClick(\"enter tunnel\")'>tunnel</button></span> in the stone wall leads deeper into the darkness.";
                roomNum = 13;
                break;
            case roomNum === 10  && ropeSet === false  &&  (inp('climb')) &&   (inp('well')||inp('down'))  :
                output.innerHTML = "...you climb into the well...";
                currentCutscene = "well fall";
                playCutscene();
                break;
            case roomNum === 10 &&  ropeSet === true &&  (inp('take')||inp('grab')||inp('pocket')||inp('untie')||inp('remove')||inp('get'))   &&    (inp('rope'))     :
                haveRope = true;
                ropeSet = false;
                inventory.push("a <span><button onclick='spanClick(\"inspect rope\")'>rope</button></span>");
                room10Switch();
                switchChestRopeImage();
                output.innerHTML = "You untie the rope and put it in your <span><button onclick='spanClick(\"check pockets\")'>pocket.</button></span>";
                break;
            case roomNum === 10 && inp('wish') :
                output.innerHTML = "You pick up a rock, close your eyes, and toss it down into the well.<br><br>The stone clatters off the stone walls and disappears into the darkness.<br><br>No splash... it must be dry, or really deep.";
                break;
            case roomNum === 10 &&    (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass with scattered rocks and such. You don't find anything of use.";
                break;
                // default well
            case roomNum === 10 && inp('in ') && inp('well') :
                wellZoom();
                output.innerHTML = "You peer down into the well, but you can't see the bottom.";
                break;
            case roomNum === 10 && inp('bucket') :
                output.innerHTML = "You don't see a bucket nearby.";
                break;
            case roomNum === 10 && inp('water') && inp('well') :
                output.innerHTML = "You don't have a bucket to draw water with. The well seems dry anyway.";
                break;
            case roomNum === 10 && inp('rope') && (inp('look')||inp('search')||inp('check'))  && haveRope === false && ropeSet === false :
                output.innerHTML = "You don't see a rope nearby.";
                break;
            case roomNum === 10 && inp('rope') && haveRope === false && ropeSet === false :
                output.innerHTML = "You don't have a rope.";
                break;
            case roomNum === 10 && inp('rope') && inp('test') && ropeSet === true :
                output.innerHTML = "You test the rope. Seems secure!";
                break;

            // ROOM 11
            case roomNum === 11 &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('forest')||inp('around')) :
                if (caveInspected === false) {
                    //playCaveCutscene();
                    caveInspected = true;
                };
                output.innerHTML = "You're standing in front of a large <span><button onclick='spanClick(\"inspect cavet\")'>cave</button></span> shrouded in darkness.<br><br>A stony path cuts through the forest to the <span><button onclick='spanClick(\"go south\")'>south</button></span> and <span><button onclick='spanClick(\"go east\")'>east.</button></span>";
                break;
            case roomNum === 11 &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('behind')||inp('what'))   &&    (inp('cave')) :
                if (caveInspected === false) {
                    //playCaveCutscene();
                    caveInspected = true;
                };
                output.innerHTML = "The cave is so dark you can hardly see past the threshold...";
                break;
            case roomNum === 11 &&  (inp('around')||inp('behind'))   &&    (inp('cave')) :
                if (caveInspected === false) {
                    //playCaveCutscene();
                    caveInspected = true;
                };
                output.innerHTML = "The only way <span><button onclick='spanClick(\"go north\")'>north</button></span> is through the cave...";
                break;
            case roomNum === 11 && (inp('rock')||inp('stone')||inp('pebble')) && (inp('throw')||inp('chuck')||inp('toss')) && haveRock === true   :
                output.innerHTML = "You throw your rock into the cave. It disappears into the dark with a clatter.";
                haveRock = false;
                removeItem("a <span><button onclick='spanClick(\"inspect rock\")'>rock</button></span>");
                break;
            case roomNum === 11 && (inp('rock')||inp('stone')||inp('pebble')) && (inp('throw')||inp('chuck')||inp('toss')) && haveRock === false   :
                output.innerHTML = "You throw a rock into the cave. It disappears into the dark with a clatter.";
                break;
            case roomNum === 11 && (inp('stick')||inp('branch')) && (inp('throw')||inp('chuck')||inp('toss')) && haveStick === true   :
                output.innerHTML = "You throw your stick into the cave. It disappears into the dark with a clatter.";
                haveStick = false;
                removeItem("a <span><button onclick='spanClick(\"inspect stick\")'>stick</button></span>");
                break;
            case roomNum === 11 && (inp('stick')||inp('branch')) && (inp('throw')||inp('chuck')||inp('toss')) && haveStick === false   :
                output.innerHTML = "You throw a stick into the cave. It disappears into the dark with a clatter.";
                break;
            case roomNum === 11 &&  (inp('go')||inp('enter')||inp('explore'))   &&    (inp('cave')||inp('rocks')||inp('cavern')) :
                room7Switch();
                goNorthAnimation();
                break;
            case roomNum === 11 &&  (inp('in ')||inp('what')) &&  (inp('cave')||inp('rocks')||inp('cavern')) :
                output.innerHTML = "You peer into the cave, but it's too dark inside to see anything...";
                break;
            case roomNum === 11 &&    (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass with scattered rocks and such. You don't find anything of use.";
                break;
            case roomNum === 11 && inp('cave') && inp('throw') :
                output.innerHTML = "You throw a rock into the cave, and you hear it echo as it clatters off the walls.";
                break;
            case roomNum === 11 && inp('cave')  :
                output.innerHTML = "There's something eery about this cave...";
                break;

            // ROOM 12
                // chest stuff
                case roomNum === 12  && haveBox === false && (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab')||inp('put')||inp('carry')) && (inp('box')||inp('chest'))   :
                haveBox = true;
                switchChestRopeImage();
                // findObject("box");
                room12Switch();
                inventory.push("a <span><button onclick='spanClick(\"inspect box\")'>wooden box</button></span>");
                output.innerHTML = "You put the <span><button onclick='spanClick(\"inspect box\")'>wooden box</button></span> in your <span><button onclick='spanClick(\"check pockets\")'>pocket.</button></span>";
                break;
            case roomNum === 12 && haveBox === false && haveBoxKey === true && (inp('box')||inp('chest')) :
                haveBox = true;
                haveRibbon = true;
                haveBattery = true;
                boxUnlocked = true;
                switchChestRopeImage();
                // findObject("box");
                thingsTriedSinceLastBigThing = 0;
                inventory.push("a <span><button onclick='spanClick(\"inspect battery\")'>battery</button></span>");
                inventory.push("a <span><button onclick='spanClick(\"inspect ribbon\")'>red ribbon</button></span>");
                inventory.push("a <span><button onclick='spanClick(\"inspect box\")'>wooden box</button></span>");
                room12Switch();
                displayInventory();
                output.innerHTML = "You use the silver key to open the box. There is a <span><button onclick='spanClick(\"inspect ribbon\")'>red ribbon</button></span> and a <span><button onclick='spanClick(\"inspect battery\")'>battery</button></span> inside.<br><br>You put the box, ribbon, and battery in your pocket." ;
                break;
            case roomNum === 12  &&  haveBox === false && (  ( haveBoxKey === false && (inp('open')||inp('pry'))) || (inp('search')||inp('examine')||inp('tell me about')||inp('look')||inp('inspect')||inp('search')||inp('check')) && (inp('box')||inp('chest')) )  :
                haveBox = true;
                // findObject("box");
                switchChestRopeImage();
                room12Switch();
                inventory.push("a <span><button onclick='spanClick(\"inspect box\")'>wooden box</button></span>");    
                output.innerHTML = "The wooden box is locked, and you don't have a key.<br><br>You put the box in your <span><button onclick='spanClick(\"check pockets\")'>pocket</button></span> for later.";
                break;

            // ROOM 15
                // looking around and inspecting things
            case roomNum === 15  && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what'))   &&    inp('around') :
                output.innerHTML = "You're on a island! That's pretty cool.<br><br>There's a large palm tree, a few rocks, and a big thing washed up on the shore that looks like the wing of an aircraft.";
                break;
            case roomNum === 15  &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('grab')||inp('take')||inp('pocket')||inp('get')||inp('under')||inp('behind')||inp('what'))  &&  (  inp('wing')||inp('turbine')||inp('blade')||inp('fan')||inp('white')||inp('gray')||inp('grey')||inp('thing')  ):
                output.innerHTML = "The object looks like the wing of an airplane, but on closer inspection, you realize it's actually more like the blade of a giant fan. It's wedged in the rocks on the shore. Grasses and sea vegetation have grown around it."
                break;
                // ride boat back
            case roomNum === 15 &&  (   (   (inp('get')||inp('take')||inp('ride'))   &&   (inp('boat'))   )  ||  (   ( inp('go')||inp('travel')) && (inp('forest')||inp('back'))  )  ||  (   inp('leave') && inp('island')   )  )  :
                room6Switch();
                output.innerHTML = "You ride the boat back to the forest.";
                break;
            case roomNum === 15 && (  inp('somewhere else')  || inp('other island')  || inp('different island') || inp('other place') || inp('differnt place') || inp('new place')  || inp('new island'))   :
                output.innerHTML = "This is the only island in the lake.";
                break;       

            // ROOM 13
            case roomNum === 13 &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what'))   &&    (inp('well')||inp('around')||inp('ground')||inp('floor')||inp('dirt'))  && mugTaken === false  :
                output.innerHTML = "The bottom of the well is dry and littered with rocks and grass. A <span><button onclick='spanClick(\"take mug\")'>dusty mug</button></span> is lying in the dirt.<br><br>A <span><button onclick='spanClick(\"enter tunnel\")'>tunnel</button></span> in the stone leads deeper into the darkness.";
                break;
            case roomNum === 13 &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what'))   &&    (inp('well')||inp('around')||inp('ground')||inp('floor')||inp('dirt'))  && mugTaken === true  :
                output.innerHTML = "The bottom of the well is dry and littered with rocks and grass.<br><br>A <span><button onclick='spanClick(\"enter tunnel\")'>tunnel</button></span> in the stone leads deeper into the darkness.";
                break;
            case roomNum === 13 &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('mug'))  && mugTaken === false   :
                output.innerHTML = "A <span><button onclick='spanClick(\"take mug\")'>dusty mug</button></span> is lying in the darkness of the well. It looks like it has a desert scene painted on it. Somebody must have dropped it down here.";
                break;
            case roomNum === 13 &&  (inp('take')||inp('grab')||inp('pocket')||inp('get'))   &&    (inp('mug'))  && mugTaken === false   :
                haveMug =true;
                mugTaken = true;
                inventory.push("an <span><button onclick='spanClick(\"inspect mug\")'>old mug</button></span>");
                haveMug = true;
                findObject("mug");
                room13Switch();
                output.innerHTML = "You put the mug in your <span><button onclick='spanClick(\"check pockets\")'>pocket.</button></span>";
                break;
            case roomNum === 13 &&  (inp('take')||inp('grab')||inp('pocket')||inp('get'))   &&    (inp('mug'))  && mugTaken === true   :
                output.innerHTML = "You already took the mug.";
                break;
            case roomNum === 13 && ( inp('climb') || ( (inp('go')||inp('use')) && (inp('up')||inp('rope')) )):
                room10Switch();
                climbUpAnimation();
                // roomNum = 10;
                break;
            case roomNum === 13 &&  ( ( inp('tunnel')||inp('cave')||inp('deep')||inp('hole')||inp('go in')) || ((inp("walk")||inp('go ')||inp('travel')||(inp('take')&&inp('me')))   &&    inp('right'))  || inp('east') ) :
                room16Switch();
                goEastThenSouthAnimation();
                break;

            // ROOM 16
                // looking around
            case roomNum === 16 &&  millSwitchOn === false &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('forest')||inp('around')) :
                output.innerHTML = "A large stone <span><button onclick='spanClick(\"inspect dam\")'>dam</button></span> looms to the north, from which a spout of water pours into a creek. An old <span><button onclick='spanClick(\"inspect water mill\")'>watermill</button></span> stands motionless on the bank of the creek.<br><br>There are some <span><button onclick='spanClick(\"take rock\")'>rocks</button></span> and <span><button onclick='spanClick(\"take stick\")'>sticks</button></span> strewn about.";
                break;
            case roomNum === 16 && millSwitchOn === true && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('forest')||inp('around')) :
                output.innerHTML = "A large stone <span><button onclick='spanClick(\"inspect dam\")'>dam</button></span> looms to the north, from which a spout of water pours into a creek. An old <span><button onclick='spanClick(\"inspect water mill\")'>watermill</button></span> is spinning busily on the bank of the creek.<br><br>You can feel the low rumble of machinery beneath your feet.";
                break;
            case roomNum === 16 &&    millSwitchOn === false &&   (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('mill')||inp('wheel')||inp('thing')||inp('paddle')) :
                output.innerHTML = "The watermill looks old, but the wood is still sturdy. There's some sort of <span><button onclick='spanClick(\"inspect mechanism\")'>mechanism</button></span> attached to the axle, but the switch has been broken off.";
                watermillZoom();
                break;
            case roomNum === 16  && millSwitchOn === true &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('mill')||inp('wheel')||inp('thing')||inp('paddle')) :
                output.innerHTML = "The watermill is spinning busily. You can feel a distant rumble of machinery beneath your feet.";
                watermillZoom();
                break;
            case roomNum === 16 &&  millSwitchOn === false &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('dam')||inp('wall')) :
                output.innerHTML = "The dam is huge. It's a bit creepy standing near it, knowing how much water is above you.<br><br>Water spills out of a pipe in the dam to feed a creek. The current drifts around the paddles of a <span><button onclick='spanClick(\"inspect water mill\")'>watermill</button></span>, but the wheel does not move.";
                break;
            case roomNum === 16 &&  millSwitchOn === true &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&    (inp('dam')||inp('wall')) :
                output.innerHTML = "The dam is huge. It's a bit creepy standing near it, knowing how much water is above you.<br><br>Water spills out of a pipe in the dam to feed a creek. The current drifts around the paddles of a spinning <span><button onclick='spanClick(\"inspect water mill\")'>watermill.</button></span>";
                break;
            case roomNum === 16 &&    (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "You search the ground around the mechanism. There are some <span><button onclick='spanClick(\"take rock\")'>rocks</button></span> and <span><button onclick='spanClick(\"take stick\")'>sticks</button></span> stewn about.";
                break;
            case roomNum === 16 && millSwitchOn === false &&   (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))  && (inp('mechanism')||inp('machine')) :
                output.innerHTML = "The watermill's heavy axle is supported by a wooden housing. There's a gap on the outside of the housing where a lever used to be.";
                watermillZoom();
                break;
            case roomNum === 16 && millSwitchOn === true &&   (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what'))  && (inp('mechanism')||inp('machine')||inp('lever')||inp('switch')) :
                output.innerHTML = "The watermill's heavy axle is supported by a wooden housing. You replaced the broken lever with a stick, and now the watermill is spinning busily.";
                watermillZoom();
                break;
                // attempts
            case roomNum === 16 && millSwitchOn === false &&   (inp('open')||inp('pry')||inp('take apart')||inp('unlock'))  && (inp('mechanism')||inp('machine')||inp('lever')||inp('mill')||inp('wheel')||inp('thing')||inp('paddle')) :
                output.innerHTML = "The mechanism's wooden housing is well made and sturdy. You can't figure out how to open it.<br><br>It looks like there's a place where a lever used to be, but it's broken. Maybe you can find something nearby to replace it.";
                watermillZoom();
                break;
            case roomNum === 16 && millSwitchOn === false &&   (inp('start')||inp('spin')||inp('pull'))  && (inp('mechanism')||inp('machine')||inp('lever')||inp('mill')||inp('wheel')||inp('thing')||inp('paddle')) :
                output.innerHTML = "The mechanifsm is jammed tight. It looks like there used to be a switch to start it, but it's been broken off.<br><br>There might be something around you can use to replace it.";
                watermillZoom();
                break;
            case roomNum === 16 && millSwitchOn === false &&   (inp('jump')||inp('hop')||inp('climb'))  && (inp('mechanism')||inp('machine')||inp('lever')||inp('mill')||inp('wheel')||inp('thing')||inp('paddle')) :
                output.innerHTML = "You climb onto the watermill, but nothing happens.";
                watermillZoom();
                break;
            case roomNum === 16 && millSwitchOn === false &&   (inp('hit')||inp('smash')||inp('wack')||inp('strick')||inp('break')||inp('punch')||inp('kick'))  && (inp('mechanism')||inp('machine')||inp('lever')||inp('mill')||inp('wheel')||inp('thing')||inp('paddle')) :
                output.innerHTML = "You hit the watermill with a rock, but nothing happens.";
                watermillZoom();
                break;
            case roomNum === 16   && millSwitchOn === false && ( inp('pipe')||inp('drain')||inp('spout')) && (inp('climb')||inp('jump')||inp('get on')||inp('stand on')):
                output.innerHTML = "You climb onto the water pipe, but the top of the wall is still much too high to reach.";
                break;
            case roomNum === 16 &&  millSwitchOn === false &&  (inp('climb')||inp('scale')||inp('jump')||inp('hop'))   &&    (inp('dam')||inp('wall')) :
                output.innerHTML = "The dam is too tall and steep to climb.";
                break;
            case roomNum === 16 &&  millSwitchOn === false && haveRope == true && inp('rope') && (inp('climb')||inp('scale')||inp('dam')||inp('wall')||inp('throw')||inp('toss')||inp('sling')) :
                output.innerHTML = "You attempt to toss the rope to the top of the dam, but it's much too high.";
                break;
            case roomNum === 16 &&  millSwitchOn === false  && (inp('lever')||inp('switch') ) :
                output.innerHTML = "You look around for the missing lever, but all you find are some  <span><button onclick='spanClick(\"take stick\")'>sticks</button></span> and <span><button onclick='spanClick(\"take rocks\")'>rocks.</button></span>";
                break;
            case roomNum === 16 &&  millSwitchOn === false  && haveStick === true &&(  ( inp('how') && (inp('fix') ||inp('use')))  || (inp('what'))    )      :
                output.innerHTML = "You might have something in your <span><button onclick='spanClick(\"check pockets\")'>pockets</button></span> that you can use to fix the machine.";
                break;
            case roomNum === 16 &&  millSwitchOn === false  &&  ( inp('how') && (inp('fix') ||inp('use')))     :
                output.innerHTML = "Maybe you can <span><button onclick='spanClick(\"search ground\")'>find something</button></span> nearby to fix the machine.";
                break;
            case roomNum === 16   && millSwitchOn === false && (((inp('rock')||inp('stone'))   &&    (inp('mill')||inp('machine')||inp('contraption')||inp('thing')||inp('paddle')||inp('switch')||inp('mechanism')||inp('lever')||inp('fix')||inp('use')||inp('with')))  ):
                output.innerHTML = "You try to unjam the mechanism with a rock, but the without success. You'll need something longer to reach into where the lever has broken off.";
                break;
            case roomNum === 16   && millSwitchOn === false &&  ( inp('pipe')||inp('drain')||inp('spout')||inp('water'))  &&( (inp('jam')||inp('clog')||inp('block')||inp('stop'))   || ((inp('push')||inp('put'))&&(inp('rock')||inp('dirt')))):
                output.innerHTML = "You push a rock into the pipe, but the pressure is too great and it is pushed out.";
                break;
            case roomNum === 16   && millSwitchOn === false && ( inp('pipe')||inp('drain')||inp('spout')):
                output.innerHTML = "Water pours from the pipe into the creek.";
                break;
            case roomNum === 16   && millSwitchOn === false && ((inp('tool')||inp('hammer'))  ):
                output.innerHTML = "You don't have any tools with you.";
                break;
            case roomNum === 16   && inp('rope') && millSwitchOn === false && haveRope === false  :
                output.innerHTML = "You don't have a rope.";
                break;

                // fixing the thing
            case roomNum === 16   && millSwitchOn === false && (((inp('stick')||inp('branch')||inp('tree'))   &&    (inp('mill')||inp('machine')||inp('contraption')||inp('thing')||inp('paddle')||inp('switch')||inp('mechanism')||inp('lever')||inp('fix')||inp('use ')||inp('with')))  ) && !inp('pipe')&& !inp('drain')  &&!inp('spout'):
                millSwitchOn = true;
                room16Switch();
                currentCutscene = "basket";
                playCutscene();
                output.innerHTML = "You push the stick into the broken part of the mechanism, and you hear something click. After a few moments, the water mill begins to spin on it's axle.<br><br>As the watermill's mechanism rumbles beneath your feet, a rope with a <span><button onclick='spanClick(\"inspect basket\")'>basket</button></span> large enough to sit in is lowered from the top of the wall.";
                break;
            case roomNum === 16   && millSwitchOn === false && inventory.length > 1 && (((inp('fix')||inp('repair')||inp('mend')||inp('patch')||inp('plug')||inp('open'))   &&    (inp('mill')||inp('machine')||inp('contraption')||inp('thing')||inp('paddle')||inp('switch')||inp('mechanism')||inp('lever')))  ):
                displayInventory();
                fixingMill = true;
                output.innerHTML = "What do you want to use to fix the watermill?";
                break;
            case roomNum === 16   && millSwitchOn === false && inventory.length === 0 && (((inp('fix')||inp('repair')||inp('mend')||inp('patch')||inp('plug')||inp('open'))   &&    (inp('mill')||inp('machine')||inp('contraption')||inp('thing')||inp('paddle')||inp('switch')||inp('mechanism')||inp('lever')))  ):
                output.innerHTML = "How do you want to fix the watermill?";
                break;
                // inspecting the basket
            case roomNum === 16   && millSwitchOn === true && (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('what')) && (inp('basket')||inp('bucket')||inp('barrel')||inp('rope'))     :
                output.innerHTML = "The wicker basket is fastened secruely to a sturdy rope, which leads up to the top of the dam.<br><br>The basket looks large enough to <span><button onclick='spanClick(\"ride basket\")'>sit in.</button></span>";
                break;
            case roomNum === 16   && millSwitchOn === true && (inp('rope'))  && !inp('climb') && !inp('go up')  :
                output.innerHTML = "The rope is securely fastened to the <span><button onclick='spanClick(\"inspect basket\")'>basket.</button></span>";
                break;
                // ride the basket
            case roomNum === 16   && millSwitchOn === true && (inp('ride')||inp('go up')||inp('climb')||inp('get in')||inp('basket'))     :
                room17Switch();
                climbUpAnimation();
                break;

                // default
            case roomNum === 16   && inp('fix') && millSwitchOn === false  :
                output.innerHTML = "Maybe there is something nearby you can fix the mill with.";
                break;

            // ROOM 17 
            case roomNum === 17 &&  bellRung === true  &&   (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&   inp('around') :
                output.innerHTML = "You're standing on a wooden platform at the top of the dam. A wooden pier extends over the crystal clear water of a lake towards an <span><button onclick='spanClick(\"inspect shrine\")'>old shrine.</button></span> A dim light glows through the shrine's windows from within.";
                break;
            case roomNum === 17 &&   (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&   inp('around') :
                output.innerHTML = "You're standing on a wooden platform at the top of the dam. A wooden pier extends over the crystal clear water of a lake towards an <span><button onclick='spanClick(\"inspect shrine\")'>old shrine.</button></span> A dim light glows through the shrine's windows from within.";
                break;
            case roomNum === 17 &&   (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&  ( inp('crane')||inp('basket')||inp('hoist')||inp('winch')||inp('machine')) :
                output.innerHTML = "The mechanism must be powered by the watermill below. The basket is waiting to take you <span><button onclick='spanClick(\"ride basket\")'>back down.</button></span>";
                break;
            case roomNum === 17 && bellRung === true &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&   (inp('shrine')||inp('shack')||inp('building')) :
                output.innerHTML = "The shrine is standing on wooden pilings above the lake. It looks old.<br><br> A <span><button onclick='spanClick(\"open door\")'>door</button></span> leads inside.";
                break;
            case roomNum === 17 &&   (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&   (inp('shrine')||inp('shack')||inp('building')) :
                output.innerHTML = "The shrine is standing on wooden pilings above the lake. It looks old.<br><br> A <span><button onclick='spanClick(\"open door\")'>door</button></span> leads inside.";
                break;
            case roomNum === 17 && bellRung === true &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&  ( inp('pier')||inp('walkway')||inp('wood')||inp('platform')) :
                output.innerHTML = "The pier leads from the top of the dam to the <span><button onclick='spanClick(\"inspect shrine\")'>shrine.";
                break;
            case roomNum === 17 &&   (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&  ( inp('pier')||inp('walkway')||inp('wood')||inp('platform')) :
                output.innerHTML = "The pier leads from the top of the dam to the <span><button onclick='spanClick(\"inspect shrine\")'>shrine.</button></span><br><br>You search the pier, but don't find anything useful.";
                break;
            case roomNum === 17 &&  bellRung === true &&  (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&  ( inp('pier')||inp('walkway')||inp('wood')||inp('platform')) :
                output.innerHTML = "The pier leads from the top of the dam to the <span><button onclick='spanClick(\"inspect shrine\")'>shrine.";
                break;
            case roomNum === 17 &&   (inp('look')||inp('see ')||inp('search'))   &&  ( inp('water')||inp('lake')||inp('pond')) :
                output.innerHTML = "The lakewater is crystal clear.";
                break;
            case roomNum === 17 &&   (inp('inspect')||inp('examine')||inp('tell me about')||inp('search')||inp('what'))   &&  ( inp('water')||inp('lake')||inp('pond')) :
                output.innerHTML = "The lakewater is crystal clear. You peer into the depths, but don't find anything particularly useful.";
                break;
            case roomNum === 17   &&  (inp('rope'))     :
                output.innerHTML = "The rope is securely fastened to the <span><button onclick='spanClick(\"inspect basket\")'>basket.</button></span>";
                break;
            case roomNum === 17   &&   ( ( (inp('jump')||inp('go ')||inp('leap'))&&( inp('water')||inp('lake')||inp('pond') ) )||  inp('dive') || inp('swim'))   :
                output.innerHTML = "There's no way to climb back out of the water.";
                break;
            case roomNum === 17   &&   inp('jump') && (inp('off')||inp('dam')||inp('wall')) :
                output.innerHTML = "It would be unsafe to jump into the water from this height.";
                break;
            case roomNum === 17   &&  ( inp('lamp')||inp('lantern')||inp('light')) && ((inp('take')||inp('remove'))  ) :
                output.innerHTML = "The lantern is securely attached to a wooden post.";
                break;
            case roomNum === 17   &&  (( inp('light')||inp('lantern')) && !inp('window') ) :
                output.innerHTML = "The lantern's dull glow reflects off the surface of the lake and the shrine's dusty windows.";
                break;
            case roomNum === 17   &&  inp('knock')  :
                output.innerHTML = "You knock on the door, but there is no response.";
                break;
            case roomNum === 17   && ( inp('dam')||inp('wall') ) && (inp('along')||inp('walk')) :
                output.innerHTML = "The top of the dam is too narrow to walk on.";
                break;
            case roomNum === 17   && ( inp('window') ||(inp('look')   && inp('in ')  && (inp('shrine')||inp('shack')||inp('building')))  ) :
                output.innerHTML = "You peer into the windows. There is something shining inside...";
                break;
            case roomNum === 17   && (  ( ( (inp('shrine')||inp('shack')||inp('building'))|| inp('across') ) &&  (inp('go')||inp('walk')||inp('explore')||inp('open'))  )  ||  ( inp('inside')||inp('enter')||inp('go in')||inp('open the door')||inp('open the shrine')||inp('open door')||(inp('walk')&&(inp('pier')||inp('platform')) ))  )   :
                room18Switch();
                enterShrineAnimation();
                break;
            case roomNum === 17  && (inp('ride')&&(inp('basket')||inp('down')))  || ((inp('take')||inp('climb')||inp('get in'))&&inp('basket') )    :
                room16Switch();
                climbDownAnimation();
                break;
            

            case inp('skip intro')   :
                moveAllRoomsBack();
                newGame = false;
                roomVisited[14] = true;
                roomVisited[10] = true;
                roomVisited[13] = true;
                roomVisited[6] = true;
                roomVisited[5] = true;
                roomVisited[9] = true;
                roomVisited[11] = true;
                document.getElementById("room11").src="./roomimages/smfmroom11.png";
                ropeTaken = true;
                haveRope = true;
                haveBox = true;
                haveBoxKey = true;
                inventory.push("a <span><button onclick='spanClick(\"inspect box\")'>wooden box</button></span>");
                inventory.push("a <span><button onclick='spanClick(\"inspect rope\")'>rope</button></span>");
                inventory.push("a <span><button onclick='spanClick(\"inspect key\")'>silver key</button></span>");
                switchChestRopeImage();
                ghostDiscovered = true;
                ghostGivenMug = true;
                mugTaken = true;
                roomNum = 9;
                introCutsceneDonePlaying = true;
                introCutsceneFirstHalfDonePlaying = true;
                introCutscenePlayed = true;
                goEastAnimation();
                room11Switch();
                break;

            case inp('skip to the end')   :
                moveAllRoomsBack();
                newGame = false;
                roomVisited[14] = true;
                roomVisited[10] = true;
                roomVisited[13] = true;
                roomVisited[6] = true;
                roomVisited[5] = true;
                roomVisited[9] = true;
                roomVisited[11] = true;
                roomVisited[18] = true;
                roomVisited[17] = true;
                roomVisited[16] = true;
                roomVisited[15] = true;
                roomVisited[7] = true;
                document.getElementById("room18").src="./roomimages/smfmroom18b.png";
                document.getElementById("room17").src="./roomimages/smfmroom17.png";
                ropeTaken = true;
                crystalPlaced = true;
                basketRidden = true;
                millSwitchOn = true;
                firefliesReleased = true;
                haveRope = true;
                haveBox = true;
                haveBoxKey = true;
                inventory.push("a <span><button onclick='spanClick(\"inspect box\")'>wooden box</button></span>");
                inventory.push("a <span><button onclick='spanClick(\"inspect rope\")'>rope</button></span>");
                inventory.push("a <span><button onclick='spanClick(\"inspect key\")'>silver key</button></span>");
                switchChestRopeImage();
                ghostDiscovered = true;
                ghostGivenMug = true;
                mugTaken = true;
                roomNum = 18;
                introCutsceneDonePlaying = true;
                introCutsceneFirstHalfDonePlaying = true;
                introCutscenePlayed = true;
                goEastAnimation();
                room18Switch();
                break;
            


            // ROOM 18
                // looking around
            case roomNum === 18   && ((inp('exit')||inp('leave')||inp('go back')||inp('outside') ) || inp('go out'))  :
                room17Switch();
                enterShrineAnimation();
                break;
            case roomNum === 18 &&   (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&   inp('around') :
                output.innerHTML = "Sunlight filters through the windows and casts dusty beams of light through the small interior of the shrine. <span><button onclick='spanClick(\"inspect bell\")'>golden bell</button></span> hangs above a <span><button onclick='spanClick(\"inspect dias\")'>wooden dias</button></span>, glowing faintly in the dim light.";
                break;
            case roomNum === 18 &&   (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&  ( inp('bell')||inp('gold') ):
                output.innerHTML = "The bell's golden surface is perfectly smooth. It catches the light from the windows, and almost seems to amplify it.";
                bellZoom();
                break;
            case roomNum === 18 &&   (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   && ( ( inp('dias')||inp('table')||inp('platform')||inp('stair') ) || (inp('wood')&&(inp('part')||inp('thing')))):
                output.innerHTML = "The dias is made of wood, and is positioned directly underneath the <span><button onclick='spanClick(\"inspect bell\")'>golden bell.</button></span> It looks like something used to rest here.";
                bellZoom();
                break;
            case roomNum === 18 &&   (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&   inp('window') :
                output.innerHTML = "You can see the lake outside the dusty windows.";
                break;
            case roomNum === 18 &&   (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('what'))   &&  ( inp('ceiling')||inp('roof')||inp('rafter'))  :
                output.innerHTML = "The shrine is old, but the roof is well made and seems weatherproof.<br><br>You search the rafters, but you don't find anything.";
                break;
                // random attempts
            case roomNum === 18 &&   inp('flower')  && (  inp('dias')||inp('table')||inp('platform')||inp('stair') ) :
                output.innerHTML = "You place a flower on the dias, but nothing happens.";
                bellZoom();
                break;
            case roomNum === 18 && haveBox === true &&  ( inp('box')||inp('chest') ) && (  inp('dias')||inp('table')||inp('platform')||inp('stair') ) :
                output.innerHTML = "You place the box on the dias, but nothing happens.";
                bellZoom();
                break;
            case roomNum === 18 && haveBattery === true && inp('battery')  && (  inp('dias')||inp('table')||inp('platform')||inp('stair') ) :
                output.innerHTML = "You place the battery on the dias, but nothing happens.";
                bellZoom();
                break;
            case roomNum === 18 &&   inp('rock')  && (  inp('dias')||inp('table')||inp('platform')||inp('stair') ) :
                output.innerHTML = "You place a rock on the dias, but nothing happens.";
                bellZoom();
                break;
            case roomNum === 18 &&  ( inp('take')||inp('pocket')||inp('get')||inp('grab')||inp('put'))  && (  inp('bell')||inp('gold') ) :
                output.innerHTML = "The bell is hung from a wood beam by a thick metal chain.";
                bellZoom();
                break;
                // ringing the bell
            case roomNum === 18 &&  bellRung === false && ( inp('ring')  ||   (inp('use')||inp('hit')||inp('strike')||inp('play')||inp('rock')||inp('hammer'))   &&  ( inp('bell')||inp('gold') )):
                output.innerHTML = "You strike the bell. It emits a clear tone.";
                bellRung = true;
                bellZoom();
                currentCutscene = "crystal break";
                playCutscene();
                break;
                // placing the crystal
            case roomNum === 18 && haveCrystal === true && (inp('crystal')||inp('gem'))  && (  inp('dias')||inp('table')||inp('platform')||inp('stair') ) :
                output.innerHTML = "You place the crystal on the dias...";
                bellZoom();
                haveCrystal = false;
                removeItem("a <span><button onclick='spanClick(\"inspect crystal\")'>strange crystal</button></span>");
                crystalPlaced = true;
                room18Switch();
                break;
                // ringing the bell



            // RELEASE FIREFLIES

            case roomNum === 2 && haveFireflies=== true && (inp('release')||inp('open'))   &&    (inp('box')||inp('chest')||inp('fireflies'))  :
                output.innerHTML = 'You release the fireflies into the air. They linger for a moment before rejoining their friends.';
                haveFireflies = false;
                removeItem("a <span><button onclick='spanClick(\"inspect box\")'>box of fireflies</button></span>");
                inventory.push("a <span><button onclick='spanClick(\"inspect box\")'>wooden box</button></span>");
                switchChestRopeImage();
                break;
            case roomNum !== 7 && haveFireflies=== true && (inp('release')||inp('open'))   &&    (inp('box')||inp('chest')||inp('fireflies'))  :
                output.innerHTML = 'You release the fireflies into the air. They linger for a moment, glimmering quietly, before floating up and away.<br><br>"Maybe they\'re going back to join their friends", you think.';
                haveFireflies = false;
                removeItem("a <span><button onclick='spanClick(\"inspect box\")'>box of fireflies</button></span>");
                inventory.push("a <span><button onclick='spanClick(\"inspect box\")'>wooden box</button></span>");
                switchChestRopeImage();
                break;
            case roomNum === 7 && haveFireflies=== true && ( (inp('release')||inp('open'))   &&    (inp('box')||inp('chest')) || inp('firefl') ) :
                firefliesReleased = true;
                haveFireflies = false;
                switchChestRopeImage();
                currentCutscene = "fireflies emerging";
                playCutscene();
                document.getElementById("room7").src="./roomimages/smfmroom7a.png";
                removeItem("a <span><button onclick='spanClick(\"inspect box\")'>box of fireflies</button></span>");
                inventory.push("a <span><button onclick='spanClick(\"inspect box\")'>wooden box</button></span>");
                room7Switch();
                thingsTriedSinceLastBigThing = 0;
                output.innerHTML = 'You open the box, and the fireflies fill the cave with a brilliant light!';
                break;

            // INTERACT WITH WATER
            case (roomNum === 4 || roomNum === 6 || roomNum === 3  ||  roomNum === 12  || roomNum === 15) &&    (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what'))   &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('pond')||inp('stream')||inp('ocean')||inp('bank')||inp('shore'))     :
                output.innerHTML = "The water is cool and clear, and a few fish drift lazily along. You search around the shore, but don't find anything particularly useful.";
                break;
            case roomNum === 16  &&    (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what'))   &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('pond')||inp('stream')||inp('ocean')||inp('bank')||inp('shore'))     :
                output.innerHTML = "The water here is murky. You search around the creek, but don't find anything particularly useful.";
                break;
            case (roomNum === 4 || roomNum === 6 || roomNum === 3  ||roomNum === 12  || roomNum === 15) &&    (inp('swim')||inp('dive')||inp('jump')||inp('cross')||inp('get'))   &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('pond')||inp('stream')||inp('ocean')||inp('bank')||inp('beach'))     :
                currentCutscene = "swimming";
                playCutscene();
                if (haveBoxKey === true) {
                    output.innerHTML = "You climb onto a nearby rock, and jump into the water.<br><br>The water is crip and refreshing.";
                } else {
                    output.innerHTML = "You climb onto a nearby rock, and jump into the water.<br><br>Your foot touches something strange! You reach down and bring up a <span><button onclick='spanClick(\"inspect key\")'>silver key.</button></span><br><br>You put the key in your <span><button onclick='spanClick(\"check pockets\")'>pocket.</button></span>";
                    haveBoxKey = true;
                    inventory.push("a <span><button onclick='spanClick(\"inspect key\")'>silver key</button></span>");
                };
                break;
            case roomNum === 16  &&    (inp('swim')||inp('dive')||inp('jump')||inp('cross')||inp('get'))   &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('pond')||inp('stream')||inp('ocean')||inp('bank')||inp('beach'))     :
                output.innerHTML = "The water is muddy, and doesn't seem good for swimming.";
                break;
            case (roomNum === 4 || roomNum === 6 || roomNum === 3  || roomNum === 12  || roomNum === 15 || roomNum === 16) &&    (inp('catch')||inp('grab')||inp('take')||inp('lure')||inp('get'))   &&    (inp('fish'))     :
                output.innerHTML = "You try to catch a fish, but they are way too fast! They probably prefer the water anyway.";
                break;
            case (roomNum === 4 || roomNum === 6 || roomNum === 12  || roomNum === 3  ||  roomNum === 15 || roomNum === 16) &&    (inp('skip')||inp('throw')||inp('toss'))   &&    (inp('rock')||inp('pebble')||inp('stone'))     :
                output.innerHTML = "You throw a rock out across the water. It skips across the surface a few times before sinking with a 'plop', and you watch the ripples play off each other on the glassy surface.";
                break;
            case (roomNum === 4 || roomNum === 6 || roomNum === 12 || roomNum === 8  ||  roomNum === 3  || roomNum === 15) &&    (inp('drink')||inp('sip'))   &&    (inp('water')||inp('lake')||inp('pond'))  && haveMug === true   :
                output.innerHTML = "You fill the mug with water from the lake and take a sip. It tastes clean and refreshing.";
                break;
            case (roomNum === 4 || roomNum === 6 || roomNum === 12 || roomNum === 8  || roomNum === 15 || roomNum === 3  ) &&    (inp('drink')||inp('sip'))   &&    (inp('water')||inp('lake')||inp('pond'))  :
                output.innerHTML = "You cup your hands into the lake and take a sip. The water is clean and refreshing.";
                break;
            case roomNum === 16 &&    (inp('drink')||inp('sip'))   :
                output.innerHTML = "The water here is murky and gross. Drinking it seems like a bad idea.";
                break;
            case roomNum === 15 &&    inp('swim')  :
                output.innerHTML = "The current is too strong.";
                break;
            case ((roomNum === 6 || roomNum === 12) || (roomNum === 5 && haveBoxKey === true))&&    (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('grab')||inp('take')||inp('pocket')||inp('get')||inp('under')||inp('behind')||inp('what'))   &&    (inp('drift')||inp('wood')):
                output.innerHTML = "You search around the driftwood on the shore but don't find anything particularly useful.";
                break;
            case (roomNum === 4 || roomNum === 6 || roomNum === 12 || roomNum === 8 || roomNum === 3  ) &&    inp('swim')  :
                currentCutscene = "swimming";
                playCutscene();
                if (haveBoxKey === true) {
                    output.innerHTML = "You climb onto a nearby rock, and jump into the water.<br><br>The water is crisp and refreshing.";
                } else {
                    output.innerHTML = "You climb onto a nearby rock, and jump into the water.<br><br>Your foot touches something strange! You reach down and bring up a <span><button onclick='spanClick(\"inspect key\")'>silver key.</button></span><br><br>You put the key in your <span><button onclick='spanClick(\"check pockets\")'>pocket.</button></span>";
                    haveBoxKey = true;
                    inventory.push("a <span><button onclick='spanClick(\"inspect key\")'>silver key</button></span>");
                };
                break;
            
            // INTERACT WITH TREES
                // default for tree-less rooms
            case ((roomNum === 7 || roomNum === 8 || roomNum === 13 || roomNum === 18))  &&    (inp('tree')||inp('branch'))     :
                output.innerHTML = "There aren't any trees around here.";
                break;
            case (roomNum === 17)  &&    (inp('tree')||inp('branch'))     :
                output.innerHTML = "There aren't any trees within reach.";
                break;
                // take
            case (inp('take')||inp('grab')||inp('pocket'))  && inp('tree')   :
                output.innerHTML = "Your pockets aren't that big! They're just regular sized.";
                break;
                // climb
            case roomNum === 15  && inp('tree') && inp('climb') :
                output.innerHTML = "Palm trees are, like, really hard to climb, you know?";
                break;
            case (inp('climb')|| (inp('rope')&&haveRope===true) )  &&    (inp('tree')||inp('branch'))  &&  ( roomNum === 16 )  :
                output.innerHTML = "There aren't any trees large enough to climb nearby.";
                break;
            case (inp('climb')|| (inp('rope')&&haveRope===true) )  &&    (inp('tree')||inp('branch'))  &&  ( roomNum === 5 || roomNum === 6 || roomNum === 12 )  :
                output.innerHTML = "You carefully climb up the nearest tree. The branches are thin near the top, so you find a sturdy perch to look out over the forest.<br><br>Trees stretch as far as the eye can see.<br><br>You enjoy the view for a minute, then climb down." + getPoints(10, treeClimbed);
                currentCutscene = "tree climb";
                playCutscene();
                treeClimbed = true;
                break;
            case (inp('climb')|| (inp('rope')&&haveRope===true) )  &&    (inp('tree')||inp('branch'))  &&  ( roomNum === 5 || roomNum === 6 || roomNum === 12 )  :
                output.innerHTML = "You carefully climb up the nearest tree. The branches are thin near the top, so you find a sturdy perch to look out over the forest.<br><br>Trees stretch as far as the eye can see.<br><br>You enjoy the view for a minute, then climb down." + getPoints(10, treeClimbed);
                currentCutscene = "tree climb";
                playCutscene();
                treeClimbed = true;
                break;
            case (inp('climb')|| (inp('rope')&&haveRope===true) )  &&    (inp('tree')||inp('branch')) && roomNum !== 9    :
                output.innerHTML = "You carefully climb up the nearest tree. The branches are thin near the top, so you find a sturdy perch to look out over the forest.<br><br>There is a lake to the <span><button onclick='spanClick(\"go south\")'>south</button></span>, but besides that the trees stretch as far as the eye can see.<br><br>You enjoy the view for a minute, then climb down." + getPoints(10, treeClimbed);
                currentCutscene = "tree climb";
                playCutscene();
                treeClimbed = true;
                break;
            case (inp('climb')|| (inp('rope')&&haveRope===true) )  &&    (inp('tree')||inp('branch')) && roomNum === 9    :
                output.innerHTML = "The trees here look too old and brittle to climb.";
                break;
                // look
            case (roomNum === 9)  &&    (inp('tree')||inp('branch'))   &&   (inp('look'))  :
                output.innerHTML = "The trees here look ancient. You get the feeling this is a very old part of the forest.";
                break;
            case (roomNum === 15)  && inp('tree') :
                output.innerHTML = "That's a big ol' palm tree! Nothing much to do with it, though.";
                break;
                // search
            case ((roomNum !== 4) || marbleDown === true) &&   (inp('inspect')||inp('examine')||inp('see ')||inp('search')||inp('check')||inp('behind')||inp('under')||inp('what'))   &&    (inp('tree')||inp('branch'))     :
                output.innerHTML = "You search around the trees, but don't find anything.";
                break;
            case ((roomNum !== 4) || marbleDown === true) &&   (inp('look')||inp('tell me about'))   &&    (inp('tree')||inp('branch'))     :
                output.innerHTML = "There's a lot of different kinds of trees around. You search around the trees, but don't find anything particularly useful.";
                break;
            case (inp('hug')||inp('love'))  && inp('tree')  :
                output.innerHTML = "Ok ya hippy :P" + getPoints(2, treeHugged);
                treeHugged = true;
                break;
            case inp('tree')  :
                output.innerHTML = "There are a lot of different kinds of trees around you - oaks, sycamore, pines trees, cyrpress, even some eucalyptus. Their leaves cover the ground.<br><br>You search around the trees for a bit, but don't find anything.";
                break;
            case (inp('shake') ||inp('push') ||inp('jostle')) && inp('tree')  && roomNum !== 4 :
                catDiscovered = true;
                output.innerHTML = "You give a few trees a good shake, but nothing happens.";
                break;
                // cut
            case inp('tree')  && (inp('cut')||inp('chop')) :
                output.innerHTML = "You don't have any tools to cut the trees down.";
                break;

            // GET FLOWER
            case  haveFlower === true && (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what'))   &&    (inp('flower'))  && !(inp('flowers'))   :
                output.innerHTML = "It's a rather pretty blue flower :)";
                break;
            case (roomNum === 1 || roomNum === 3 || roomNum === 5 || roomNum === 14 || roomNum === 12  || roomNum === 15 || roomNum === 18)   &&    (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('search')||inp('check')||inp('what'))   &&    (inp('flower'))     :
                output.innerHTML = "You look at the flowers. Nice :)";
                break;
            case (roomNum === 1 || roomNum === 3 || roomNum === 5 || roomNum === 4 || roomNum === 14 || roomNum === 12  || roomNum === 15 || roomNum === 18)   &&    (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab')||inp('put'))   &&    (inp('flower'))  && haveFlower === false   :
                output.innerHTML = "You pick one of the blue flowers and carefully put it in your <span><button onclick='spanClick(\"check pockets\")'>pocket.</button></span>";
                haveFlower = true;
                findObject("flower");
                inventory.push("a <span><button onclick='spanClick(\"inspect flower\")'>blue flower</button></span>");
                break;
            case (roomNum === 1 || roomNum === 3 || roomNum === 5 || roomNum === 14 || roomNum === 12  || roomNum === 15 || roomNum === 18)   &&    (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab')||inp('put'))   &&    (inp('flower'))  && haveFlower === true   :
                output.innerHTML = "You already have a flower in your <span><button onclick='spanClick(\"check pockets\")'>pocket.</button></span>";
                break;
            case (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get'))   &&    (inp('flower')) :
                output.innerHTML = "There aren't any flowers around here.";
                break;
            case inp('smell') &&    (inp('flower')) &&  (roomNum === 1 || roomNum === 3 || roomNum === 5 || roomNum === 14 || roomNum === 12  || roomNum === 15 || roomNum === 18)   :
                output.innerHTML = "Lovely :)" + getPoints(1, flowerSmelled);
                flowerSmelled = true;
                break;
            case  haveFlower === true &&    inp('flower') && (inp('drop')||inp('leave')||inp('throw')||inp('toss'))  :
                removeItem("a <span><button onclick='spanClick(\"inspect flower\")'>blue flower</button></span>");
                haveFlower = false;
                output.innerHTML = "You drop your flower.";
                break;
            case ((roomNum === 1 || roomNum === 3 || roomNum === 5 || roomNum === 14 || roomNum === 12)  || roomNum === 15 || roomNum === 18 ||  haveFlower === true) &&    inp('flower')  :
                output.innerHTML = "Lovely :)";
                break;
            case ((roomNum === 1 || roomNum === 3 || roomNum === 5 || roomNum === 14 || roomNum === 12)  || roomNum === 15 || roomNum === 18 ||  haveFlower === true) && inp('blue') && inp('thing') && inp('what') :
                output.innerHTML = "They're <span><button onclick='spanClick(\"take flower\")'>flowers!</button></span> Great graphics, right? :)"
                break;

            // INTERACT WITH ROCKS
            case haveRock === false &&  roomNum !== 17 && (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab')||inp('put'))   &&    (inp('rock')||inp('stone')||inp('pebble'))    :
                output.innerHTML = "There's an art to rock collecting. You find a nice one and put it in your <span><button onclick='spanClick(\"check pocket\")'>pocket.</button></span>";
                inventory.push("a <span><button onclick='spanClick(\"inspect rock\")'>rock</button></span>")
                haveRock = true;
                findObject("rock");
                break;
            case (inp('under')||inp('search')||inp('check'))   &&    (inp('rock')||inp('stone')||inp('pebble')) &&  roomNum !== 17  :
                output.innerHTML = "You search under some of the rocks, but don't find anything other than some very confused bugs.";
                break;
            case haveRock === true && (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look'))   &&    (inp('rock')||inp('stone')||inp('pebble'))  && !inp('rocks')  :
                output.innerHTML = "The rock is round and about the size of your fist. It's a nice rock.";
                break;
            case (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('check')||inp('under')||inp('behind'))   &&    (inp('rock')||inp('stone')||inp('pebble'))   &&  roomNum !== 17   :
                output.innerHTML = "You look at the rocks. They look rocky.";
                break;
            case inp('eat')  &&    (inp('rock')||inp('stone')||inp('pebble'))    :
                output.innerHTML = "...";
                break;
            case (inp('rock')||inp('stone')||inp('pebble')) && inp('throw') && haveRock === true   :
                output.innerHTML = "You wind up and throw your rock as far as you can.";
                removeItem("a <span><button onclick='spanClick(\"inspect rock\")'>rock</button></span>");
                haveRock = false;
                break;
            case (inp('rock')||inp('stone')||inp('pebble')) && (inp('drop') ||inp('leave'))&& haveRock === true   :
                output.innerHTML = "You drop your rock.";
                removeItem("a <span><button onclick='spanClick(\"inspect rock\")'>rock</button></span>");
                haveRock = false;
                break;
            case (inp('rock')||inp('stone')||inp('pebble')) && inp('throw') && haveRock === false  &&  roomNum !== 17   :
                output.innerHTML = "You wind up and throw your rock as far as you can.";
                break;
            case (inp('rock')||inp('stone')||inp('pebble')) && haveRock === false && roomNum === 17 :
                output.innerHTML = "There aren't any rocks within reach.";
                break;

            // INTERACT WITH GRASS
            case (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get'))   &&    inp('grass')    :
                output.innerHTML = "You don't need that.";
                break;
            case roomNum === 17  &&   (inp('search')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('check')||inp('what'))   &&    inp('grass')    :
                output.innerHTML = "There isn't any grass within reach.";
                break;
            case  (inp('search')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('check')||inp('what'))   &&    inp('grass')    :
                output.innerHTML = "You search the grass, but don't find anything.";
                break;
            case inp('touch')  &&    inp('grass')    :
                output.innerHTML = "You touch the grass. Feels good, not gonna lie.";
                break;
            case (inp('lie')||inp('lay'))  &&    inp('grass')    :
                output.innerHTML = "You lie down on the grass and watch the clouds float gently above you. It's comfy, but after a while starts to get a bit itchy. Makes you wish you'd brought a blanket.";
                break;
            case inp('smoke')  &&    inp('grass')    :
                output.innerHTML = "-_-";
                break;
            case inp('eat')  &&    inp('grass')    :
                output.innerHTML = "...why??";
                break;
            
            // MUSHROOMS
            case roomNum !== 9 && haveMushy === false && inp('mushroom')  :
                output.innerHTML = "There aren't any mushrooms around.";
                break;
            case  (haveMushy === true || roomNum === 9) && inp('mush') && (inp('eat')||inp('consume')||inp('swallow') ) && mushyValue < 1 :
                output.innerHTML = "You eat one of the mushrooms...<br><br>Yuck! I probably shouldn't do that again.";
                haveMushy = false;
                removeItem("a <span><button onclick='spanClick(\"inspect mushroom\")'>wild mushroom</button></span>");
                takeMushy();
                break;
            case  (haveMushy === true || roomNum === 9) && inp('mush') && (inp('eat')||inp('consume')||inp('swallow') ) && mushyValue > 10 :
                output.innerHTML = "You eat ANOTHER mushroom...<br><br>...Is this a good idea?";
                haveMushy = false;
                removeItem("a <span><button onclick='spanClick(\"inspect mushroom\")'>wild mushroom</button></span>");
                takeMushy();
                break;
            case  (haveMushy === true || roomNum === 9) && inp('mush') && (inp('eat')||inp('consume')||inp('swallow') ) :
                output.innerHTML = "You eat another mushroom...<br><br>Gross!";
                haveMushy = false;
                removeItem("a <span><button onclick='spanClick(\"inspect mushroom\")'>wild mushroom</button></span>");
                takeMushy();
                break;
            case roomNum === 9 &&  inp('mushroom') :
                output.innerHTML = "The mushrooms look rather enticing.";
                ghostZoom();
                break;

            // STICKS
            case roomNum !== 7 && roomNum !== 8 && roomNum !== 13 && roomNum !== 17 && roomNum !== 18 && haveStick === false && (inp('stick')||inp('branch'))  && (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')) :
                output.innerHTML = "You find a nice stick and put it in your <span><button onclick='spanClick(\"check pockets\")'>pocket.</button></span>";
                inventory.push("a <span><button onclick='spanClick(\"inspect stick\")'>stick</button></span>");
                haveStick = true;
                findObject("stick");
                if (millSwitchOn === false) {room16.src="./roomimages/smfmroom16b.png"}
                break;
            case (roomNum === 5||roomNum === 6||roomNum === 12||roomNum === 16||roomNum === 17) && haveStick === true && (inp('throw')||inp('toss')||inp('chuck')) && inp('stick') :
                output.innerHTML = "You throw your stick out into the water and watch it float away.";
                removeItem("a <span><button onclick='spanClick(\"inspect stick\")'>stick</button></span>");
                haveStick = false;
                break;
            case (roomNum === 5||roomNum === 6||roomNum === 12||roomNum === 16||roomNum === 17) && (inp('throw')||inp('toss')||inp('chuck')) && inp('stick') :
                output.innerHTML = "You throw a stick out into the water and watch it float away.";
                break;
            case haveStick === true && (inp('look')||inp('inspect')||inp('check')||inp('examine')||inp('tell me about')) && inp('stick') :
                output.innerHTML = "It's a pretty normal looking stick.";
                break;
            case haveStick === true && (inp('throw')||inp('toss')||inp('chuck')) && inp('stick') :
                output.innerHTML = "You throw your stick into the forest, startling some birds.";
                removeItem("a <span><button onclick='spanClick(\"inspect stick\")'>stick</button></span>");
                haveStick = false;
                break;
            case haveStick === true && inp('drop') && inp('stick') :
                output.innerHTML = "You drop your stick.";
                removeItem("a <span><button onclick='spanClick(\"inspect stick\")'>stick</button></span>");
                haveStick = false;
                break;
            case roomNum !== 7 && roomNum !== 8 && roomNum !== 13 && haveStick === true && (inp('stick')||inp('branch'))&& (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')) :
                output.innerHTML = "You already have a stick in your <span><button onclick='spanClick(\"check pockets\")'>pocket.</button></span>";
                break;
            
            // BUSHES
            case roomNum !== 7 && roomNum !== 8 && roomNum !== 13 && roomNum !== 17 && roomNum !== 18 && inp('bush') && (inp('search')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('check')||inp('what')) :
                output.innerHTML = "You search the bushes, but don't find anything.";
                break;
            case  inp('bush') && (inp('search')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('check')||inp('behind')||inp('under')||inp('what')) :
                output.innerHTML = "There aren't any bushes around here.";
                break;
            case  inp('aim') && inp("for") && inp('bush') :
                output.innerHTML = "You thinkin what I'm thinkin?";
                break;

            // LEAVES
            case (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get'))   &&   (inp('leaves')||inp('leaf'))    :
                output.innerHTML = "There are plenty of leaves around, and your pockets are only so big. You won't need to take any along with you.";
                break;
            case  (inp('leaves')||inp('leaf')) && (inp('search')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('check')||inp('what')) :
                output.innerHTML = "You search the leaves, but don't find anything (other than some nice leaves.)";
                break;
            case  inp('touch') && (inp('leaves')||inp('leaf'))  :
                output.innerHTML = "You touch the leaves. They feel leafy.<br><br>Better leaf them alone.";
                break;

            // UNLOCK / INTERACT WITH THE BOX IN INVENTORY
            case (inp('unlock')||inp('open')||inp('key'))   &&    (inp('box')||inp('chest'))  && haveBox === true && haveBoxKey === true && boxUnlocked === false   :
                boxUnlocked = true;
                haveRibbon = true;
                haveBattery = true;
                thingsTriedSinceLastBigThing = 0;
                inventory.push("a <span><button onclick='spanClick(\"inspect battery\")'>battery</button></span>");
                inventory.push("a <span><button onclick='spanClick(\"inspect ribbon\")'>red ribbon</button></span>");
                switchChestRopeImage();
                displayInventory();
                output.innerHTML = "You use the silver key, and the box opens with a satisfying click.<br><br>Inside the box you find a <span><button onclick='spanClick(\"inspect ribbon\")'>red ribbon</button></span> and a <span><button onclick='spanClick(\"inspect battery\")'>battery</button></span>. You put them in your pocket.";
                break;
            case (inp('unlock')||inp('open')||inp('key'))   &&  !(inp('hit')||inp('break')||inp('smash')||inp('rock')||inp('force')||inp('bust')||inp('bash'))  && (inp('box')||inp('chest'))  && haveBox === true && haveBoxKey === false  :
                if (checkInventory === true) {displayInventory};
                output.innerHTML = "The box is securely locked, and you don't have a key." ;
                break;
            case (inp('shake')||inp('rattle'))   &&    (inp('box')||inp('chest'))  && haveBox === true && boxUnlocked === false  :
                if (checkInventory === true) {displayInventory};
                output.innerHTML = "You shake the box box. There's definitely something inside." ;
                break;
            case (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('check')||inp('search')||inp('what'))   &&    (inp('box')||inp('chest'))  && haveBox === true && haveFireflies === false  :
                output.innerHTML = "The box is made of hard wood and reinforced with metal banding and a silver lock." ;
                displayInventory();
                break;
            case (inp('look')||inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('check')||inp('search')||inp('what'))   &&    (inp('box')||inp('chest'))  && haveBox === true && haveFireflies === true  :
                output.innerHTML = "You can see the  fireflies glow through the crack in the lid." ;
                displayInventory();
                break;
            case (inp('hit')||inp('break')||inp('smash')||inp('rock')||inp('force')||inp('bust')||inp('bash'))   &&    (inp('box')||inp('chest'))  && (haveBox === true ||roomNum === 5) && boxSmashed === 0 && boxUnlocked === false    :
                output.innerHTML = "You hit the box with a rock and dent it up pretty bad, but it remains locked tight." ;
                boxSmashed++;
                if (checkingInventory === true) {
                    displayInventory();
                };
                break;
            case (inp('hit')||inp('break')||inp('smash')||inp('rock')||inp('force')||inp('bust')||inp('bash'))   &&    (inp('box')||inp('chest'))  && (haveBox === true ||roomNum === 5)  && boxSmashed === 1 && boxUnlocked === false  :
                output.innerHTML = "Hey, it's a nice box! Don't smash it. You gotta find the right way to open it up." ;
                boxSmashed++;
                if (checkingInventory === true) {
                    displayInventory();
                };
                break;
            case (inp('hit')||inp('break')||inp('smash')||inp('rock')||inp('force')||inp('bust')||inp('bash'))   &&    (inp('box')||inp('chest'))  && (haveBox === true ||roomNum === 5)  && boxSmashed === 2 && boxUnlocked === false :
                output.innerHTML = "Didn't I already tell you that wasn't going to work? The key is so close! This is just rude." ;
                boxSmashed++;
                if (checkingInventory === true) {
                    displayInventory();
                };
                break;
            case (inp('hit')||inp('break')||inp('smash')||inp('rock')||inp('force')||inp('bust')||inp('bash'))   &&    (inp('box')||inp('chest'))  && (haveBox === true ||roomNum === 5)  && boxSmashed === 3 :
                haveBox = true;
                room5Switch();
                boxUnlocked = true;
                thingsTriedSinceLastBigThing = 0;
                haveRibbon = true;
                haveBattery = true;
                boxSmashed = 4;
                removeItem("a <span>wooden box</span");
                inventory.push("a <span><button onclick='spanClick(\"inspect battery\")'>battery</button></span>");
                inventory.push("a <span><button onclick='spanClick(\"inspect box\")'>smashed-up box</button></span>");
                inventory.push("a <span><button onclick='spanClick(\"inspect ribbon\")'>red ribbon</button></span>");
                switchChestRopeImage();
                displayInventory();
                output.innerHTML = "Okay fine!!! You smash the box and diamonds and jewels pour out! Are you happy now??<br><br>Just kidding. There's a red ribbon inside and a battery inside. Good luck smashing those around you jerk." ;
                break;
            case inp('smash') && inp('ribbon') && haveRibbon === true:
                output.innerHTML = "Nothing happened.<br><br>Jerk."
                break;
            case inp('box') && haveBox === true && boxUnlocked === false:
                output.innerHTML = "It's not a large box... but it sounds like there might be something inside."
                break;
            case inp('box') && boxUnlocked === true && (inp('water')||inp('lake')||inp('pond')||inp('ocean')) && (roomNum === 12 || roomNum === 8 || roomNum === 5 || roomNum === 6) :
                output.innerHTML = "You start to dip the box into the water, and quickly realize it's not water-tight."
                break;
            case inp('box') && boxUnlocked === true && (inp('leaves')||inp('leaf')||inp('stick')) :
                output.innerHTML = "You put some leaves in the bottom of the box. It looks like some little bugs could live there happily now :)" + getPoints(3, decorateBox1);
                decorateBox1 = true;
                break;
            case inp('box') && boxUnlocked === true && (inp('dirt')||inp('grass')) :
                output.innerHTML = "You put some dirt and grass in the bottom of the box. Now it's the perfect home for some bugs :)" + getPoints(3, decorateBox2);
                decorateBox2 = true;
                break;
            case inp('box') && boxUnlocked === true && (inp('rock')||inp('stone')||inp('pebble')) :
                output.innerHTML = "You carefully put a small rock in the box. The box is the perfect size for a lil bugs home."
                break;
            case inp('box') && boxUnlocked === true && inp('flower') && (haveFlower === true || (roomNum === 1 || roomNum === 3 || roomNum === 5  || roomNum === 14 || roomNum === 12) ):
                output.innerHTML = "You put a flower in the box.<br><br>Any little creatures living in this box would be happy for the decoration :)" + getPoints(3, decorateBox3);
                decorateBox3 = true;
                break;
            case inp('box') && boxUnlocked === true:
                output.innerHTML = "I bet you could put all kinds of things in this box.<br><br>There was a ribbon in it when you found it."
                break;

            // INTERACT WITH OTHER ITEMS IN INVENTORY
                // key
            case (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('check')||inp('what')||inp('what'))   &&    inp('key')  && haveBoxKey === true && haveBox === false :
                output.innerHTML = "The key is shiny silver and about the size of your pinky finger.";
                displayInventory();
                break;
            case (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('check')||inp('what')||inp('what'))   &&    inp('key')  && haveBoxKey === true  :
                output.innerHTML = "The key is shiny silver and about the size of your pinky finger.";
                displayInventory();
                break;
            case inp('key') && haveBoxKey === false && haveBox === true :
                output.innerHTML = "You found the box in the boat, so maybe the key is washed up on the shore somewhere nearby.";
                break;
            case inp('key') && haveBoxKey === false  :
                output.innerHTML = "You look around for the key, but you don't find anything.";
                break;
            case inp('key') && haveBox === false  :
                output.innerHTML = "I wonder what this key is for?";
                break;
            case inp('key') &&  boxUnlocked === true :
                output.innerHTML = "There must be a way to open the door...";
                break;
                // ribbon
            case (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('check')||inp('what')||inp('what'))   &&    inp('ribbon')  && haveRibbon === true  :
                output.innerHTML = "The ribbon is made of vibrant red silk and about two feet long. It may have been a hair tie at one point.";
                displayInventory();
                break;
            case inp('hair')  &&  inp('ribbon')  && haveRibbon === true  :
                output.innerHTML = "You tie the ribbon in you hair. Nice :)" + getPoints(20, putRibbonInHair);
                putRibbonInHair = true;
                break;
            case inp('ribbon') && ( inp('use') || inp('tie') )&& haveRibbon === true  :
                output.innerHTML = "You can't use the ribbon for that, sorry.";
                break;
            case inp('ribbon') &&  inp('wave') && haveRibbon === true  :
                output.innerHTML = "You wave the ribbon around a bit. I bet it would make a great cat toy!";
                break;
            case inp('ribbon') :
                output.innerHTML = "";
                break;
            case roomNum === 12 && marbleReunited === false && robotAwake && inp('ribbon')    :
                output.innerHTML = "You show the ribbon to the robot.<br><br><span class='robot'>\"What a beatiful thing! I have a friend who would love a ribbon like that,\"</span>, the <spam>robot</span> says.";
                break;
                // mug
            case (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('check')||inp('what'))   &&    (inp('mug')||inp('cup'))  && haveMug === true  :
                output.innerHTML = "The mug is dark blue and decorated with a picture of a cactus and crescent moon. Something about it reminds you of home.";
                displayInventory();
                break;
            case inp('cactus')  :
                output.innerHTML = "There aren't any cactuses around.";
                break;
                // rope
            // case (inp('where')  || inp('how') || inp('what') ) && inp('rope')   :
            //     output.innerHTML = "The rope could be helpful reaching a new place.";
            //     break;
            case inp('swing') && haveRope === true &&  roomNum !== 7 && roomNum !== 8 && roomNum !== 13 && roomNum !== 18 && roomNum !== 17 :   // XXX I could animate this
                output.innerHTML = "You toss the rope over the nearest branch, tie it up, and let-er-rip. Best thing ever :)" + getPoints(20, ropeSwing);
                ropeSwing = true;
                break;
                // battery
            case (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('check')||inp('what'))   &&    (inp('battery'))  && haveBattery === true  :
                output.innerHTML = "The battery is pretty hefty and a bit rusted. I wonder if it still works?";
                break;


                // crystal
            case (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('check')||inp('what'))   &&    (inp('crystal')||inp('gem'))  && haveCrystal === true  :
                output.innerHTML = "The piece of crystal is about the size of your hand and soft pink in color. It feels oddly warm, and catches the light in an unusual way.";
                // if (checkingInventory === true) {
                    displayInventory();
                // }
                break;
            case (inp('rub')||inp('touch')||inp('what')) && (inp('crystal')||inp('gem')) && (haveCrystal=== true || (roomNum === 7 || roomNum === 8))  :
                output.innerHTML = "The surface of the crystal is oddly warm. Your finger tips tingle when you touch it.";
                break;
            case (inp('eat') && (inp('crystal')||inp('gem')||inp('what'))) && (haveCrystal=== true || (roomNum === 7 || roomNum === 8))  :
                output.innerHTML = "The crystals don't look good for eating. That would be wild if you could just eat rocks tho.";
                break;
                // throwing things
            case (inp('toss')||inp('throw')||inp('drop')||inp('what'))   &&  (   ((inp('mug') && haveMug === true ))   ||   ((inp('crystal') && haveCrystal === true ))   ||  ( (inp('mushroom') && haveMushy === true))   ||   (inp('ribbon')  && haveRibbon === true)     ||   ( inp('key') && haveBoxKey === true)     )  :
                output.innerHTML = "I should probably keep this with me.";
                break; 

            // EXTRA INPUT IF JUST "POCKETS"
            case inp('pocket') :
                userInput.value = "";
                output.innerHTML = checkInventory();
                displayInventory();
                break;
            
            // CANDLE / FLASHLIGHT
            case inp('candle') :
                output.innerHTML = "There isn't a candle around.";
                break;
            case inp('flash') && inp('light') :
                output.innerHTML = "You don't have a flashlight.";
                break;
            case roomNum === 7 && firefliesReleased === false && inp('light')   :
                output.innerHTML = "You search for a source of light, but don't find anything.";
                break;
            case inp('matches') || (inp('light') && inp('match') ):
                output.innerHTML = "You don't have a any matches.";
                break;
            case inp('torch') :
                output.innerHTML = "There aren't any torches around.";
                break;
            case inp('light') && inp('switch') :
                output.innerHTML = "If only it were that easy.";
                break;
            
            // DIG / DIRT / GROUND
            case inp('dig') && (inp('gold')||inp('treause')):
                output.innerHTML = "No treasure here!";
                break;
            case inp('dig') && inp('mushroom') && roomNum !== 9 :
                output.innerHTML = "Not really the season for that.";
                break;
            case inp('dig') && inp('stump')  && roomNum === 3 :
                output.innerHTML = "You dig around the edges of the stump, disturbing some of the local bug residents. You don't find anything.";
                break;
            case inp('dig'):
                output.innerHTML = "You don't have anything to dig with, and you're not really sure what you'd be looking for anyway.";
                break;
            case  inp('touch') && (inp('dirt') || inp('ground'))  :
                output.innerHTML = "Yaaay dirt.";
                break;
            case( inp('mow')||inp('cut')) && (inp('lawn')||inp('grass')) :
                output.innerHTML = "That's not on your list of chores today.";
                break;

            // TRAVEL TO LAKE
            case roomNum === 10  && (inp('travel')||inp('go')||inp('walk')||inp('find')||inp('look for')||inp('visit'))   &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('pond')||inp('stream')||inp('ocean')||inp('bank')||inp('beach')) && !inp('well') :
                room6Switch();
                goSouthAnimation();
                break;

            // DEFAULT "GO" xxxxxxxxxxxxxxxxx
            // case (inp("walk")||inp('go')||inp('travel')) && (inp('forest')||inp('back')) && (roomNum === 8 || roomNum === 7):
            //     room11Switch();
            //     break;
            // case (inp("walk")||inp('go')||inp('travel')) && (inp('forest')||inp('back')||inp('firefl')) && (roomNum === 9):
            //     room2Switch();
            //     break;
            // case (inp("walk")||inp('go')||inp('travel')) && inp('firefl') && roomVisited[2] === true:
            //     room2Switch();
            //     break;
            // case (inp("walk")||inp('go')||inp('travel')) && (inp('forest')||inp('back')) && roomNum === 12 :
            //     room10Switch();
            //     break;
            // case (inp("walk")||inp('go')||inp('travel')) && (inp('forest')||inp('back')) && roomNum === 5 :
            //     room1Switch();
            //     break;
            // case (inp("walk")||inp('go')||inp('travel')) && (inp('forest')||inp('back')) && roomNum === 6 :
            //     room3Switch();
            //     break;
            // case (inp("walk")||inp('go')||inp('travel')) && (inp('forest')||inp('back')||inp(' up')) && roomNum === 13 :
            //     climbUpAnimation();
            //     room10Switch();
            //     break;

            // ABOUT THE GAME
            case inp('game')  :
                output.innerHTML = "This game was made by nok nok in HTML and Javascript. The 3D images are also mostly made by nok nok in Blender, except for a few models by Liam Xee and Pastean Narcis Dan. The 8-bit style cutscene images are a combination of Night Cafe AI and Photoshop.<br><br>Thanks for playing!";
                break;
                
            // DEFAULT "NEGATIVITY"
            case (inp('bad')||inp('terrible')||inp('sad')||inp('lonely')||inp('unhappy')||inp('not good')||inp('depress'))   :
                output.innerHTML = "I'm just a pre-programmed game, so I can't say much. But you're doing great, and I hope you find a bit of brightness today <3";
                break;
            case (inp('stupid')||inp('dumb')||inp('lame')||inp('sucks')||inp('blows'))   :
                output.innerHTML = ":(";
                break;

            // DEFAULT "POSITIVITY"
            case (inp('love')||inp('great')||inp('good')||inp('happy')||inp('fine')||inp('okay')||inp('not bad')||inp(':)'))   :
                output.innerHTML = ":)";
                break;

            // RANDOM DEFAULTS
            // case inp('eat' ) :
            //     output.innerHTML = "Yeah, you probably don't want to eat that.";
            //     break;
            // case inp('jump')  :
            //     output.innerHTML = "Jumping around is not really going to help you here. Fun though!";
            //     break;
            case inp('dance')  :
                output.innerHTML = "Shake it, babayyy.";
                break;
            case inp('groove') || inp('boogy') :
                output.innerHTML = "Uhh! That's what I like to see.";
                break;
            case inp('magic') || inp('spell') :
                output.innerHTML = "Abracadabra! Kallamazoo! How Now Brown Cow!<br><br>...nothing happened.";
                break;

            // OBJECT DEFAULTS
            // case inp('grass')    :
            //     output.innerHTML = "What about the grass?";
            //     break;
            // case  inp('ground') || (inp('dirt'))  :
            //     output.innerHTML = "Look, everyone loves some good dirt. But we got things to do here, people.";
            //     break;
            // case  (inp('leaves')||inp('leaf'))  :
            //     output.innerHTML = "The ground is covered in a variety of leaves from all the different kinds of trees.";
            //     break;
            // case (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab')||inp('put'))   &&    (inp('rock')||inp('stone')||inp('pebble'))  && haveRock=== true  :
            //     output.innerHTML = "You already have a rock in your <span><button onclick='spanClick(\"check pockets\")'>pocket.</button></span>";
            //     break;
            case (inp('rock') && (inp('climb')||inp('cave')))    :
                output.innerHTML = "Looks much too steep!";
                break;


            // DEFAULT "LOOK"
            // case (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('check')||inp('search')||inp('find')) && inp('for')  :
            //     output.innerHTML = "Where do you want to look?";
            //     break;
            // case (inp('inspect')||inp('examine')||inp('tell me about')||inp('see ')||inp('look')||inp('check')||inp('search')||inp('find'))   :
            //     output.innerHTML = "What do you want to look at?";
            //     break;

            // DEFAULT "SOMETHING"
            // case (inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab')||inp('put')) && (inp('thing')||inp('object')||inp('item')||inp('stuff') ) :
            //     output.innerHTML = "What do you want to take?";
            //     break;
            case inp('something')   :
                output.innerHTML = "Try typing different commands to interact with things in the forest.<br><br>You can also move around the forest by tpying commands or clicking in the corners of the screen above.";
                break;

            // WHERE DO I GO  xxxxxxxxxx
            // case  inp('where') && (inp('go')) :
            //     switch (true) {
            //         case roomNum === 1 :
            //             output.innerHTML = "You are surrounded by forest to the <span><button onclick='spanClick(\"go north\")'>north</button></span>, <span><button onclick='spanClick(\"go west\")'>west</button></span>, and <span><button onclick='spanClick(\"east\")'>east.</button></span> You can hear the sound of running water to the <span><button onclick='spanClick(\"go south\")'>south.</button></span>";
            //             break;
            //         case roomNum === 2 :
            //             output.innerHTML = "A stale wind blows from the <span><button onclick='spanClick(\"go east\")'>east.</button></span> The forest feels a bit more lush and bright to the <span><button onclick='spanClick(\"go south\")'>south</button></span> and <span><button onclick='spanClick(\"go west\")'>west.</button></span>";
            //             break;
            //         case roomNum === 3 :
            //             output.innerHTML = "You can see the shore of a lake to the <span><button onclick='spanClick(\"go south\")'>south.</button></span> The forest opens up to a clearing to the <span><button onclick='spanClick(\"go west\")'>west.</button></span><br><br>To the <span><button onclick='spanClick(\"go north\")'>north</button></span> the woods grow darker.";
            //             break;
            //         case roomNum === 4 :
            //             output.innerHTML = "You can see a rocky outcropping above the trees to the <span><button onclick='spanClick(\"go west\")'>west.</button></span> The forest opens to the clearing to the <span><button onclick='spanClick(\"go south\")'>south.</button></span><br><br>To the <span><button onclick='spanClick(\"go east\")'>east</button></span> the woods grow darker.";
            //             break;
            //         case roomNum === 5 :
            //             output.innerHTML = "The lakeshore stretches to the <span><button onclick='spanClick(\"go east\")'>east</button></span> and <span><button onclick='spanClick(\"go west\")'>west.</button></span> To the <span><button onclick='spanClick(\"go north\")'>north</button></span> there is a clearing im the forest.";
            //             break;    
            //         case roomNum === 6 :
            //             output.innerHTML = "The woods to the <span><button onclick='spanClick(\"go north\")'>north</button></span> seem a bit foreboding. The lakeshore stretches to the <span><button onclick='spanClick(\"go west\")'>west.</button></span>";
            //             break;
            //         case roomNum === 7 && firefliesReleased === false:
            //             output.innerHTML = "The only way out of the cave is <span><button onclick='spanClick(\"go south\")'>back</button></span> the way you came.";
            //             break;
            //         case roomNum === 7 && firefliesReleased === true:
            //             output.innerHTML = "There is a passageway leading to the <span><button onclick='spanClick(\"go west\")'>west.</button></span> The only way out of the cave is <span><button onclick='spanClick(\"go south\")'>back</button></span> the way you came.";
            //             break;
            //         case roomNum === 8 :
            //             output.innerHTML = "The only way out of the cave is <span><button onclick='spanClick(\"go east\")'>back</button></span> the way you came.";
            //             break;
            //         case roomNum === 9 :
            //             output.innerHTML = "The only way out of the the hollow is <span><button onclick='spanClick(\"go west\")'>back</button></span> the way you came.";
            //             break;
            //         case roomNum === 10 :
            //             output.innerHTML = "You can hear running water to the <span><button onclick='spanClick(\"go south\")'>back.</button></span> The forest opens to the clearing to the <span><button onclick='spanClick(\"go east\")'>east.</button></span><br><br>You can see a rocky outcropping above the trees to the <span><button onclick='spanClick(\"go north\")'>north.</button></span>";
            //             break;
            //         case roomNum === 11 :
            //             output.innerHTML = "The darkness of the <span><button onclick='spanClick(\"go north\")'>cave</button></span> beckons to you...";
            //             break;
            //         case roomNum === 12 :
            //             output.innerHTML = "A stony path leads <span><button onclick='spanClick(\"go north\")'>north</button></span> into the woods. The lakeshore stretches to the <span><button onclick='spanClick(\"go east\")'>east.</button></span><br><br>The clearing where to awoke lies to the <span><button onclick='spanClick(\"go west\")'>west.</button></span>";
            //             break;
            //         case roomNum === 13 :
            //             output.innerHTML = "The only way out of the well is <span><button onclick='spanClick(\"go up\")'>back up</button></span> the rope.";
            //             break;
            //         case roomNum === 14 :
            //             output.innerHTML = "A narrow path leads <span><button onclick='spanClick(\"go east\")'>east</button></span> into the woods.";
            //             break;
            //         case roomNum === 15 :
            //             output.innerHTML = "The only way off the island is via the <span><button onclick='spanClick(\"ride boat\")'>boat.</button></span>";
            //             break;
            //     }
            //     break;

            // WHERE AM I
            case  inp('where') && inp('am') && inp(' i'):
                switch (true) {
                    case roomNum === 1 :
                        output.innerHTML = "It's twilight. There is a <span><button onclick='spanClick(\"inspect door\")'>strange door</button></span> standing in a grassy clearing surrounded by trees.<br><br>You are surrounded by forest to the <span><button onclick='spanClick(\"go north\")'>north</button></span>, <span><button onclick='spanClick(\"go west\")'>west</button></span>, and <span><button onclick='spanClick(\"east\")'>east.</button></span> You can hear the sound of running water to the <span><button onclick='spanClick(\"go south\")'>south.</button></span>";
                        break;
                    case roomNum === 2 :
                        output.innerHTML = "The forest is dark and overgrown here, and the the air is filled with fireflies that bathe the woods in a warm light.<br><br>To the <span><button onclick='spanClick(\"go east\")'>east</button></span>, a narrow path leads down into a murky hollow. The forest feels a bit more lush and bright to the <span><button onclick='spanClick(\"go south\")'>south</button></span> and <span><button onclick='spanClick(\"go west\")'>west.</button></span>";
                        break;
                    case roomNum === 3 :
                        output.innerHTML = "The forest is dark here. There is a <span><button onclick='spanClick(\"inspect stump\")'>stump</button></span> in the middle of the clearing with an old discarded <span><button onclick='spanClick(\"read journal\")'>notebook</button></span> alongside.<br><br>To the <span><button onclick='spanClick(\"go north\")'>north</button></span>, an overgrown path leads deeper into the forest. To the <span><button onclick='spanClick(\"go south\")'>south</button></span> you can hear the sound of running water. The forest opens up to a clearing to the <span><button onclick='spanClick(\"go west\")'>west.</button></span>";
                        break;
                    case roomNum === 4 :
                        output.innerHTML = "A big tree with a cat in it standing the middle of a wooded glade. You can see a rocky outcropping above the trees to the <span><button onclick='spanClick(\"go west\")'>west.</button></span><br><br>The forest opens to the clearing to the <span><button onclick='spanClick(\"go south\")'>south.</button></span> To the <span><button onclick='spanClick(\"go east\")'>east</button></span> the woods grow darker.";
                        break;
                    case roomNum === 5 :
                        output.innerHTML = "The lakeshore is scattered with large <span><button onclick='spanClick(\"take rock\")'>rocks.</button></span> Small pieces of driftwood and other debris have washed in on the tide.<br><br>The lake is really wide... You can't see the other side.<br><br>The lakeshore stretches to the <span><button onclick='spanClick(\"go east\")'>east</button></span> and <span><button onclick='spanClick(\"go west\")'>west.</button></span> To the <span><button onclick='spanClick(\"go north\")'>north</button></span> there is a clearing im the forest.";
                        break;
                    case roomNum === 6 :
                        output.innerHTML = "The water is cool and clear, and a few fish drift lazily along.<br><br>There is an old <span><button onclick='spanClick(\"inspect boat\")'>boat</button></span> near the shore.<br><br>The woods to the <span><button onclick='spanClick(\"go north\")'>north</button></span> seem a bit foreboding. The lakeshore stretches to the <span><button onclick='spanClick(\"go west\")'>west.</button></span>";
                        break;
                    case roomNum === 7 :
                        output.innerHTML = "You are standing in a large, dark cavern. The only way out of the cave is <span><button onclick='spanClick(\"go south\")'>back</button></span> the way you came.";
                        break;
                    case roomNum === 8 :
                        output.innerHTML = "";
                        break;
                    case roomNum === 9 :
                        output.innerHTML = "You find yourself in what be one of the most ancient parts of the forest. The trees here look like they haven't seen sunlight in years.<br><br>There is a circle of <span><button onclick='spanClick(\"inspect mushrooms\")'>mushrooms</button></span> in the middle of the hollow, surrounded by old and rotting trees. The only way out of the the hollow is <span><button onclick='spanClick(\"go west\")'>back</button></span> the way you came.";
                        break;
                    case roomNum === 10 :
                        output.innerHTML = "You're standing in front of a stone <span><button onclick='spanClick(\"inspect well\")'>well</button></span> in the middle of a clearing. You can hear running water to the <span><button onclick='spanClick(\"go south\")'>back.</button></span> The forest opens to a clearing to the <span><button onclick='spanClick(\"go east\")'>east.</button></span><br><br>You can see a rocky outcropping above the trees to the <span><button onclick='spanClick(\"go north\")'>north.</button></span>";
                        break;
                    case roomNum === 11 :
                        output.innerHTML = "You're standing in front of a large <span><button onclick='spanClick(\"go north well\")'>cave</button></span> shrouded in darkness.<br><br>A stony path cuts through the forest to the <span><button onclick='spanClick(\"go south\")'>south</button></span> and <span><button onclick='spanClick(\"go east\")'>east.</button></span>";
                        break;
                    case roomNum === 12 :
                        output.innerHTML = "There is a <span><button onclick='spanClick(\"talk robot\")'>strange figure</button></span> lying under a tree by the lake shore.<br><br>To the <span><button onclick='spanClick(\"go west\")'>west</button></span>, a narrow path leads back the the glade where you awoke. To the <span><button onclick='spanClick(\"go north\")'>north</button></span>, a wooded path cuts into the forest.";
                        break;
                    case roomNum === 13 :
                        output.innerHTML = "It's dark... there's just enough light to see around you. The ground is dry and littered with rocks and grass. The only way out is <span><button onclick='spanClick(\"go west\")'>west</button></span>, a narrow path leads back the the glade where you awoke. To the <span><button onclick='spanClick(\"go up\")'>back up</button></span> the rope.";
                        break;
                    case roomNum === 14 :
                        output.innerHTML = "It's twilight. You're standing in a forest clearing, but you're not sure how you got here.<br><br>The ground is covered with <span><button onclick='spanClick(\"take flower\")'>blue flowers</button></span>, and there is a narrow path leading <span><button onclick='spanClick(\"go south\")'>south.</button></span>";
                        break;
                    case roomNum === 15 :
                        output.innerHTML = "You're on an island! That's pretty cool.<br><br>The only way off the island is via the <span><button onclick='spanClick(\"ride boat\")'>boat.</button></span>";
                        break;
                };
                break;
                
            // DEFAULT QUESTION WORDS
            case  inp('what') && ((inp('going') && inp('on')) || inp('happen')):
                output.innerHTML = "You suddenly woke up in a strange forest. You can't really remember how you got here.<br><br>Explore the forest, and find a way out. Type <span><button onclick='spanClick(\"get hint\")'>hint</button></span> at any time to get some help.";
                break;
            case  inp('what') && inp('do') && inp(' i ') && inp('have') :
                userInput.value = "";
                output.innerHTML = checkInventory();
                displayInventory();
            case  inp('what') && inp('do') && inp(' i ') :
                output.innerHTML = "Try typing different things into the prompt and seeing what happens, or clicking in the corners of the screen above to travel around the forest.<br><br>You can type <span><button onclick='spanClick(\"get hint\")'>get hint</button></span> at any time to get some help.";
                break;
            case   inp('how') && inp('do') && inp(' i ') :
                output.innerHTML = "Try typing different things into the prompt and seeing what happens.<br><br>You can type <span><button onclick='spanClick(\"get hint\")'>hint</button></span> at any time to get some help.";
                break;
            case  inp('how') && (inp('long')||inp('old')) && inp('door'):
                output.innerHTML = "Really old.";
                break;
            case  inp('who') && inp('am') && inp(' i'):
                output.innerHTML = "You're a traveller in a strange place.";
                break;
            case  inp('rules')  :
                output.innerHTML = "Type commands below to explore and escape the forest.<br><br>You can move around quicker by tapping the corners of the screen above.<br><br>Don't forget to <span><button onclick='spanClick(\"look around\")'>look around</button></span> when you enter a new area.";
                break;
            case inp('what') && inp('supposed'):
                output.innerHTML = "Type commands below to explore and escape the forest.<br><br>You can move around quicker by tapping the corners of the screen above.<br><br>Some objects around you can be interacted with. You can type <span><button onclick='spanClick(\"check pockets\")'>pockets</button></span> to see what you have with you.<br><br>Don't forget to <span><button onclick='spanClick(\"look around\")'>look around</button></span> when you enter a new area.";
                break;
            case inp('what') && inp('is') && inp('this'):
                output.innerHTML = "\"Maybe I should try <span><button onclick='spanClick(\"look around\")'>looking around</button></span> to get my bearings,\" you think to yourself.";
                break;
            case inp('what') :
                output.innerHTML = "\"Maybe I should try <span><button onclick='spanClick(\"look around\")'>looking around</button></span> a bit,\" you think to yourself.";
                break;
            case roomNum === 14 &&  ( (inp('where') && inp('some'))||inp('forest')) && (inp('go')||inp('walk')||inp('travel')||inp('explore')) :
                room10Switch();
                goSouthAnimation();
                break;
            case roomNum === 10 && ( (inp('where') && inp('some'))||inp('forest')) && (inp('go')||inp('walk')||inp('travel')||inp('explore')) :
                room6Switch();
                goSouthAnimation();
                break;
            case roomNum === 6 && ( (inp('where') && inp('some'))||inp('forest')) && (inp('go')||inp('walk')||inp('travel')||inp('explore')) :
                room9Switch();
                goEastAnimation();
                break;
            case inp('where') || inp('explore'):
                output.innerHTML = "Try looking around.";
                break;
            case inp('when') :
                output.innerHTML = "It's twilight, and the sun is just beginning to set.";
                break;
            case inp('why') :
                output.innerHTML = "This is a strange place. Maybe you can find some answers by looking around.";
                break;

            // DEFAULT GO
            // case (inp("walk")||inp('go')||inp('travel')):
            //     userInput.value = "";
            //     output.innerHTML = "Which direction to you want to go?";
            //     break;

            // CLEARING INVENTORY
            case inp('') && checkingInventory === true:
                checkingInventory = false;
                output.innerHTML = "";
                break;

            // CLEARING MAP
            case inp('') && checkingMap === true:
                output.innerHTML = "";
                checkingMap = false;
                // makeMapBright();
                break;
            
            // CLEARING DIALOGUE
            case inp('') && inDialogue === true:
                output.innerHTML = "";
                inDialogue = false;
                setCurrentRobotConversation();
                break;

            
        // DEFAULT
            default:
                output.innerHTML = "Nothing happened.";
                break;
        };

        // // SPEW GIBBERISH IF ON MUSHROOMS

        // if (mushyTaken === true && mushyTimePassed < 7) {
        //     output.innerHTML = "Klgh lkhgl akxlv. Lgl lkjgqozo kglkxj."
        // };

        // subtract mushy count, remove mushy thing if less than 1
        mushyTimePassed = mushyTimePassed - 1;
        if (mushyValue > 0) {
            mushyValue = mushyValue - 1;
        }

        if (mushyTimePassed < 1 && mushyValue > 1) {
            document.getElementById('mapbox').classList.add('mushytaken');
            if (mushyValue > 5) {
                output.innerHTML = "...you feel a bit... funny..."
            }
        };

        if (mushyValue < 1) {
            setTimeout( function(){document.getElementById('mapbox').classList.remove('mushytaken')}, 400);
            mushyTaken = false;
        };

        // INCREASE "THINGS TRIED"
        thingsTriedSinceLastBigThing++; // resets when the box is unlocked, fireflies released, and robot awakened.
        thingsTried++;
        
        // CLEAR INPUT FORM
        userInput.value = "";
        currentPage = 0;
        outputArea.scroll(0,0);

        // make scroll arrow
        makeScrollArrow();
 
    };

// PRESSING ENTER 
    const pressEnter = () => {
        if (inCutscene === false) {
        // clear placeholder on input form
        userInput.placeholder = "";
        // make button flash
        whiteButtonFlash(enterButton);
        let fem = document.getElementById('userinput').value;
        if ((reading === true || readingAsk === true) && (fem ==""||inp("read"))) {
            showBookText();
            //document.getElementById("book").src="./inventoryimages/book.png";
        } else {
            processInput();
            reading = false;
            hideBook();
        };
        if (inventoryAsk === false) {checkingInventory = false};
        if (mapAsk === false) {checkingMap = false};
        if (dialogueAsk === false) {inDialogue = false};
        hideMobileKeyboardOnReturn(input);
    }
    };

    enterButton.addEventListener('click', pressEnter);

    const whiteButtonFlash = (buttonID) => {
        buttonID.classList.add('whitefadeoutforbuttons');
        setTimeout(()=> {buttonID.classList.remove('whitefadeoutforbuttons')}, 200);
    };

    // from https://www.w3schools.com/howto/tryit.asp?filename=tryhow_js_trigger_button_enter
    var input = document.getElementById("userinput");
    input.addEventListener("keypress",
    function(event) {
        if (event.key === "Enter") {
            event.preventDefault();
            document.getElementById("enterbutton").click();
            // outputArea.scroll(0,0);
            hideMobileKeyboardOnReturn(input);
        }
    });

        // // hacky keyboard hide when soft keyboard "enter" is pressed, via https://andy-carter.com/blog/how-to-close-the-mobile-keyboard-on-return and https://stackoverflow.com/questions/41868060/how-to-run-some-javascript-code-only-on-small-screen-mobile-devices
        const hideMobileKeyboardOnReturn = (element) => {
            if ( 
                   navigator.userAgent.match(/Android/i)
                || navigator.userAgent.match(/webOS/i)
                || navigator.userAgent.match(/iPhone/i)
                || navigator.userAgent.match(/iPad/i)
                || navigator.userAgent.match(/iPod/i)
                || navigator.userAgent.match(/BlackBerry/i)
                || navigator.userAgent.match(/Windows Phone/i)
                ) {
            element.addEventListener('keyup', (keyboardEvent) => {
                const key = keyboardEvent.code || keyboardEvent.keyCode;
                if (key === 'Enter' || key === 13) {
                    element.blur();
                }
             });
        }};

// prevent dragging images
document.getElementById('titlecard').ondragstart = function() { return false; };
document.getElementById('sparkles').ondragstart = function() { return false; };
document.getElementById('themachine').ondragstart = function() { return false; };
document.getElementById('viewbox').ondragstart = function() { return false; };
document.getElementById('viewer').ondragstart = function() { return false; };
document.getElementById('border1').ondragstart = function() { return false; };
document.getElementById('border2').ondragstart = function() { return false; };
document.getElementById('titlecardtext').ondragstart = function() { return false; };
document.getElementById('mapbox').ondragstart = function() { return false; };

</script>



</html>