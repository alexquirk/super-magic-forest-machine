<!DOCTYPE html>
<html lang="en">

<!-- HEAD-->
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Magic Forest Machine</title>
    <link rel="stylesheet" href="styles.CSS">
    <style> @import url('https://fonts.googleapis.com/css2?family=DotGothic16&family=Press+Start+2P&display=swap'); </style>
</head>
<body>


<!-- THE MACHINE -->

<img id="titlecard" src="./extraimages/titlecard.png" onclick="makeFadeAway()">

<div id="cutsceneviewer">
    <video id="cutscene" autoplay="autoplay" muted playsinline>
        <source src="" type="video/mp4">
    </video>
</div>

<article id="themachine">
    
    <!-- VIEWER -->
    <div class="viewbox">
        <img class="border1" src="./roomimages/border 1.png">
        <div class="viewer">
            <div id= "map">
                <img class="room" id="room1" src="./roomimages/smfmroom1.png"><img class="room" id="room2" src="./roomimages/smfmroom2.png"><img class="room" id="room3" src="./roomimages/smfmroom3.png"><img class="room" id="room4" src="./roomimages/smfmroom4a.png"><img class="room" id="room5" src="./roomimages/smfmroom5.png"><img class="room" id="room6" src="./roomimages/smfmroom6a.png"><img class="room" id="room7" src="./roomimages/smfmroom7a.png"><img class="room" id="room8" src="./roomimages/smfmroom8.png"><img class="room" id="room9" src="./roomimages/smfmroom9a.png"><img class="room" id="room10" src="./roomimages/smfmroom10a.png"><img class="room" id="room11" src="./roomimages/smfmroom11.png"><img class="room" id="room12" src="./roomimages/smfmroom12a.png"><img class="room" id="room13" src="./roomimages/smfmroom13a.png">
            </div>            
            <img id= "inventory1">
            <img id= "inventory2">
            <img id= "inventory3">
            <img id= "inventory4">
            <img id= "inventory5">
            <img id= "inventory6">
            <img id= "inventory7">
            <img id= "book">
            <div id= "maptiles">
                <img class="roomtile" id="maparrow" src="./maptiles/maparrow.png"><img class="roomtile" id="room1tile" src="./maptiles/room1tile.png"><img class="roomtile" id="room2tile"><img class="roomtile" id="room3tile"><img class="roomtile" id="room4tile"><img class="roomtile" id="room5tile"><img class="roomtile" id="room6tile"><img class="roomtile" id="room7tile"><img class="roomtile" id="room8tile"><img class="roomtile" id="room9tile"><img class="roomtile" id="room10tile"><img class="roomtile" id="room11tile"><img class="roomtile" id="room12tile">
            </div>   
        </div>
        <img class="border2" src="./roomimages/border 2.png">
    </div>

    <!-- OUTPUT AREA -->
    <div id="outputarea">
        <div id="output">You open your eyes and find yourself in a forest clearing. 
            In front of you stands a wooden <span>door</span>.
            <br><br>
            You try to remember how you got here, but your mind is fuzzy. "Guess I fell asleep," you think to yourself.
            <br><br>
            Try <span>looking around</span>.
            <br><br>
            You can type <span>help</span> at any time to get a hint.
        </div>
        <div class="dialoguearea">
            <input type="button" id="dialogue1" class="dialogue" value="Option 1">
            <input type="button" id="dialogue2" class="dialogue" value="Option 2">
            <input type="button" id="bookbutton" class="dialogue" value="Read Journal">
        </div>
        </div>
    </div>
    
     <!-- INPUT AREA -->
<div class="inputarea">
    <input type="text" id="userinput" maxlength="25">
    <input type="button" id="enterbutton" value="ENTER">
</div>
</article>



</body>


<!-- SCRIPT -->
<script>

// PRESS ANY KEY TO CONTINUE

document.onkeydown = e =>{ 
    document.getElementById('titlecard').classList.add('fadeout');
    let makeGoAway = () => {document.getElementById('titlecard').style.display = "none"};
    setTimeout(makeGoAway, 1000);
};
const makeFadeAway = () => {
    document.getElementById('titlecard').classList.add('fadeout');
    let makeGoAway = () => {document.getElementById('titlecard').style.display = "none"};
    setTimeout(makeGoAway, 1000);
}


//DECLARE VARIABLES
    const userInput = document.getElementById('userinput');
    const outputarea = document.getElementById('outputarea');
    const output = document.getElementById('output');
    const enterButton = document.getElementById('enterbutton');
    const mapArrow = document.getElementById('maparrow');
    const d1 = document.getElementById("dialogue1");
    const d2 = document.getElementById("dialogue2");
    const bookButton = document.getElementById("bookbutton");

    const removeItem = (item) => {
        for ( var i = 0; i < inventory.length; i++) { 
            if (inventory[i] === (item)) { 
                inventory.splice(i, 1); 
            }
        };           
    };

    let roomNum = 1;

    let checkingInventory = false;
    let doorUnlocked = false;
    let haveRock = false;
    let haveFlower = false;
    let boxUnlocked = false;
    let catDiscovered = false;
    let marbleDown = false;
    let marbleReunited = false;
    let ropeTaken = false;
    let haveRope = false;
    let ropeSet = false;
    let haveBox = false;
    let haveBoxKey = false;
    let mugTaken = false;
    let haveMug = false;
    let ghostGivenMug = false;
    let robotAwake = false;
    let haveCrystal = false;
    let haveFireflies = false;
    let firefliesReleased = false;
    let electroVineTaken = false;
    let haveRibbon = false;
    let foundBook = false;
    let haveMushy = false;
    let currentPage = 0;
    let reading = false;
    let readingAsk = false;
    let ghostDiscovered = false;
    let checkingMap = false;
    let thingsTried = 0;
    let firstHint = false;

    const roomVisited = ["", true, false, false, false, false, false, false, false, false, false, false, false, false];
    const inventory = [];

// INVENTORY
    const checkInventory = () => {
        if (inventory.length === 0) {
            return "You don't have anything in your <span>pockets</span> yet.<br><br>Maybe there is something useful nearby you can <span>take</span> with you?"
        } else {
            let inventoryText = ["You have "];
            for (var i = 0; i < inventory.length - 1; i++) {
                inventoryText.push(" " + inventory[i] + ",");
            };
            if (inventory.length > 1) {
                inventoryText.push(" and " + inventory[inventory.length -1]+ " in your <span>pocket</span>.<br><br>Press 'ENTER' to return.")
            } else {
                inventoryText.push(" " + inventory[inventory.length -1]+ " in your <span>pocket</span>.<br><br>Press 'ENTER' to return.")
            };
            return inventoryText.join('');
        };
        // document.getElementById("map").classList.toggle('blur');
    };
    // Displaying Inventory Images
    const displayInventory = () => {
            if (inventory.length > 0) {document.getElementById('map').classList.add('blur')};
            if (haveFlower === true) {
                    document.getElementById("inventory6").src="./inventoryimages/flower.png";
                    checkingInventory = true;
            };
            if (haveRibbon === true) {
                    document.getElementById("inventory2").src="./inventoryimages/ribbon.png";
                    checkingInventory = true;
            };
            if (haveBoxKey === true) {
                    document.getElementById("inventory4").src="./inventoryimages/key.png";
                    checkingInventory = true;
            };
            if (haveCrystal === true) {
                    document.getElementById("inventory5").src="./inventoryimages/crystal.png";
                    checkingInventory = true;
            };
            if (haveRock === true) {
                    document.getElementById("inventory7").src="./inventoryimages/rock.png";
                    checkingInventory = true;
            };
            if (haveFireflies === true && haveRope === true) {
                document.getElementById("inventory1").src="./inventoryimages/boxglowrope.png";
                checkingInventory = true;
            } else if (haveFireflies === true && haveRope === false) {
                document.getElementById("inventory1").src="./inventoryimages/boxglow.png";
                checkingInventory = true;
            } else if (boxUnlocked === true && haveRope === true) {
                document.getElementById("inventory1").src="./inventoryimages/boxopenrope.png";
                checkingInventory = true;
            } else if (boxUnlocked === true && haveRope === false) {
                document.getElementById("inventory1").src="./inventoryimages/boxopen.png";
                checkingInventory = true;
            } else if (haveBox === true && haveRope === true) {
                document.getElementById("inventory1").src="./inventoryimages/boxrope.png";
                checkingInventory = true;
            } else if (haveBox === true) {
                document.getElementById("inventory1").src="./inventoryimages/box.png";
                checkingInventory = true;
            } else if (haveRope === true) {
                document.getElementById("inventory1").src="./inventoryimages/rope.png";
                checkingInventory = true;
            };
            if (haveMug === true) {
                document.getElementById("inventory3").src="./inventoryimages/mug.png";
                checkingInventory = true;
            } else if (haveMushy === true) {
                document.getElementById("inventory3").src="./inventoryimages/mushy.png";
                checkingInventory = true;
            }
    };

// BOOK BUTTONS
    //page texts
    const journalText = ["The <span>journal</span> begins:<br><br><span class='journal'>          Day 14<br><br>Still no sign of it. <br><br>Our readings indicated that it should be near, but as soon as we got close, all our instruments went haywire. We'll have to continue our search manually until the equipment is repaired.</span>",
                         "<span class='journal'>                                                  Day 15<br><br>A preliminary search of the area was conducted without result. The forest is dense and difficult to travel through. <br><br>Equipment problems persist - possible satellite failure or solar activity. We are forced to leave the proximity zone to contact HQ, which slows progress considerably.</span>", 
                         "<span class='journal'>                                                  Day 19<br><br>That silly young intern keeps wandering off. Kids these days! No discipline.<br><br>A preliminary search of the area was completed. without result. There is something odd about this place. I can’t put my finger on it. I will attempt an explanation my next report.</span>",
                         "<span class='journal'>                                                  Day 23<br><br>I’m beginning to wonder if we’re going to find it here after all. We have search every corner of the proximity zone, and still no sign of it. <br><br>Maybe HQ made a mistake. That seems unlikely… good luck trying to explain that to the board. The wild variety is said to be 10.8 to 11.3 times stronger than the domesticated variety, with a potential yield to match. Failure is not an option.</span>",
                         "<span class='journal'>                                                  Day 28<br><br>There is a scientific explanation for everything.<br><br>On day 13 we found a cave at to the northwest end of the proximity zone. As soon as we enter, all our flashlights fizzled out, leaving us in total darkness and with no choice but to feel our way back to the entrance.<br><br>If I believed in luck, I would say we are having the worst.<br><br>The cave doesn’t seem like a likely place to find it anyway, since all research indicates that it prefers bright sunlight. The search continues.</span>",
                         "<span class='journal'>                                                  Day 56<br><br>What does it mean to be lost? What does it mean to ‘be’ at all? This place makes me feel… Nevermind. The board will launch an inquiry, and everything will be explained in due time. <br><br>The intern has wandered off again. So sentimental… I caught them drinking out of the lake. Can you imagine… We brought ample hydration packets, even the FlavorMax variety, yet they prefer to drink dirty lake water…</span>",
                         "<span class='journal'>                                                  Day ??<br><br>The days… the weeks… I’ve almost entirely lost track of time.<br><br>HQ has recalled us. The intern disappeared a few nights ago and hasn’t returned. We searched for hours. Oh well. They probably prefer it here anyway. </span>" 
                        ];

    //change button according to input value
    const showBookButton = (buttonText) => {
        bookButton.value = buttonText;
        bookButton.style.display = "block"; 
    };

    //display journal texts according to position in array
    const showBookText = () => {
        if (reading === true || readingAsk === true) {
            output.innerHTML = journalText[currentPage];
            document.getElementById("book").src="./inventoryimages/book.png";
            currentPage = currentPage + 1;
            reading = true;
            readingAsk = false;
            bookButton.value = 'Keep Reading';
            document.getElementById('map').classList.add('blurless');
            if (currentPage === 7) {
                bookButton.value = "Done";
                userInput.value = "";
            } 
            else if (currentPage >= 8 ) {
                output.innerHTML = "";
                currentPage = 0;
                bookButton.style.display = "none";
                reading = false;
                document.getElementById("book").src="";
                document.getElementById('map').classList.remove('blurless');
            }
        };
        outputarea.scroll(0,0);
    };

//hit button to show book text
bookButton.addEventListener('click', showBookText);


// CUTSCENES
const playGhostCutscene = () => {
    document.getElementById('cutsceneviewer').style.display = "flex";
    document.getElementById("cutscene").src="./cutscenes/ghostcutscene.mp4";
    let currentCutscene = document.getElementById("cutscene");
    currentCutscene.addEventListener('ended', function() {
        document.getElementById('cutsceneviewer').style.display = "none";
        room9Switch();
        output.innerHTML = "A <span>ghost</span> appeared!!";
        document.getElementById("cutscene").src="";
    })
};

const playMarbleCutscene = () => {
    document.getElementById('cutsceneviewer').style.display = "flex";
    document.getElementById("cutscene").src="./cutscenes/marblecutscene.mp4";
    let currentCutscene = document.getElementById("cutscene");
    currentCutscene.addEventListener('ended', function() {
        document.getElementById('cutsceneviewer').style.display = "none";
        room4Switch();
        output.innerHTML = "You wave the <span>ribbon</span> around a bit, and suddenly the <span>cat</span> perks up and leaps from the tree!";
        document.getElementById("cutscene").src="";
    })
};

// ROOM SWITCHING FUNCTIONS

const room1 = document.getElementById("room1");
const room2 = document.getElementById("room2");
const room3 = document.getElementById("room3");
const room4 = document.getElementById("room4");
const room5 = document.getElementById("room5");
const room6 = document.getElementById("room6");
const room7 = document.getElementById("room7");
const room8 = document.getElementById("room8");
const room9 = document.getElementById("room9");
const room10 = document.getElementById("room10");
const room11 = document.getElementById("room11");
const room12 = document.getElementById("room12");
const room13 = document.getElementById("room13");

allRooms = [room1, room2, room3, room4, room5, room6, room7, room8, room9, room10, room11, room12, room13]

const moveAllRoomsBack = () => {
    allRooms[roomNum-1].style.zIndex = "-2"; 
    }

const room1Switch = () => {
        mapArrow.style.top = "53%";
        mapArrow.style.left = "42.6%";
        output.innerHTML = "The <span>wooden door</span> stands in the middle of the clearing.";
        moveAllRoomsBack();
        room1.style.zIndex = "0";
    };
    const room2Switch = () => {
        if (roomVisited[2] === false) {
            output.innerHTML = "The forest grows darker. Large leafy branches block out almost at the light from the fading sun.<br><br>In the middle of the clearing, the <span>glowing light</span> of countless fireflies illuminate the forest.";
        } else {
            output.innerHTML = "The forest is dark, but the air is filled with <span>fireflies</span>.";
        };
        roomVisited[2] = true;
        mapArrow.style.top = "32%";
        mapArrow.style.left = "55.3%";
        moveAllRoomsBack();
        room2.style.zIndex = "0";
        document.getElementById("room2tile").src="./maptiles/room2tile.png";
    };
    const room3Switch = () => {
        if (roomVisited[3] === false) { 
            if (roomNum === 1 || roomNum === 6) {
                output.innerHTML = "The trees grow more dense as you travel through the forest.<br><br>You arrive at a shady knoll with an old <span>stump</span> in the middle.";
            } else {
                output.innerHTML = "You make your way <span>south</span> through the forest.<br><br>You arrive at a shady knoll with an old <span>stump</span> in the middle.";
            }
        } else {
            output.innerHTML = "An old <span>tree stump</span> sits in the center of a shady knoll.";
        };
        roomVisited[3] = true;
        mapArrow.style.top = "53%";
        mapArrow.style.left = "55.3%";
        moveAllRoomsBack();
        room3.style.zIndex = "0";
        document.getElementById("room3tile").src="./maptiles/room3tile.png";
    };
    const room4Switch = () => {
        if (roomNum === 1 && marbleDown === false) {
            output.innerHTML = "You travel <span>north</span> until you arrive at glade with a large <span>tree</span> in the middle.<br><br><span>Something</span> is rustling up in the tree's branches...";
        } else if (roomNum === 2 && marbleDown === false) {
            output.innerHTML = "You travel <span>west</span> until you arrive at glade with a large <span>tree</span> in the middle.<br><br><span>Something</span> is rustling up in the tree's branches...";
        } else if (marbleDown === false) {
            output.innerHTML = "You arrive at a glade with a large <span>tree</span> in the middle.<br><br><span>Something</span> is rustling up in the tree's branches...";
        } else if (marbleDown === true) {
            output.innerHTML = "You arrive at a glade with a large <span>tree</span> in the middle. This is where the <span>cat</span> was.";
        };
        roomVisited[4] = true;
        mapArrow.style.top = "32%";
        mapArrow.style.left = "42.6%";
        moveAllRoomsBack();
        if (marbleDown === false) {room4.src="./roomimages/smfmroom4a.png"}
        else if (marbleReunited !== true) {room4.src="./roomimages/smfmroom4b.png"}
        else {room4.src="./roomimages/smfmroom4c.png"};
        room4.style.zIndex = "0";
        document.getElementById("room4tile").src="./maptiles/room4tile.png";
    };
    const room5Switch = () => { 
        if (roomNum === 1) {
            output.innerHTML = "You travel <span>south</span> until you arrive at at rocky <span>lake shore</span>. The fading sunlight glistens on the calm surface.";
        } else if (roomNum === 12) {
            output.innerHTML = "You travel <span>east</span> until you arrive at at rocky <span>lake shore</span>. The fading sunlight glistens on the calm surface.";
        } else {
            output.innerHTML = "You travel <span>west</span> until you arrive at at rocky <span>lake shore</span>. The fading sunlight glistens on the calm surface.";
        };
        roomVisited[5] = true;
        mapArrow.style.top = "73%";
        mapArrow.style.left = "42.6%";
        moveAllRoomsBack();
        room5.style.zIndex = "0";
        document.getElementById("room5tile").src="./maptiles/room5tile.png";
    };
    const room6Switch = () => {
        if (haveRope === false && ropeSet === false && roomNum === 5) {
                output.innerHTML = "You travel <span>east</span> along the lake shore until you arrive at a wooded point, where a half-sunk <span>boat</span> is tied to a mooring.";
            } else if (haveRope === false && ropeSet === false && roomNum === 3) {
                output.innerHTML = "You travel <span>south</span> through the forest until you arrive at a wooded <span>shoreline</span>, where a half-sunk <span>boat</span> is tied to a mooring.";
            } else {
                output.innerHTML = "You arrive at the wooden point where the half-sunk <span>boat</span> sits in the water.";
        };
        roomVisited[6] = true;
        mapArrow.style.top = "73%";
        mapArrow.style.left = "55.3%";
        moveAllRoomsBack();
        if (ropeTaken === false) {room6.src="./roomimages/smfmroom6a.png"}
        else {room6.src="./roomimages/smfmroom6b.png"};
        room6.style.zIndex = "0";
        document.getElementById("room6tile").src="./maptiles/room6tile.png";
    }; 
    const room7Switch = () => {
        if (firefliesReleased === false) {
            output.innerHTML = "You make your way inside the <span>cave</span>. The light slowly fades behind you until you find yourself in almost complete <span>darkness</span>.<br><br>Soon you can barely see your hands in front of you.";
        } else {
            output.innerHTML = "The <span>cave</span> is filled with the light of countless <span>fireflies</span>. The strange <span>crystals</span> glow faintly.";
        };
        roomVisited[7] = true;
        mapArrow.style.top = "13%";
        mapArrow.style.left = "29.8%";
        moveAllRoomsBack();
        if (firefliesReleased === false) {
            room7.src="./roomimages/smfmroom7a.png"
            document.getElementById("room7tile").src="./maptiles/room7tiledark.png";
        }
        else {
            room7.src="./roomimages/smfmroom7b.png";
            document.getElementById("room7tile").src="./maptiles/room7tile.png";
        }
        room7.style.zIndex = "0";
    }; 
    const room8Switch = () => {
        if (roomVisited[8] === false) {
            output.innerHTML = "You make your way <span>west</span> through the dimly-lit cave and arrive at large grotto. A single beam of light from far above illuminates an island in the center of an underground lake.";
        } else {
            output.innerHTML = "You arrive at large grotto, where single beam of light from far above illuminates an island in the center of an underground lake.";
        };
        roomVisited[8] = true;
        mapArrow.style.top = "13%";
        mapArrow.style.left = "16.9%";
        moveAllRoomsBack();
        room8.style.zIndex = "0";
        document.getElementById("room8tile").src="./maptiles/room8tile.png";
    };
    const room9Switch = () => {
        if (roomVisited[9] === false) {
            output.innerHTML = "A narrow path leads you <span>east</span> through the forest. The air grows stale as dried and rotting tree branches grab at your clothes.<br><br>You arrive at a murky hollow and a circle of <span>mushrooms</span>.";
        } else {
            output.innerHTML = "A narrow path leads you <span>east</span> through the forest.<br><br>You arrive at a murky hollow and a circle of <span>mushrooms</span>.";
        };
        roomVisited[9] = true;
        mapArrow.style.top = "32%";
        mapArrow.style.left = "68%";
        moveAllRoomsBack();
        if (ghostGivenMug === true || ghostDiscovered === false ) {room9.src="./roomimages/smfmroom9b.png"}
        else {room9.src="./roomimages/smfmroom9a.png"};
        room9.style.zIndex = "0";
        document.getElementById("room9tile").src="./maptiles/room9tile.png";
    }; 
    const room10Switch = () => {
        if (roomVisited[10] === false) { 
            if (roomNum === 1) {
                output.innerHTML = "You travel <span>west</span>, making your way along a wooded trail until you arrive at a <span>stone well</span>.<br><br>You wonder who made this <span>well</span>, and how long ago.";
            } else if (roomNum === 13) {
                output.innerHTML = "You climb back out of the well."
            } else {
                output.innerHTML = "You arrive at a <span>stone well</span>.<br><br>You wonder who made this <span>well</span>, and how long ago.";
            };
        } 
        else {
            if (roomNum === 1) {
                output.innerHTML = "You travel <span>west</span> to find the <span>stone well</span>.";
            } else if (roomNum === 12) {
                output.innerHTML = "You travel <span>north</span> to find the <span>stone well</span>.";
            } else if (roomNum === 12) {
                output.innerHTML = "You travel <span>south</span> to find the <span>stone well</span>.";
            }
        };
        roomVisited[10] = true;
        mapArrow.style.top = "53%";
        mapArrow.style.left = "29.8%";
        moveAllRoomsBack();
        if (ropeSet === false) {room10.src="./roomimages/smfmroom10a.png"}
        else {room10.src="./roomimages/smfmroom10b.png"};
        room10.style.zIndex = "0";
        document.getElementById("room10tile").src="./maptiles/room10tile.png";
    }; 
    const room11Switch = () => {
        if (roomVisited[11] === false) {
            output.innerHTML = "You arrive at the mouth of a large <span>cave<span>.";
        } else {
            output.innerHTML = "You travel back to the mouth of the large <span>cave</span>";
        };
        roomVisited[11] = true;
        mapArrow.style.top = "32%";
        mapArrow.style.left = "29.8%";
        moveAllRoomsBack();
        room11.style.zIndex = "0";
        document.getElementById("room11tile").src="./maptiles/room11tile.png";
    };
    const room12Switch = () => {
        if (robotAwake === false) {
            if (roomNum === 5) {
                output.innerHTML = "You travel <span>west</span> along the lakeshore until you arrive at a wooden fence, beyond which the forest grows dense and dark.<br><br>Under a tree near the shore, a <span>strange figure</span> is lying the in the shade, as if resting.";
            } else {
                output.innerHTML = "You travel <span>south</span> west until you arrive at a <span>lake shore</span>. To the <span>west</span>, a wooden fence marks a border, beyond which the forest grows dense and dark.<br><br>Under a tree near the shore, a <span>strange figure</span> is lying the in the shade, as if resting.";
            }
        }
        else {
            if (roomNum === 5) {
                output.innerHTML = "You travel <span>west</span> along the lakeshore until you arrive at a wooden fence, beyond which the forest grows dense and dark.<br><br>The <span>strange metal figure</span> is standing beneath the tree.";
            } else {
                output.innerHTML = "You travel <span>south</span> along the lakeshore until you arrive at a wooden fence, beyond which the forest grows dense and dark.<br><br>The <span>strange metal figure</span> is standing beneath the tree.";
            }
        };
        roomVisited[12] = true;
        mapArrow.style.top = "69.35%";
        mapArrow.style.left = "29.8%";
        moveAllRoomsBack();
        if (robotAwake === false) {room12.src="./roomimages/smfmroom12a.png"}
        else {room12.src="./roomimages/smfmroom12b.png"};
        room12.style.zIndex = "0";
        document.getElementById("room12tile").src="./maptiles/room12tile.png";
    }; 
    const room13Switch = () => {
        output.innerHTML = "You carefully climb down the rope to the bottom of the <span>well</span>.";
        roomVisited[13] = true;
        moveAllRoomsBack();
        if (mugTaken === false) {room13.src="./roomimages/smfmroom13a.png"}
        else {room13.src="./roomimages/smfmroom13b.png"};
        room13.style.zIndex = "0";
    }; 

// VIEWING THE MAP
const checkMap = () => {
    if (checkingMap === true)
    {document.getElementById('maptiles').style.display = "block";}
};

// USER INPUT
    const inp = (arg) => {
        return userInput.value.toLowerCase().includes(arg);
    };
    const processInput = () => {
        //clear inventory
        document.getElementById('map').classList.remove('blur');
        document.getElementById("inventory1").src="";document.getElementById("inventory2").src="";document.getElementById("inventory3").src="";document.getElementById("inventory4").src="";document.getElementById("inventory5").src="";document.getElementById("inventory6").src="";document.getElementById("inventory7").src="";

        //clear map
        document.getElementById('maptiles').style.display = "none";

        // not being asked
        readingAsk = false;

        //clear buttons
        bookButton.style.display = "none";
        document.getElementById("book").src="";
        document.getElementById('map').classList.remove('blurless');
        d1.style.display = "none";
        d2.style.display = "none";
        

        // GET INPUT
        switch (true) {
    
        // GLOBAL
            case inp("nap") || inp("sleep"):
                output.innerHTML = "You're not really tired.";
                break; 
            case inp('chill') || (inp('not') && inp('much')):
                output.innerHTML = "cool cool";
                break;
            case inp('hello'):
                output.innerHTML = "Hi :)";
                break;
            case inp('what') && inp('up'):
                output.innerHTML = "Nothing much, hbu";
                break;
            case inp('marco') :
                output.innerHTML = "Polo!";
                break;
            case inp('reset'):
                room1Switch();
                roomNum = 1;
                userInput.value = "";
                output.innerHTML = "";
                break;
            case inp("poop") :
                output.innerHTML = "...c'mon...";
                break;
            case inp("peepee") :
                output.innerHTML = "...seriously...?";
                break;
            case inp('how') && inp('going') :
                output.innerHTML = "Pretty good! Playing a game with a cool person.";
                break;
            case inp('look') && inp('moon') && roomNum !== 7 && roomNum !== 8 && roomNum !== 13:
                output.innerHTML = "The moon is just beginning to rise over the forest.";
                break;
            case inp('look') && inp('moon') :
                output.innerHTML = "You can't see the moon from here.";
                break;
            case inp('look') && inp('sun') && roomNum !== 7 && roomNum !== 8 && roomNum !== 13:
                output.innerHTML = "The sun is beginning to set over the forest.";
                break;
            case inp('look') && inp('sun') :
                output.innerHTML = "You can't see the sun from here.";
                break;
            
        // HINT
            case (inp("hint") || inp("help") || inp("clue")) && firstHint === false :
                output.innerHTML = "There is something strange about this place...<br><br>Try <span>looking around</span>, <span>walking</span> in a direction, or <span>inspecting</span> things.<br><br>You can also <span>take</span> useful objects, <span>use</span> objects, or check your <span>pockets</span> to see what objects you have with you.<br><br> You can also check your <span>map</span> to see where you've been.";
                firstHint = true;
                break;
            case (inp("hint") || inp("help") || inp("clue")) && inventory.length === 0 :
                output.innerHTML = "The objects around you can be interacted with. Trying typing \"<span>pick up rock</span>\".<br><br>You can also type \"<span>check pockets</span>\" or \"<span>inventory</span>\" to see what items you have with you.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && roomVisited[4] === false && roomVisited[3] === false && roomVisited[10] === false  && roomVisited [5] === false:
                output.innerHTML = "There's a lot of forest to explore! Try typing \"<span>walk south</span>\", or \"map\" to see where you are.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && haveBoxKey === false && roomNum !== 12 && roomNum !== 5 && roomNum !== 6:
                output.innerHTML = "You can hear the sound of water to the <span>south</span>. That might be a good place to <span>look around</span>.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && haveBoxKey === false :
                output.innerHTML = "Try <span>searching</span> around the water to see what has washed up on the shore.";
                break;



        // MAP CHECKING
        case inp('map') :
            checkingMap = true;
            output.innerHTML = "You open your <span>map</span>."
            userInput.value = "";
            checkMap();
            break;

        // CHECK INVENTORY
            case ((inp("check")||inp('look')||inp('inspect'))   &&    inp('pocket')) || inp('inventory')  :
                userInput.value = "";
                output.innerHTML = checkInventory();
                displayInventory();
                break;
            
        // TRAVEL

            // GOING EAST
            case (inp("walk")||inp('go')||inp('travel'))   &&    (inp('east')||inp('right'))  :
                switch (roomNum) {
                    case 9:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dark and dense to go any further east.";
                        break;
                    case 1:
                        room3Switch();
                        userInput.value = "";
                        roomNum = 3;
                        break;
                    case 13:
                        userInput.value = "";
                        output.innerHTML = "There's nowhere to go!";
                        break;
                    case 4:
                        room2Switch();
                        userInput.value = "";
                        roomNum = 2;
                        break;
                    case 5:
                        room6Switch();
                        userInput.value = "";
                        roomNum = 6;
                        break;
                    case 3:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dense to go any further east.";
                        break;
                    case 6:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dense to go any further east.";
                        break;
                    case 11:
                        room4Switch();
                        userInput.value = "";
                        roomNum = 4;
                        break;
                    case 8:
                        room7Switch();
                        userInput.value = "";
                        roomNum = 7;
                        break;
                    case 10:
                        room1Switch();
                        roomNum = 1;
                        break;
                    case 2:
                        room9Switch();
                        roomNum = 9;
                        break;
                    case 12:
                        room5Switch();
                        roomNum = 5;
                        break;
                    case 7:
                        if (firefliesReleased === false) {
                            output.innerHTML = "If you go any further you will lose yourself in the <span>darkness</span>."
                        } else {
                            output.innerHTML = "There's nowhere to go that way."
                        };
                        break;
                };
                break;

            // GOING NORTH
            case roomNum !== 13 && (inp("walk")||inp('go')||inp('travel'))   &&    (inp('north')||inp('up')||inp('straight')||inp('forward'))   :
                switch (roomNum) {
                    case 3:
                        room2Switch();
                        userInput.value = "";
                        roomNum = 2;
                        break;
                    case 5:
                        room1Switch();
                        userInput.value = "";
                        roomNum = 1;
                        break;
                    case 4:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dense to go any further north.";
                        break;
                    case 2:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dense to go any further north.";
                        break;
                    case 9:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dark and dense to go any further north.";
                        break;
                    case 1:
                        room4Switch();
                        userInput.value = "";
                        roomNum = 4;
                        break;
                    case 6:
                        room3Switch();
                        userInput.value = "";
                        roomNum = 3;
                        break;
                    case 12:
                        room10Switch();
                        userInput.value = "";
                        roomNum = 10;
                        break;
                    case 10:
                        room11Switch();
                        userInput.value = "";
                        roomNum = 11;
                        break;
                    case 7:
                        if (firefliesReleased === false) {
                            output.innerHTML = "If you go any further you will lose yourself in the <span>darkness</span>."
                        } else {
                            output.innerHTML = "There's nowhere to go that way."
                        };
                        break;
                    case 11:
                        room7Switch();
                        userInput.value = "";
                        roomNum = 7;
                        break;
                };
                break;

            // GOING WEST
            case (inp("walk")||inp('go')||inp('travel'))   &&    (inp('west')||inp('left'))   :
                switch (roomNum) {
                    case 11:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dense to go any further west.";
                        break;
                    case 10:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dense to go any further west.";
                        break;
                    case 13:
                        userInput.value = "";
                        output.innerHTML = "There's nowhere to go!";
                        break;
                    case 12:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dense to go any further west, and there is a fence in the way.";
                        break;
                    case 3:
                        room1Switch();
                        userInput.value = "";
                        roomNum = 1;
                        break;
                    case 2:
                        room4Switch();
                        userInput.value = "";
                        roomNum = 4;
                        break;
                    case 6:
                        room5Switch();
                        userInput.value = "";
                        roomNum = 5;
                        break;
                    case 9:
                        room2Switch();
                        userInput.value = "";
                        roomNum = 2;
                        break;
                    case 4:
                        room11Switch();
                        userInput.value = "";
                        roomNum = 11;
                        break;
                    case 1:
                        room10Switch();
                        userInput.value = "";
                        roomNum = 10;
                        break;
                    case 5:
                        room12Switch();
                        userInput.value = "";
                        roomNum = 12;
                        break;
                    case 7:
                        if (firefliesReleased === false) {
                            output.innerHTML = "If you go any further you will lose yourself in the <span>darkness</span>."
                        } else {
                            room8Switch();
                            roomNum = 8;
                        }
                        userInput.value = "";
                        break;

                };
                break;

            // GOING SOUTH
            case roomNum !== 10 && (inp("walk")||inp('go')||inp('travel'))   &&    (inp('south')||inp('down'))   :
                switch (roomNum) {
                    case 9:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dark and dense to go any further south.";
                        break;
                    case 2:
                        room3Switch();
                        userInput.value = "";
                        roomNum = 3;
                        break;
                    case 1:
                        room5Switch();
                        userInput.value = "";
                        roomNum = 5;
                        break;
                    case 4:
                        room1Switch();
                        userInput.value = "";
                        roomNum = 1;
                        break;
                    case 3:
                        room6Switch();
                        userInput.value = "";
                        roomNum = 6;
                        break;
                    case 5:
                        userInput.value = "";
                        output.innerHTML = "You can't go any farther south - the water seems to go on forever.";
                        break;
                    case 13:
                        userInput.value = "";
                        output.innerHTML = "There's nowhere to go!";
                        break;
                    case 6:
                        userInput.value = "";
                        output.innerHTML = "You can't go any farther south - the water seems to go on forever.";
                        break;
                    case 12:
                        userInput.value = "";
                        output.innerHTML = "You can't go any farther south - the water seems to go on forever.";
                        break;
                    case 7:
                        room11Switch();
                        userInput.value = "";
                        roomNum = 11;
                        break;
                    case 11:
                        room10Switch();
                        userInput.value = "";
                        roomNum = 10;
                        break;
                };
                break;

            // SPECIAL CASE FOR ROOM 10 BECAUSE OF GOING "DOWN" THE WELL
            case roomNum === 10 && inp("go")   &&    inp('down')  && ropeSet === true  :
                output.innerHTML = "You test the rope, and then carefully lower yourself into the <span>well</span>...";
                room13Switch();
                roomNum = 13;
                break;
            case roomNum === 10 && (inp("walk")||inp('go')||inp('travel'))   &&    (inp('south')||inp('down'))   :
                room12Switch();
                userInput.value = "";
                roomNum = 12;
                break;

            // SPECIAL CARE FOR ROOM 13
            case roomNum === 13 && inp("go")   &&    inp('up') :
                userInput.value = "";
                room10Switch();
                roomNum = 10;
                break;
            case roomNum === 13 && (inp("walk")||inp('go')||inp('travel'))   &&    (inp('up')||inp('forward')||inp('straight')||inp('north'))   :
                userInput.value = "";
                output.innerHTML = "There's nowhere to go!";
                break;
            
                    
            // DEFAULT TRAVEL
            case (inp("walk")||inp('go')||inp('travel')):
                userInput.value = "";
                output.innerHTML = "Where do you want to go?";
                break;

            // ROOM 1
            case roomNum === 1 &&    (inp('open')||inp('try')||inp('use'))    &&    (inp('door')||inp('handle')||inp("knob")) && doorUnlocked === false   :
                output.innerHTML = "The <span>door</span> is locked.";
                break;
            case roomNum === 1 &&    (inp('look')||inp('inspect'))   &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "It is twilight. The <span>door frame</span> is standing in a grassy clearing surrounded by trees and scattered <span>rocks</span> and <span>flowers</span>.<br><br>To the <span>north</span> and <span>east</span> the forest grows dark and dense. To the <span>south</span>, you can hear the distant sound of water. To the <span>northwest</span> you can see a rocky outcropping above the trees.";
                break;
            case roomNum === 1 &&    (inp('inspect')||inp('look')||inp('search')||inp('check')||inp('behind'))    &&    (inp('door')||inp('frame'))     :
                output.innerHTML = "The <span>door</span> is made of a dark wood, and it's <span>handle</span> and <span>lock</span> are iron. It's worn, but sturdy. Something tells you it's been hear a long time.<br><br>There's not much else around. Try walking in a <span>direction</span>";
                break;
            case roomNum === 1 &&    (inp('unlock')||inp('key'))   &&    (inp('door')||inp('handle'))   &&  doorUnlocked === false  && haveBoxKey === true :
                output.innerHTML = "You try to unlock the <span>door</span> with the <span>key</span> you found down by the lake... but it doesn't fit the lock...!<br><br>Now that you look closer, the <span>key</span> is shiny silver, but the lock on the <span>door</span> is a dull iron.<br><br>Maybe this <span>key</span> fits something else.";
                break;
            case roomNum === 1 &&    inp('unlock')   &&    (inp('door')||inp('handle'))   &&  doorUnlocked === false  :
                output.innerHTML = "You don't have the <span>key</span>. Maybe it's nearby?";
                break;
            case roomNum === 1 &&    (inp('look')||inp('inspect')||inp('try'))   &&    (inp('lock')||inp('handle')||inp('knob'))     :
                output.innerHTML = "The door's gnob and lock are simple and a bit rusty, but strong. You try to push it open, but it won't budge.";
                break;
            case roomNum === 1 &&    inp('knock') :
                output.innerHTML = "You knock on the door, but nothing happens.";
                break;
            case roomNum === 1 &&    (inp('who') && inp('there')) || inp('nok'):
                output.innerHTML = "Lol you thought.";
                break;
            case roomNum === 1 &&    (inp('inspect')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass, with scattered <span>rocks</span> and <span>flowers</span>.";
                break;

            // ROOM 3
            case roomNum === 3 &&    (inp('look')||inp('inspect'))   &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "The forest is a bit darker here. There is a <span>stump</span> in the middle of the clearing with an old discarded <span>notebook</span> alongside. The forest is too dense to travel any further east from here.";
                break;
            case roomNum === 3 &&    (inp('inspect')||inp('look')||inp('search')||inp('check'))    &&    (inp('stump'))   && foundBook === true  :
                output.innerHTML = "Looks like a good place to sit and rest. You wonder how long ago the tree was cut down, but you're stumped.";
                break;
            case roomNum === 3 &&    (inp('inspect')||inp('look')||inp('search')||inp('check'))    &&    (inp('book')||inp('journal')||inp('diary'))   && foundBook === true  :
                output.innerHTML = "The <span>journal</span> has a worn leather cover.<br><br>The pages inside are water damaged, but the hand-written ink is still legibled.<br><br>There's no title, and no author.";
                showBookButton("Read Journal?");
                readingAsk = true;
                break;
            case roomNum === 3 &&    inp('read')    &&    (inp('book')||inp('journal')||inp('diary'))   :
                output.innerHTML = "You pick up the <span>journal</span>."
                showBookButton("Read Journal?");
                readingAsk = true;
                break;
            case roomNum === 3 &&    (inp('inspect')||inp('look')||inp('search')||inp('check'))    &&    (inp('book')||inp('journal')||inp('diary'))   && foundBook === false  :
                output.innerHTML = "There's a <span>book</span> on the ground in front of the stump. It looks like somebody used this spot to sit and read or write.";
                showBookButton("Read Journal?");
                readingAsk = true;
                foundBook = true;
                break;
            case roomNum === 3 &&    (inp('inspect')||inp('look')||inp('search')||inp('check'))    &&    inp('stump')   && foundBook === false  :
                output.innerHTML = "There's a <span>book</span> on the ground in front of the stump. It looks like somebody used this spot to sit and read or write.";
                foundBook = true;
                break;
            case roomNum === 3 &&    (inp('take')||inp('grab')||inp('pocket'))    &&    (inp('book')||inp('journal')||inp('diary'))   :
                output.innerHTML = "The <span>book</span> seems rather personal. You decide to leave it here in case somebody comes back for it.";
                showBookButton("Read Journal?");
                readingAsk = true;
                foundBook = true;
                break;
            case roomNum === 3 &&    (inp('sit')||inp('rest'))     :
                output.innerHTML = "You sit down on the stump to rest for a minute. It's comfier than you would have thought.";
                break;
            case roomNum === 3 &&    (inp('inspect')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass, with scattered rocks and flowers.<br><br>There is a <span>old book</span> on the ground near the stump.";
                break;

            // ROOM 2
            case roomNum === 2 &&    (inp('look')||inp('inspect'))   &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "The forest is much denser and darker here, the the air is filled with <span>fireflies</span> that bathe the woods in a warm light.";
                break;
            case roomNum === 2 &&    (inp('inspect')||inp('look')||inp('search'))    &&    (inp('fire'))     :
                output.innerHTML = "You've never seen <span>fireflies</span> this bright before! They illuminate the whole forest.";
                break;
            case roomNum === 2 && (inp('box')||inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get'))   &&    inp('fire')  &&  boxUnlocked === true  && haveFireflies === false :
                output.innerHTML = 'You catch a <span>firefly</span>, and very carefully put it in the <span>box</span> and close the lid.<br><br>You catch another, and another... and pretty soon the <span>box</span> is full of <span>fireflies</span>!';
                removeItem("a <span>wooden box</span>");
                inventory.push("a <span>box of fireflies</span>");
                haveFireflies = true;
                break;
            case roomNum === 2 && (inp('box')||inp('chest')||inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get'))   &&    inp('fire')  &&  haveFireflies === true :
                output.innerHTML = 'The <span>box</span> is already full of <span>fireflies</span>!';
                break;
            case (roomNum === 2 || (roomNum === 7 && firefliesReleased === true)) && (inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get')||inp('grab'))   &&    inp('fire') && (inp('mug')||inp('cup')) && haveMug === true  :
                output.innerHTML = 'You catch a <span>firefly</span> and put it in the <span>mug</span>, but as soon as you take your hand away it flies away.<br><br>Maybe there is something else nearby you can keep the <span>fireflies</span> in.';
                break;
            case roomNum === 2 && (inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get')||inp('grab'))   &&    inp('fire')  && haveBox === false  :
                output.innerHTML = 'After a couple attempts, you catch a <span>firefly</span> in you hands. You cup it gently and its soft glow illuminates your fingers. After a few moments, you release it to join the others.<br><br>"If only I had somewhere to keep it," you think.';
                break;
            case roomNum === 2 && (inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get')||inp('grab'))   &&    inp('fire')  && haveBox === true  :
                output.innerHTML = 'After a couple attempts, you catch a <span>firefly</span> in you hands. You cup it gently and its soft glow illuminates your fingers. After a few moments, you release it to join the others.<br><br>"I bet I could keep some of them in this <span>box</span> if I get it open," you think.';
                break;
            case roomNum === 2 &&    (inp('inspect')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass with scattered rocks and such. You don't find anything of use.";
                break;

            // ROOM 4
            case roomNum === 4   && catDiscovered === false   &&    (inp('look')||inp('inspect'))   &&    (inp('forest')||inp('around')) :
                output.innerHTML = "A big tree stands in the middle of the glade.<br><br><span>Something</span> is rustling around up in the tree's branches...";
                break;
            case roomNum === 4    && marbleDown === false   &&    (inp('look')||inp('inspect'))   &&    (inp('forest')||inp('around'))  :
                output.innerHTML = "A big tree with a <span>cat</span> in it standing the middle of the glade.";
                break;
            case roomNum === 4 &&   marbleReunited === false &&   (inp('look')||inp('inspect'))   &&    (inp('forest')||inp('around'))   :
                output.innerHTML = "The black and white <span>cat</span> is playing with the <span>ribbon</span> under the big tree.";
                break;
            case roomNum === 4 &&    (inp('look')||inp('inspect'))   &&    (inp('forest')||inp('around'))   :
                output.innerHTML = "A big tree stands in the middle of the glade.";
                break;
            case roomNum === 4  &&   (inp('inspect')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass with scattered rocks and such. You don't find anything of use.";
                break;
            case roomNum === 4  && marbleDown === false && haveRibbon === true &&    (inp('play')||inp('cat')) && inp('ribbon') :
                catDiscovered = true;
                marbleDown = true;
                haveRibbon = false;
                removeItem()
                playMarbleCutscene();
                break;
            case roomNum === 4  && marbleDown === true && marbleReunited === false &&    (inp('play')||inp('cat')) && inp('ribbon') :
                output.innerHTML = "You grab the <span>ribbon</span> and wave it around for the <span>cat</span>. Is there anything better than this?";
                break;
            case roomNum === 4  && marbleDown === false && haveFlower === true  &&    (inp('play')||inp('cat') )  &&    inp('flower')   :
                catDiscovered = true;
                output.innerHTML = "You use the <span>flower</span> to try to get the <span>cat's</span> attention. It seems vaguely interested for a moment, but quickly loses interest.<br><br>Maybe you can find something it likes more to play with.";
                break;
            case roomNum === 4   && marbleDown === false  && haveRibbon === true   &&    inp('play')   &&    inp('cat')    :
                catDiscovered = true;
                output.innerHTML = "You try to get the attention of the <span>cat</span>, but it doesn't seem that interested in you.<br><br>Maybe you have <span>something</span> in your pockets it would like to play with...?";
                break;
            case roomNum === 4    && marbleDown === false   &&    inp('play')   &&    inp('cat')  :
                catDiscovered = true;
                output.innerHTML = "You try to get the attention of the <span>cat</span>, but it doesn't seem that interested in you.<br><br>Maybe you can find <span>something</span> to play with...";
                break;
            case roomNum === 4    && marbleDown === false && haveRope === true  &&    inp('rope')   &&    inp('cat')  :
                catDiscovered = true;
                output.innerHTML = "You toss the <span>rope</span> over a branch, but the <span>cat</span> doesn't seem interested.";
                break;
            case roomNum === 4 &&   marbleDown === false  && marbleReunited === false && inp('talk')   &&    inp('cat'):
                catDiscovered = true;
                output.innerHTML = "The <span>cat</span> doesn't really seem interested in talking.";
                break;
            case roomNum === 4   &&  marbleDown === false  && marbleReunited === false &&  (inp('inspect')||inp('look')||inp('search')||inp('check'))  && inp('cat')  :
                catDiscovered = true;
                output.innerHTML = "The <span>cat</span> eyes you casually. It's relaxing on one of the tallest branches of the tree. It seems perfectly content where it is.";
                break;
            case roomNum === 4   &&  marbleDown === true  && marbleReunited === false &&  (inp('inspect')||inp('look')||inp('search')||inp('check'))  && inp('cat')  :
                catDiscovered = true;
                output.innerHTML = "The black and white <span>cat</span> is preocuppied with the <span>red ribbon</span>.";
                break;
            case roomNum === 4  &&  marbleDown === false  && (inp('look')||inp('inspect')||inp('search')||inp('check'))   &&    (inp('tree')||inp('branch'))     :
                output.innerHTML = "You look up into the tree... There's a <span>cat</span> up there! ...it doesn't seem to want to come down.";
                catDiscovered = true;
                break;
            case roomNum === 4  && marbleDown === false   && catDiscovered === true   && inp('climb')  &&    inp('tree') :
                output.innerHTML = "You start to climb the tree, but the <span>cat</span> hisses and swipes a paw at you. Rude!";
                break;
            case roomNum === 4  && marbleDown === false  &&  inp('climb')  &&    inp('tree')  :
                output.innerHTML = "You start to climb the tree... but there's a <span>cat</span> in the tree! It hisses and swipes a paw at you. Rude!";
                catDiscovered = true;
                break;
            case roomNum === 4  && marbleDown === false &&  (inp('throw')||inp('toss')||inp('hit'))   ||    (inp('rock')||inp('pebble')||inp('stone')) && inp('cat')   :
                catDiscovered = true;
                output.innerHTML = "You throw a <span>rock</span> at the <span>cat</span> like the big jerk you are. The <span>cat</span> dodges out of the way and hisses, while the universe silently judges you.";
                break;
            case roomNum === 4  && marbleDown === false &&  (inp('throw')||inp('toss')||inp('hit'))   ||    (inp('stick')) && inp('branch')   :
                catDiscovered = true;
                output.innerHTML = "You throw a <span>stick</span> at the <span>cat</span> like the big jerk you are. The <span>cat</span> dodges out of the way and hisses, while the universe silently judges you.";
                break;
            case roomNum === 4  && marbleDown === false &&  (inp('pull')||inp('grab')||inp('hit')||inp('ask')||inp('lure')||inp('tease')||inp('take')) && inp('cat')   :
                catDiscovered = true;
                output.innerHTML = "The <span>cat</span> doesn't seem interested in cooperating.";
                break;
            case roomNum === 4  && marbleDown === false &&  inp('psp')   :
                catDiscovered = true;
                output.innerHTML = "The <span>cat</span> eyes you curiously.";
                break;
            case roomNum === 4  && marbleReunited === false &&  inp('psp')   :
                output.innerHTML = "Meow!!";
                break;

            // ROOM 5
            case roomNum === 5 &&    (inp('look')||inp('inspect'))   &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "The lakeshore is scattered with large <span>rocks</span>. The lake is wide, and disappears into fog on the horizon.";
                break;
            case roomNum === 5 &&    inp('look')   &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('stream')||inp('bank')) && haveBoxKey === false    :
                output.innerHTML = "The water is cool and clear, and a few fish drift lazily along.<br><br>You think you spy <span>something</span> shining under the water near the rocks.";
                break;
            case roomNum === 5 &&  haveBoxKey === false &&  (inp('search')||inp('inspect')||inp('look')||inp('check'))   &&    (inp('water')||inp('rock')||inp('stone')||inp('pebble')||inp("shore"))    :
                output.innerHTML = "You find a <span>key</span> in the rocks by the shore. You put the <span>key</span> in your <span>pocket</span>.";
                haveBoxKey = true;
                inventory.push("a <span>silver key</span>");
                break;
            case roomNum === 5 &&    inp('look')   &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('stream')||inp('bank'))     :
                output.innerHTML = "The water is cool and clear, and a few fish drift lazily along.";
                break;
            case roomNum === 5 &&    (inp('inspect')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass, with scattered <span>rocks</span> and <span>flowers</span>.";
                break;

            // ROOM 6
            case roomNum === 6 &&  (inp('fix')||inp('repair')||inp('mend')||inp('patch'))   &&    (inp('boat'))     :
                output.innerHTML = "The <span>boat</span> seems way too buested up to fix with what's available.";
                break;
            case roomNum === 6 &&  (inp('get')||inp('in')||inp('take')||inp('ride'))   &&    (inp('boat'))     :
                output.innerHTML = "The <span>boat</span> is in too poor condition to take anywhere.<br><br>It looks like there's <span>something</span> in the bottom of it though...";
                break;
            case roomNum === 6 &&  ropeTaken === false &&  (inp('look')||inp('inspect'))   &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "You're standing on the shore of a lake. There is a <span>boat</span> tied to a mooring nearby, but it doesn't exactly look seaworthy.";
                break;
            case roomNum === 6 &&   ropeTaken === false &&   haveBox === false  &&  (inp('look')||inp('inspect')||inp('search')||inp('check'))   &&    (inp('boat')||inp('moor'))     :
                output.innerHTML = "The <span>boat</span> is half-sunk and looks ancient. The wood on the bottom is almost completely rotted through, and the paddles are nowhere to be seen. It's tied to the shore with a thick <span>rope</span>.<br><br>You look into the bottom of the boat and find an <span>locked wooden box</span>.<br><br>You put the <span>box</span> in your <span>pocket</span>.";
                haveBox = true;
                inventory.push("a <span>wooden box</span>");
                break;
            case roomNum === 6 &&   ropeTaken === false &&    (inp('look')||inp('inspect')||inp('search')||inp('check'))   &&    (inp('boat')||inp('moor'))     :
                output.innerHTML = "The boat is half-sunk and looks ancient. The wood on the bottom is almost completely rotted through, and the paddles are nowhere to be seen. It's tied to the shore with a thick <span>rope</span>.";
                break;
            case roomNum === 6 &&   ropeTaken === false &&    (inp('look')||inp('inspect')||inp('search')||inp('check'))   &&    (inp('rope'))     :
                output.innerHTML = "The <span>rope</span> seems to be the only thing about the boat that is still in decent condition.";
                break;
            case roomNum === 6 &&  (inp('look')||inp('inspect'))   &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "You're standing on the shore of a lovely lake. The boat is still siting half-sunk near the shore.";
                break;
            case roomNum === 6 &&  (inp('look')||inp('inspect')||inp('search')||inp('check'))   &&    (inp('boat')||inp('moor'))  && haveBox === false   :
                output.innerHTML = "The boat is half-sunk and looks ancient. The wood on the bottom is almost completely rotted through, and the paddles are nowhere to be seen.<br><br>You look into the bottom of the boat and find an old wooden <span>box</span> with a <span>silver lock</span>.<br><br>You put the <span>box</span> in your <span>pocket</span>.";
                haveBox = true;
                inventory.push("a <span>wooden box</span>");
                break;
            case roomNum === 6 &&  (inp('look')||inp('inspect')||inp('search')||inp('check'))   &&    (inp('boat')||inp('moor'))  && haveBox === true   :
                output.innerHTML = "The boat is half-sunk and looks ancient. The wood on the bottom is almost completely rotted through, and the paddles are nowhere to be seen.";
                break;
            case roomNum === 6 &&  (inp('look')||inp('inspect')||inp('search')||inp('check'))   &&    (inp('rope'))     :
                output.innerHTML = "The <span>rope</span> is gone. You took it, remember?";
                break;
            case roomNum === 6 &&   ropeTaken === true && (inp('take')||inp('grab')||inp('pocket')||inp('get'))   &&    (inp('rope'))     :
                output.innerHTML = "You already took the <span>rope.</span>";
                break;    
            case roomNum === 6 &&    (inp('take')||inp('grab')||inp('pocket')||inp('untie')||inp('remove')||inp('get'))   &&    (inp('rope'))     :
                haveRope = true;
                ropeTaken = true;
                inventory.push("a <span>rope</span>")
                room6Switch();
                output.innerHTML = "You untie the <span>rope</span> and put it in your <span>pocket</span>.";
                break;
            case roomNum === 6 &&    (inp('inspect')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass with scattered rocks and such. A <span>rope</span> ties the boat to the shore.";
                break;
            case roomNum === 6 &&  (inp('use') && inp('rope')):
                output.innerHTML = "The <span>rope</span> rope is tied to the <span>boat</span>. You don't see much use for it here, but maybe you can use it elsewhere.";
                break;

            // ROOM 7
            case roomNum === 7 &&  (inp('look'))   &&    (inp('cave')||inp('around')) && firefliesReleased === false :
                output.innerHTML = "The air feels different here... but it's too dark to see anything...";
                break;
            case roomNum === 7 &&  (inp('inspect')||inp('search')||inp('check')||inp('look'))   &&    (inp('cave')||inp('around')) && firefliesReleased === false :
                output.innerHTML = "You feel your way around the <span>cave</span>. The ground is rocky and the walls smooth. It's much too dark to see anything...<br><br>You smash your shins against something hard a few times before abandoning your search.";
                break;
            case roomNum === 7 &&  (inp('look'))   &&    (inp('cave')||inp('around')) && firefliesReleased === true :
                output.innerHTML = "The cave is full of glowing <span>crystals</span>! The light from the <span>fireflies</span> catches every surface and facet of the magnificent gems.<br><br>There is another passageway leading <span>west</span>.";
                break;
            case roomNum === 7 &&  (inp('inspect')||inp('search')||inp('check'))   &&    (inp('cave')||inp('around')) && firefliesReleased === true :
                output.innerHTML = "The cave is full of magnificent glowing <span>crystals</span> protruding from the walls and littering the ground.<br><br>There is another passageway leading <span>west</span>";
                break;
            case roomNum === 7 &&  (inp('inspect')||inp('search')||inp('check')||inp('look'))   &&    (inp('crystal')||inp('gem')||inp('diamonds')) && firefliesReleased === true :
                output.innerHTML = "There are abudnances of <span>crystals</span> in every corner of the cave.";
                break;
            case roomNum === 7 &&  inp('stala') && firefliesReleased === true :
                output.innerHTML = "The cave is full of dripping stalactites and stalagmites. You used to have a hard time telling them apart, until you learned this helpful mnemonic device:<br><br>'Satactites' hang TIGHT from the ceiling, but be careful of stalagmites: you MIGHT trip over them!";
                break;
            case (roomNum === 7 || roomNum === 8) &&  (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab'))  && (inp('crystal')||inp('gem')||inp('diamonds')) && firefliesReleased === true :
                output.innerHTML = "You pick up a small piece of <span>crystal</span> off the ground. It's surprisingly warm in your hand, and seems to magnify the light from the <span>fireflies</span>.<br><br>You put the <span>crystal</span>in your <span>pocket</span>.";
                inventory.push("a strange crystal");
                haveCrystal = true;
                break;
            case (roomNum === 7 || roomNum === 8) &&  (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab'))  && (inp('crystal')||inp('gem')||inp('diamonds')) && firefliesReleased === true  && haveCrystal === true  :
                output.innerHTML = "You already have a <span>crystal</span> in your <span>pocket</span>.";
                break;
            case roomNum === 7 && firefliesReleased===true && (inp('box')||inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get'))   &&    inp('fire')  &&  boxUnlocked === true  && haveFireflies === false :
                output.innerHTML = 'You catch a <span>firefly</span>, and very carefully put it in the <span>box</span> and close the lid.<br><br>You catch another, and another... and pretty soon the <span>box</span> is full of <span>fireflies</span>!';
                removeItem("a <span>wooden box</span>");
                inventory.push("a <span>box of fireflies</span>");
                haveFireflies = true;
                break;
            case roomNum === 7 &&  firefliesReleased===true &&  (inp('inspect')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The cave floor is a rough stone, and covered in stalagmites and <span>crystals</span>";
                break;
            case roomNum === 7 &&    (inp('inspect')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "It's too dark to see anything.";
                break;
            case roomNum === 7 &&  (inp('exit')||inp('leave'))   &&    (inp('cave')) :
                room11Switch();
                roomNum = 11;
                userInput.value = "";
                break;

            // ROOM 9
            case roomNum === 9 && ghostDiscovered === false   &&  (inp('look')||inp('inspect')||inp('search')||inp('check')||inp('take')||inp('grab')||inp('pocket')||inp('eat'))   &&    (inp('mushroom')||inp('circle'))  :
                ghostDiscovered = true;
                playGhostCutscene();
                break;
            case roomNum === 9 && ghostDiscovered === true  && ghostGivenMug === false  &&  (inp('search')||inp('take')||inp('grab')||inp('pocket')||inp('eat'))   &&    (inp('mushroom')||inp('circle'))  :
                output.innerHTML = 'You take a step towards the mushrooms, but the <span>ghostly figure</span> gives you an icy stare that freezes you in your tracks.<br><br>A voice whispers...<br><br><span class="journal">"Moon... cactus...</span>"<br><br>What could that mean?';
                break;
            case roomNum === 9 && ghostDiscovered === true  &&  (inp('look')||inp('inspect')||inp('check'))   &&    (inp('mushroom')||inp('circle')) :
                output.innerHTML = 'The <span>mushrooms</span> are red with white spots. You can\'t decide whether they look delicious, or deadly.';
                break;
            case roomNum === 9 && ghostDiscovered === true && mugTaken === false  &&  (inp('talk')||inp('chat')||inp('ask')||inp('question'))  &&    (inp('ghost')||inp('figure')) :
                output.innerHTML = 'A voice whispers...<br><br><span class="journal">"Moon... cactus...</span>"<br><br>What could that mean?';
                break;
            case roomNum === 9 && ghostDiscovered === true && mugTaken === false  &&  (inp('flirt')||inp('compliment')||inp('flatter'))  &&    (inp('ghost')||inp('figure')) :
                output.innerHTML = 'You sly dog.<br><br>The <span>ghost</span> seems to blush... or maybe it\'s just a trick of the light.';
                break;
            case roomNum === 9 && ghostDiscovered === true && mugTaken === false  &&  (inp('boo')  ||  ((inp('scare')||inp('frighten')||inp('shoo'))  &&    (inp('ghost')||inp('figure')))) :
                output.innerHTML = 'The <span>ghost</span> doesn\'t seem scared of you...';
                break;
            case roomNum === 9 && ghostDiscovered === true && mugTaken === false &&  (inp('touch')||inp('hit')||inp('push')||inp('move')||inp('punch'))  &&    (inp('ghost')||inp('figure'))  :
                output.innerHTML = 'The <span>ghost</span> doesn\'t look solid, and besdies, it\'s kind of freaking you out... there\'s no way you\'re getting close enough to do that.';
                break;
            case roomNum === 9  && (ghostDiscovered === false || mugTaken===true)  &&  (inp('look')||inp('inspect'))   &&    (inp('forest')||inp('around'))  :
                output.innerHTML = "This must be the oldest part of the forest. The trees here look like they haven't seen sunlight in years.<br><br>There is a circle of <span>mushrooms</span> in the middle of the hollow.";
                break;
            case roomNum === 9 &&  (inp('look')||inp('inspect'))   &&    (inp('forest')||inp('around'))   :
                output.innerHTML = "There is a <span>ghostly figure</span> hovering in a circle of mushrooms<br><br>This must be the oldest part of the forest. The trees here look like they haven't seen sunlight in years.";
                break;
            
            // ROOM 10
            case roomNum === 10 &&  (inp('look')||inp('inspect'))   &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "There's a stone <span>well</span> in the middle of the clearing.";
                break;
            case roomNum === 10 &&  (inp('look')||inp('inspect')||inp('search')||inp('check'))   &&    (inp('well'))     :
                output.innerHTML = "The <span>well</span> looks out and out of use. You look around for a bucket, but don't find anything.<br><br>You peer down into it, but it's too deep to see the bottom.";
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('rock')    :
                output.innerHTML = "You drop a rock into the <span>well</span>. It clatters off the walls for a few seconds before falling silent.<br><br>No splash... it must be dry.";
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('stick')    :
                output.innerHTML = "You throw a stick into the <span>well</span>. It clatters off the walls for a few seconds before falling silent.<br><br>No splash... it must be dry.";
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  (inp('money')||inp('coin')||inp('penny')||inp('quarter')||inp('dime')||inp('nickel')) :
                output.innerHTML = "You search your <span>pockets</span> for a coin to throw in the well, but no luck.";
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('flower')  && haveFlower === true   :
                output.innerHTML = "You drop a <span>flower</span> into the <span>well</span>. It drifts lazily down into the darkness until you lose sight of it.";
                haveFlower = false;
                removeItem("a <span>blue flower</span>");
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('flower')  && haveFlower === false   :
                output.innerHTML = "You don't have a <span>flower</span> to drop!";
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('crystal') && haveCrystal === true   :
                output.innerHTML = "You throw the <span>crystal</span> down the <span>well</span>. It hits the side and breaks apart before falling out of sight.";
                removeItem("a strange crystal");
                haveCrystal = false;
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('mug') && haveMug === true   :
                output.innerHTML = "You just brought the <span>mug</span> up!";
                break;
            case roomNum === 10 &&  (inp('jump')||inp('fall'))   &&    (inp('well'))     :
                output.innerHTML = "For a moment you imagine jumping into the <span>well</span>... What's that old phrase? \"L'appel du vide...\"<br><br>You decide to keep your feet on the ground.";
                break;
            case roomNum === 10 &&  inp('use') &&   inp('well')  && ropeSet === false :
                output.innerHTML = "The <span>well</span> doesn't have a bucket or rope.";
                break;
            case roomNum === 10 &&  (inp('climb')||inp('use')) && (inp('down')||inp('well')||inp('rope'))  && ropeSet === true :
                output.innerHTML = "You test the rope, and then carefully lower yourself into the <span>well</span>...";
                room13Switch();
                roomNum = 13;
                break;
            case roomNum === 10 &&  (inp('climb')||inp('use')) &&   (inp('well')||inp('down')||inp('rope'))  && ropeSet === false :
                output.innerHTML = "You consider trying to climb down the <span>well</span>, but the walls are slippery and you're not sure if you'd be able to get back up again...";
                break;
            case roomNum === 10 &&  (inp('use')||inp('tie')||inp('attach')||inp('set')||inp('throw')||inp('drop')||inp('toss'))   &&    (inp('rope'))   &&  haveRope === true  :
                ropeSet = true;
                haveRope = false;
                removeItem("a <span>rope</span>");
                room10Switch();
                output.innerHTML = "You tie the <span>rope</span> to the top of the <span>well</span>. It seems pretty secure... fingers crossed!";
                break;
            case roomNum === 10 &&  ropeSet === true &&  (inp('take')||inp('grab')||inp('pocket')||inp('untie')||inp('remove')||inp('get'))   &&    (inp('rope'))     :
                output.innerHTML = "You untie the <span>rope</span> and put it in your <span>pocket</span>.";
                haveRope = true;
                ropeSet = false;
                inventory.push("a <span>rope</span>");
                room10Switch();
                break;
            case roomNum === 10 && inp('wish') :
                output.innerHTML = "You make a wish.... but it's secret!";
                break;
            case roomNum === 10 &&    (inp('inspect')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass with scattered rocks and such. You don't find anything of use.";
                break;
            
            // ROOM 11
            case roomNum === 11 &&  (inp('look')||inp('inspect')||inp('search'))   &&    (inp('forest')||inp('around')) :
                output.innerHTML = "There's a large entrance to a <span>cave</span> to the <span>north</span>. It looks pretty dark inside...";
                break;
            case roomNum === 11 &&  (inp('look')||inp('inspect')||inp('search')||inp('check'))   &&    (inp('cave')) :
                output.innerHTML = "The <span>cave</span> is so dark you can hardly see past the threshold...";
                break;
            case roomNum === 11 &&  (inp('go')||inp('enter')||inp('explore'))   &&    (inp('cave')||inp('rocks')) :
                room7Switch();
                roomNum = 7;
                userInput.value = "";
                break;
            case roomNum === 11 &&    (inp('inspect')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass with scattered rocks and such. You don't find anything of use.";
                break;

            // ROOM 13
            case roomNum === 13 &&  (inp('look')||inp('inspect')||inp('search')||inp('check'))   &&    (inp('well')||inp('around')||inp('ground')||inp('floor')||inp('dirt'))  && mugTaken === false  :
                output.innerHTML = "It's dark... there's just enough light to see around you. The ground is dry and littered with rocks and grass and... what's this? A <span>mug</span>?";
                break;
            case roomNum === 13 &&  (inp('look')||inp('inspect')||inp('search')||inp('check'))   &&    (inp('well')||inp('around')||inp('ground')||inp('floor')||inp('dirt'))  && mugTaken === true  :
                output.innerHTML = "It's dark... there's just enough light to see around you. The ground is dry and littered with rocks and grass. You can see the spot in the ground where the <span>mug</span> used to be.";
                break;
            case roomNum === 13 &&  (inp('look')||inp('inspect'))   &&    (inp('mug'))  && mugTaken === false   :
                output.innerHTML = "The <span>mug</span> is lying in the darkness of the well. It looks like there is a desert scene painted on it... Somebody must have dropped it down here.";
                break;
            case roomNum === 13 &&  (inp('take')||inp('grab')||inp('pocket')||inp('get'))   &&    (inp('mug'))  && mugTaken === false   :
                haveMug =true;
                mugTaken = true;
                inventory.push("an <span>old mug</span>");
                room13Switch();
                output.innerHTML = "You put the <span>mug</span> in your <span>pocket</span>.";
                break;
            case roomNum === 13 &&  (inp('take')||inp('grab')||inp('pocket')||inp('get'))   &&    (inp('mug'))  && mugTaken === true   :
                output.innerHTML = "You already took the <span>mug</span>.";
                break;
            case roomNum === 13 &&  (inp('climb')||inp('go')) && (inp('up')||inp('rope')) :
                room10Switch();
                roomNum = 10;
                break;

            // RELEASE FIREFLIES
            case roomNum === 2 && haveFireflies=== true && (inp('release')||inp('open'))   &&    (inp('box')||inp('chest')||inp('fireflies'))  :
                output.innerHTML = 'You release the <span>fireflies</span> into the air. They linger for a moment before rejoining their friends.';
                haveFireflies = false;
                removeItem("a <span>box of fireflies</span>");
                inventory.push("a <span>wooden box</span>");
                break;
            case roomNum !== 7 && haveFireflies=== true && (inp('release')||inp('open'))   &&    (inp('box')||inp('chest')||inp('fireflies'))  :
                output.innerHTML = 'You release the <span>fireflies</span> into the air. They linger for a moment, glimmering quietly, before floating up and away.<br><br>"Maybe they\'re going back to join their friends", you think.';
                haveFireflies = false;
                removeItem("a <span>box of fireflies</span>");
                inventory.push("a <span>wooden box</span>");
                break;
            case roomNum === 7 && haveFireflies=== true && (inp('release')||inp('open'))   &&    (inp('box')||inp('chest')||inp('fireflies'))  :
                firefliesReleased = true;
                haveFireflies = false;
                document.getElementById("room7").src="./roomimages/smfmroom7a.png";
                removeItem("a <span>box of fireflies</span>");
                inventory.push("a <span>wooden box</span>");
                room7Switch();
                output.innerHTML = 'You open the <span>box</span>, and the <span>fireflies</span> fill the cave with a brilliant light!';
                break;

            // INTERACT WITH WATER
            case (roomNum === 5 || roomNum === 6 || roomNum === 12) &&    (inp('look')||inp('inspect')||inp('search')||inp('check'))   &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('stream')||inp('bank')||inp('shore'))     :
                output.innerHTML = "The water is cool and clear, and a few fish drift lazily along. You search around the banks, but don't find anything particularly useful.";
                break;
            case (roomNum === 5 || roomNum === 6 || roomNum === 12) &&    (inp('swim')||inp('dive')||inp('jump'))   &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('stream')||inp('bank'))     :
                output.innerHTML = "You didn't bring a swim suit! The water seems cold anyway.";
                break;
            case (roomNum === 5 || roomNum === 6 || roomNum === 12) &&    (inp('catch')||inp('grab')||inp('take')||inp('lure')||inp('get'))   &&    (inp('fish'))     :
                output.innerHTML = "You try to catch a fish, but they are way too fast! They probably prefer the water anyway.";
                break;
            case (roomNum === 5 || roomNum === 6 || roomNum === 12) &&    (inp('skip')||inp('throw')||inp('toss'))   &&    (inp('rock')||inp('pebble')||inp('stone'))     :
                output.innerHTML = "You throw a rock out across the water. It skips across the surface a few times before sinking with a 'plop', and you watch the ripples play off each other on the glassy surface.";
                break;
            case (roomNum === 5 || roomNum === 6 || roomNum === 12 || roomNum === 8) &&    (inp('drink')||inp('sip'))   &&    (inp('water')||inp('lake'))  && haveMug === true   :
                output.innerHTML = "You fill the <span>mug</span> with water from the lake and take a sip. It tastes clean and refreshing.";
                break;
            case (roomNum === 5 || roomNum === 6 || roomNum === 12 || roomNum === 8) &&    (inp('drink')||inp('sip'))   &&    (inp('water')||inp('lake'))  :
                output.innerHTML = "You cup your hands into the lake and take a sip. The water is clean and refreshing.";
                break;
            
            // INTERACT WITH TREES
            case (inp('take')||inp('grab')||inp('pocket'))  && inp('tree')   :
                output.innerHTML = "Your <span>pockets</span> aren't that big!";
                break;
            case ((roomNum === 7 || roomNum === 8 || roomNum === 13))  &&    (inp('tree'))     :
                output.innerHTML = "There aren't any trees around here.";
                break;
            case inp('climb')  &&    (inp('tree')||inp('branch'))  && (roomNum === 9)  :
                output.innerHTML = "These trees look much too and the branches too weak to climb.";
                break;
            case (roomNum === 9)  &&    (inp('tree')||inp('branch'))   &&   (inp('look')||inp('inspect')||inp(''))  :
                output.innerHTML = "The trees here look ancient. You get the feeling this is a very old part of the forest.";
                break;
            case ((roomNum !== 4) || marbleDown === true) &&   (inp('look')||inp('inspect')||inp('search')||inp('check')||inp('behind'))   &&    (inp('tree')||inp('branch'))     :
                output.innerHTML = "You search around the trees, but don't find anything.";
                break;
            case roomNum !== 8 && roomNum !== 7 && roomNum !== 13 &&  inp('rope')   &&  inp('tree') && haveRope === true :
                output.innerHTML = "The <span>trees</span> look easy enough to climb without the <span>rope</span>, so you don't see much use in that.";
                break;

            // CLIMB TREES
            case inp('climb')  &&    (inp('tree')||inp('branch'))   :
                output.innerHTML = "You carefully climb up the nearest tree. The branches are thin near the top, so you find a sturdy perch and look out over the forest. There's a lake to the <span>south</span>, and some stony outcroppings to the <span>north west</span>. Beyond that the forest extends far into the distance.<br><br>You enjoy the view for a minute, then climb down.";
                break;

            // GET FLOWER
            case (roomNum === 1 || roomNum === 3 || roomNum === 5)   &&    (inp('look')||inp('inspect')||inp('search')||inp('check'))   &&    (inp('flower'))     :
                output.innerHTML = "You look at the flowers. Nice :)";
                break;
            case (roomNum === 1 || roomNum === 3 || roomNum === 5)   &&    (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab')||inp('put'))   &&    (inp('flower'))  && haveFlower === false   :
                output.innerHTML = 'You pick one of the <span>blue flowers</span> and carefully put it in your <span>pocket</span>.<br><br>Maybe it will be useful later?';
                haveFlower = true;
                inventory.push("a <span>blue flower</span>");
                break;
            case (roomNum === 1 || roomNum === 3 || roomNum === 5)   &&    (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab')||inp('put'))   &&    (inp('flower'))  && haveFlower === true   :
                output.innerHTML = 'You already have a <span>flower</span> in your <span>pocket</span>!';
                break;
            case (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get'))   &&    (inp('flower')) :
                output.innerHTML = "There aren't any flowers around here.";
                break;

            // INTERACT WITH ROCKS
            case (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab')||inp('put'))   &&    (inp('rock')||inp('stone')||inp('pebble'))  && haveRock=== true  :
                output.innerHTML = "You already have a <span>rock</span> in your <span>pocket</span>.<br><br>You can check your pockets by tpying <span>pockets</span> or <span>inventory</span>.";
                break;
            case (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab')||inp('put'))   &&    (inp('rock')||inp('stone')||inp('pebble'))    :
                output.innerHTML = "There's an art to <span>rock</span> collecting. You find a nice one and put it in your <span>pocket</span>.";
                inventory.push("a <span>rock</span>")
                haveRock = true;
                break;
            case (inp('under')||inp('search')||inp('check'))   &&    (inp('rock')||inp('stone')||inp('pebble'))    :
                output.innerHTML = "You search under some of the rocks, but don't find anything other than some very confused bugs.";
                break;
            case (inp('inspect')||inp('look')||inp('check'))   &&    (inp('rock')||inp('stone')||inp('pebble'))    :
                output.innerHTML = "You look at the rocks. They look rocky.";
                break;
            case inp('eat')  &&    (inp('rock')||inp('stone')||inp('pebble'))    :
                output.innerHTML = "...";
                break;

            // INTERACT WITH GRASS
            case (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get'))   &&    inp('grass')    :
                output.innerHTML = "There's plenty of that around. You probably won't need to take it with you.";
                break;
            case (inp('search')||inp('inspect')||inp('look')||inp('check'))   &&    inp('grass')    :
                output.innerHTML = "You search the grass, but don't find anything.";
                break;
            case inp('touch')  &&    inp('grass')    :
                output.innerHTML = "You touch the grass. Feels good, not gonna lie.";
                break;
            case (inp('lie')||inp('lay'))  &&    inp('grass')    :
                output.innerHTML = "You lie down on the grass and watch the clouds float gently above you. It's comfy, but after a while starts to get a bit itchy. Makes you wish you'd brought a blanket.";
                break;
            case inp('smoke')  &&    inp('grass')    :
                output.innerHTML = "-_-";
                break;
            case inp('eat')  &&    inp('grass')    :
                output.innerHTML = "...why??";
                break;
            
            // STICKS
            case roomNum !== 7 && roomNum !== 8 && roomNum !== 13 && inp('stick') && (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')) :
                output.innerHTML = "There are plenty of sticks around, so there's no need to take one with you.";
                break;

            // BUSHES
            case roomNum !== 7 && roomNum !== 8 && roomNum !== 13 && inp('bush') && (inp('search')||inp('inspect')||inp('look')||inp('check')) :
                output.innerHTML = "You search the bushes, but don't find anything.";
                break;
            case  inp('bush') && (inp('search')||inp('inspect')||inp('look')||inp('check')) :
                output.innerHTML = "There aren't any bushes around here.";
                break;
            case  inp('aim') && inp("for") && inp('bush') :
                output.innerHTML = "You thinkin what I'm thinkin?";
                break;

            // DIG
            case inp('dig'):
            output.innerHTML = "You don't have anything to dig with, and you're not sure what you'd be looking for anyway.";
                break;

            // UNLOCK / INTERACT WITH THE BOX IN INVENTORY
            case (inp('unlock')||inp('open')||inp('key'))   &&    (inp('box')||inp('chest'))  && haveBox === true && haveBoxKey === true && boxUnlocked === false   :
                output.innerHTML = "The <span>box</span> opens with a satisfying click.<br><br>Inside the <span>box</span> you find a <span>red ribbon</span>. You put the <span>ribbon</span> in your <span>pocket</span>.";
                boxUnlocked = true;
                haveRibbon = true;
                inventory.push("a <span>red ribbon</span>");
                if (checkingInventory === true) {
                    displayInventory();
                }
                break;
            case (inp('unlock')||inp('open')||inp('key'))   &&    (inp('box')||inp('chest'))  && haveBox === true && haveBoxKey === false  :
                output.innerHTML = "The <span>box</span> is securely locked, and you don't have a <span>key</span>." ;
                break;
            case (inp('shake')||inp('rattle'))   &&    (inp('box')||inp('chest'))  && haveBox === true && boxUnlocked === false  :
                output.innerHTML = "You shake the box <span>box</span>. There's <span>something</span> light and soft inside it." ;
                break;
            case (inp('look')||inp('inspect')||inp('check')||inp('search'))   &&    (inp('box')||inp('chest'))  && haveBox === true && haveFireflies === false  :
                output.innerHTML = "The <span>box</span> is made of hard wood and reinforced with metal banding and a silver lock." ;
                break;
            case (inp('look')||inp('inspect')||inp('check')||inp('search'))   &&    (inp('box')||inp('chest'))  && haveBox === true && haveFireflies === true  :
                output.innerHTML = "The <span>box</span> is made of hard wood and reinforced with metal banding and a silver lock. You can see the glow from the <span>fireflies</span> through the crack in the lid." ;
                break;
            case (inp('hit')||inp('break')||inp('smash')||inp('rock'))   &&    (inp('box')||inp('chest'))  && haveBox === true   :
                output.innerHTML = "You hit the <span>box</span> a few times, but only succeed in denting the carved wood surface." ;
                break;

            // INTERACT WITH OTHER ITEMS IN INVENTORY
            case (inp('inspect')||inp('look')||inp('check'))   &&    inp('key')  && haveBoxKey === true  :
                output.innerHTML = "The <span>key</span> is shiny silver and about the size of your pinky finger.";
                if (checkingInventory === true) {
                    displayInventory();
                }
                break;
            case (inp('inspect')||inp('look')||inp('check'))   &&    inp('ribbon')  && haveRibbon === true  :
                output.innerHTML = "The <span>ribbon</span> is made of vibrant red silk and about two feet long. It may have been a hair tie at one point.";
                if (checkingInventory === true) {
                    displayInventory();
                }
                break;
            case inp('hair')  &&  inp('tie') && inp('ribbon')  && haveRibbon === true  :
                output.innerHTML = "You tie the <span>ribbon</span> in you hair. Nice :)";
                break;
            case (inp('inspect')||inp('look')||inp('check'))   &&    (inp('mug')||inp('cup'))  && haveMug === true  :
                output.innerHTML = "The <span>mug</span> is dark blue and decorated with a picture of a cactus and crescent moon.";
                if (checkingInventory === true) {
                    displayInventory();
                }
                break;
            case (inp('inspect')||inp('look')||inp('check'))   &&    (inp('crystal')||inp('gem'))  && haveCrystal === true  :
                output.innerHTML = "The piece of <span>crystal</span> is about the size of your hand and soft pink in color. It feels oddly warm.";
                if (checkingInventory === true) {
                    displayInventory();
                }
                break;
            case (inp('toss')||inp('throw')||inp('drop'))   &&  (   ((inp('mug') && haveMug === true ))   ||   ((inp('crystal') && haveCrystal === true ))   ||  ( (inp('mushroom') && haveMushy === true))   ||   (inp('ribbon')  && haveRibbon === true)     ||   ( inp('key') && haveBoxKey === true)     )  :
                output.innerHTML = "I should probably keep this with me.";
                break; 

            // EXTRA INPUT IF JUST "POCKETS"
            case inp('pockets') :
                userInput.value = "";
                output.innerHTML = checkInventory();
                displayInventory();
                break;

            // CLEARING INVENTORY
            case inp('') && checkingInventory === true:
                checkingInventory = false;
                output.innerHTML = "";
                break;

            // CLEARING MAP
            case inp('') && checkingMap === true:
                output.innerHTML = "";
                checkingMap = false;
                break;

            
        // DEFAULT
            default:
                output.innerHTML = "Nothing happened.";
                checkingInventory = false;
                checkingMap = false;
                break;
        };

        // INCREASE "THINGS TRIED"
        thingsTried++;

        // CLEAR INPUT FORM
        userInput.value = "";
        currentPage = 0;
        outputarea.scroll(0,0);
    }

// PRESSING ENTER 
    const pressEnter = () => {
        let fem = document.getElementById('userinput').value;
        if ((reading === true || readingAsk === true) && (fem ==""||inp("read"))) {
            showBookText();
            //document.getElementById("book").src="./inventoryimages/book.png";
        } else {
            processInput();
            reading = false;
            document.getElementById("book").src="";
            document.getElementById('map').classList.remove('blurless');
        };
        checkingInventory = false;
        checkingMap = false;
    }

    enterButton.addEventListener('click', pressEnter);

    // from https://www.w3schools.com/howto/tryit.asp?filename=tryhow_js_trigger_button_enter
    var input = document.getElementById("userinput");
    input.addEventListener("keypress",
    function(event) {
        if (event.key === "Enter") {
            event.preventDefault();
            document.getElementById("enterbutton").click();
            // outputarea.scroll(0,0);
            // hideMobileKeyboardOnReturn(input);
        }
    });

        // // hacky keyboard hide when soft keyboard "enter" is pressed, via https://andy-carter.com/blog/how-to-close-the-mobile-keyboard-on-return
        // const hideMobileKeyboardOnReturn = (element) => {
        //     element.addEventListener('keyup', (keyboardEvent) => {
        //         const key = keyboardEvent.code || keyboardEvent.keyCode;
        //         if (key === 'Enter' || key === 13) {
        //             element.blur();
        //         }
        //      });
        // };

</script>



</html>