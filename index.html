<!DOCTYPE html>
<html lang="en">

<!-- HEAD-->
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Magic Forest Machine</title>
    <link rel="stylesheet" href="styles.CSS">
    <style> @import url('https://fonts.googleapis.com/css2?family=DotGothic16&family=Press+Start+2P&display=swap'); </style>
    
    <!-- TRYING TO DISABLE PULL-DOWN REFRESH -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/inobounce/0.2.0/inobounce.js"></script>

</head>
<body>


<!-- THE MACHINE -->

<img id="titlecard" src="./extraimages/titlecard.png" onclick="makeFadeAway()">

<div id="cutsceneviewer">
    <video poster="./cutscenes/loadingleaf.gif"  id="cutscene" autoplay="autoplay" muted playsinline>
        <source src="" type="video/mp4" control="none">
    </video>
</div>

<article id="themachine">
    
    <!-- VIEWER -->
    <div class="viewbox">

        <!-- border 1 -->
        <img class="border1" src="./roomimages/border 1.png">

        <div class="viewer">

            <!-- black background -->
            <div id="blackbackground"></div>
            <!-- navigation arrows -->
            <img id= "introarrow" src="./roomimages/introarrow.png">
            <img class="compasstriangles" id="northtriangle" src="./compasstriangles/north.png" onclick="goNorth()"><img class="compasstriangles" id="westtriangle" src="./compasstriangles/west.png" onclick="goWest()"><img class="compasstriangles" id="southtriangle" src="./compasstriangles/south.png" onclick="goSouth()"><img class="compasstriangles" id="easttriangle" src="./compasstriangles/east.png" onclick="goEast();">
            <!-- main viewer -->
            <div id= "map">
                <img class="room" id="room1" src="./roomimages/smfmroom1.png"><img class="room" id="room2" src="./roomimages/smfmroom2.png"><img class="room" id="room3" src="./roomimages/smfmroom3.png"><img class="room" id="room4" src="./roomimages/smfmroom4a.png"><img class="room" id="room5" src="./roomimages/smfmroom5.png"><img class="room" id="room6" src="./roomimages/smfmroom6a.png"><img class="room" id="room7" src="./roomimages/smfmroom7a.png"><img class="room" id="room8" src="./roomimages/smfmroom8.png"><img class="room" id="room9" src="./roomimages/smfmroom9b.png"><img class="room" id="room10" src="./roomimages/smfmroom10a.png"><img class="room" id="room11" src="./roomimages/smfmroom11.png"><img class="room" id="room12" src="./roomimages/smfmroom12a.png"><img class="room" id="room13" src="./roomimages/smfmroom13a.png"><img class="room" id="room14" src="./roomimages/smfmroom14.png">
            </div>            
            <img id= "inventory1" src="">
            <img id= "inventory2" src="./inventoryimages/ribbon.png">
            <img id= "inventory3" src="./inventoryimages/mug.png">
            <img id= "inventory4" src="./inventoryimages/key.png">
            <img id= "inventory5" src="./inventoryimages/crystal.png">
            <img id= "inventory6" src="./inventoryimages/flower.png">
            <img id= "inventory7" src="./inventoryimages/rock.png">
            <img id= "book">
            <div id= "maptiles">
                <img class="roomtile" id="maparrow" src="./maptiles/maparrow.png"><img class="roomtile" id="room1tile" src="./maptiles/room1tile.png" onclick="room1Switch()"><img class="roomtile" id="room2tile" onclick="room2Switch()"><img class="roomtile" id="room3tile" onclick="room3Switch()"><img class="roomtile" id="room4tile" onclick="room4Switch()"><img class="roomtile" id="room5tile" onclick="room5Switch()"><img class="roomtile" id="room6tile" onclick="room6Switch()"><img class="roomtile" id="room7tile" onclick="room7Switch()"><img class="roomtile" id="room8tile" onclick="room8Switch()"><img class="roomtile" id="room9tile" onclick="room9Switch()"><img class="roomtile" id="room10tile" onclick="room10Switch()"><img class="roomtile" id="room11tile" onclick="room11Switch()"><img class="roomtile" id="room12tile" onclick="room12Switch()"><img class="roomtile" id="room14tile" onclick="room14Switch()">
            </div>   
        
        </div>

        <!-- border 2 -->
        <img class="border2" src="./roomimages/border 2.png">
    </div>

    <!-- OUTPUT AREA -->
    <div id="outputarea" onclick="clearMap()">
        <div id="output">

                <!-- READ THIS :) -->

        </div>
        <div class="dialoguearea">
            <button type="button" id="dialogue1" class="dialogue">Option 1</button>
            <button type="button" id="dialogue2" class="dialogue">Option 2</button>
            <button type="button" id="leavebutton" class="dialogue">leave conversation</button>
            <input type="button" id="bookbutton" class="dialogue" value="> Read Journal">
        </div>
        </div>
    </div>
    
     <!-- INPUT AREA -->
<div class="inputarea">
    <input type="text" id="userinput" maxlength="25" onclick="clearMap()">
    <input type="button" id="enterbutton" value="ENTER">
</div>
</article>



</body>


<!-- SCRIPT -->
<script>

// PRESS ANY KEY TO CONTINUE

const theMachine = document.getElementById('themachine')

document.onkeydown = e => { 
    if (introCutscenePlayed === false) 
        {
        introCutscenePlayed = true;
        playIntroCutscene();
        document.getElementById('titlecard').classList.add('fadeout');
        let makeGoAway = () => {document.getElementById('titlecard').style.display = "none"};
        setTimeout(makeGoAway, 1000)
        }
};
const makeFadeAway = () => {
    playIntroCutscene();
    document.getElementById('titlecard').classList.add('fadeout');
    let makeGoAway = () => {document.getElementById('titlecard').style.display = "none"};
    setTimeout(makeGoAway, 1000);
};

//DECLARE VARIABLES
    const introCutscenePlayed = false;
    const userInput = document.getElementById('userinput');
    const outputArea = document.getElementById('outputarea');
    const output = document.getElementById('output');
    const enterButton = document.getElementById('enterbutton');
    const mapArrow = document.getElementById('maparrow');
    const d1 = document.getElementById("dialogue1");
    const d2 = document.getElementById("dialogue2");
    const leaveButton = document.getElementById("leavebutton");
    const bookButton = document.getElementById("bookbutton");
    const map = document.getElementById("map");

    const northTriangle = document.getElementById("northtriangle");
    const southTriangle = document.getElementById("southtriangle");
    const eastTriangle = document.getElementById("easttriangle");
    const westTriangle = document.getElementById("westtriangle");

    const removeItem = (item) => {
        for ( var i = 0; i < inventory.length; i++) { 
            if (inventory[i] === (item)) { 
                inventory.splice(i, 1); 
            }
        };           
    };

    let roomNum = 14;

    let checkingInventory = false;
    let inventoryAsk = false;

    let currentPage = 0;
    let reading = false;
    let readingAsk = false;

    let checkingMap = false;
    let mapAsk = false;

    let currentConversation = 0;
    let dialogueAsk = false;
    let inDialogue = false;

    let newGame = true;
    let doorUnlocked = false;
    let haveRock = false;
    let haveFlower = false;
    let boxUnlocked = false;
    let catDiscovered = false;
    let marbleDown = false;
    let marbleReunited = false;
    let ropeTaken = false;
    let haveRope = false;
    let ropeSet = false;
    let haveBox = false;
    let haveBoxKey = false;
    let mugTaken = false;
    let haveMug = false;
    let ghostGivenMug = false;
    let robotAwake = false;
    let haveCrystal = false;
    let haveFireflies = false;
    let firefliesReleased = false;
    let electroVineTaken = false;
    let haveRibbon = false;
    let foundBook = false;
    let haveMushy = false;
    let ghostDiscovered = false;
    let triedKeyOnDoor = false;
    let caveInspected = false;
    let lakeDiscovered = false;
    let firstCutscene = false;
    let firefliesSeen = false;
    let waterSearchedOnce = false;
    
    let firstHint = false;
    let thingsTried = 0;
    let thingsTriedSinceLastBigThing = 0;
    let profanityCounter = 0;
    let sassyHint = false;
    let boxSmashed = 0;

    const roomVisited = ["", false, false, false, false, false, false, false, false, false, false, false, false, false, true];
    const inventory = [];

    profanityResponse = ["Hey now! This is a nice game.", "Oh c'mon.", ".....Alright...", "Seriously...?", "Okay, I'm gonna need you to stop that.", "This is getting old now.", "This is getting old now.", "This is getting REAALY old now.", "STOOOPPPPP", "I'M GONNA RESET THE GAME", "I'LL DO IT", "I'LL RESET THE GAME DON'T MAKE ME DO IT", "...", "...", "...", ">:(", "Okay I'm seriously done this time.", "Okay I'm seriously done this time.", "Okay for real I'm seriously done this time.", "I said I'M DONE THIS TIME", "Can't say I didn't warn you :P"]

// INVENTORY
    const checkInventory = () => {
        if (inventory.length === 0) {
            return "You don't have anything in your <span>pockets</span> yet.<br><br>Maybe there is something useful nearby you can <span>take</span> with you?"
        } else {
            let inventoryText = ["You have "];
            for (var i = 0; i < inventory.length - 1; i++) {
                inventoryText.push(" " + inventory[i] + ",");
            };
            if (inventory.length > 1) {
                inventoryText.push(" and " + inventory[inventory.length -1]+ " in your <span>pocket</span>.<br><br>Press 'ENTER' to return.")
            } else {
                inventoryText.push(" " + inventory[inventory.length -1]+ " in your <span>pocket</span>.<br><br>Press 'ENTER' to return.")
            };
            return inventoryText.join('');
        };
        // document.getElementById("map").classList.toggle('blur');
    };

    // Displaying Inventory Images
    const switchChestRopeImage = () => {
        if (haveFireflies === true && haveRope === true) {
                document.getElementById("inventory1").src="./inventoryimages/boxglowrope.png";
            } else if (haveFireflies === true && haveRope === false) {
                document.getElementById("inventory1").src="./inventoryimages/boxglow.png";
            } else if (boxUnlocked === true && haveRope === true) {
                document.getElementById("inventory1").src="./inventoryimages/boxopenrope.png";
            } else if (boxUnlocked === true && haveRope === false) {
                document.getElementById("inventory1").src="./inventoryimages/boxopen.png";
            } else if (haveBox === true && haveRope === true) {
                document.getElementById("inventory1").src="./inventoryimages/boxrope.png";
           } else if (haveBox === true) {
                document.getElementById("inventory1").src="./inventoryimages/box.png";
            } else if (haveRope === true) {
                document.getElementById("inventory1").src="./inventoryimages/rope.png";
            };
    };

    const displayInventory = () => {
            if (inventory.length > 0) {
                map.classList.add('blur');
                checkingInventory = true;
                inventoryAsk = true;
            };
            if (haveFlower === true) {
                    document.getElementById("inventory6").style.zIndex = "6";
            };
            if (haveRibbon === true) {
                    document.getElementById("inventory2").style.zIndex = "2";
            };
            if (haveBoxKey === true) {
                    document.getElementById("inventory4").style.zIndex = "4";
            };
            if (haveCrystal === true) {
                    document.getElementById("inventory5").style.zIndex = "5";
            };
            if (haveRock === true) {
                    document.getElementById("inventory7").style.zIndex = "7";
            };
            if (haveBox === true || haveRope === true) {
                    document.getElementById("inventory1").style.zIndex = "1";
            };
            if (haveMug === true) {
                document.getElementById("inventory3").src="./inventoryimages/mug.png";
                document.getElementById("inventory3").style.zIndex = "3";
            } else if (haveMushy === true) {
                document.getElementById("inventory3").src="./inventoryimages/mushy.png";
                document.getElementById("inventory3").style.zIndex = "3";
            }
    };

// DIALOGUE BUTTONS
    // your dialoge
const dialogueButtonTexts = ["> Talk to the robot?",
                             "> Are you the Super Magic Forest Machine?",
                             "> What are you?",
                             "> What were the humans doing?",
                             "> What did they argue about?",
                             "> Can you help me get out of here?",
                             "> What do you need me to bring you?",
                             "> I'm busy",
                             "> How do I find the special flower?",
                             "> What’s so special about the flower?",
                             "> What’s the deal with the door?",
                             "> Did the humans build the door?",
                             "> Where does the door go?",
                             "> I didn’t know robots could sleep.",
                             "> Sounds boring.",
                             "> What do you hope to accomplish by just sitting here?",
                             "> So deep.",
                             "> What does that mean?",
                             "> Are you sure you’re not just bored?",
                             "> What purpose is that?",
                             "> Humans are different than birds and rocks, you know.",
                             "> What will happen to you when I leave? Can you come with me?",
                             "> Is that why you decided to stop propelling yourself through time?",
                             "> So, life is about choosing how to be?",
                             "> But I have to leave.",
                             "> Of course."
                            ];
    
    //robot responses
    const robotDialogueTexts = ["The <span>robot</span> speaks in a metallic voice:<br><br><span class='robot'>Oh. Hi there. I guess you’re the one who woke me up, huh?</span>",
                                "<span class='robot'>Haha… no… Well, not any more-so than the trees, or the grass, or the rocks.</span>",
                                "<span class='robot'>My name is ‘Jen’. It’s short for ‘generator’. I’m a utility robot. A long time ago I helped some humans work here in the forest.</span>",
                                "The robot shrugs its metal arms.<br><br><span class='robot'>Oh, the same thing humans are always doing, I guess. Building things. Burning things. Digging things out of the ground. Using Javascript. Arguing a lot. Humans are always so busy.</span>",
                                "<span class='robot'>Nothing, everything, and all the in-betweens. Humans can be very loud creatures.</span>",
                                "<span class='robot'>So impatient. Always on a mission.<br>Yes, I can help you. But I need you to bring me something first.</span>",
                                "The robot gestures to the north.<br><br><span class='robot'>There’s a special cave to the north of here. I think you’ve been there. In the cave you can find a special flower. If you want to get out of here, I need you to bring that to me.</span>",
                                "<span class='robot'>No you’re not.</span>",
                                "<span class='robot'>Use your rope!</span>",
                                "<span class='robot'>The flower is what makes this place possible. It’s what the humans who brought me here were looking for.</span>",
                                "<span class='robot'>The door connects this place to the outside. I guess you could call it an interdimensional portal, or something like that.</span>",
                                "<span class='robot'>Definitely not. The door has always been here, as far as I can tell. The humans who brought me here acted like they couldn't even see it. Most of them, anyway.<br><br>Single-minded beings have a hard time confronting the incomprehensible.</span>",
                                "<span class='robot'>Wherever you want it to, I guess?</span>",
                                "<span class='robot'>Well, I wasn’t exactly asleep. I simply decided to stop propelling myself through time.</span>",
                                "<span class='robot'>It is.</span>",
                                "The robot shakes its head sadly.<br><br><span class='robot'>Only a human could ask a question like that. Humans always think they can improve upon nature. Maybe one day you humans will realize your path isn’t any different from the rocks or the trees around you. True self-knowledge is love for all things created.</span>",
                                "<span class='robot'>Hah. Just wait till you read my poetry.</span>",
                                "The robot thinks for a second.<br><br><span class='robot'>It means... I stopped worrying about trivial things. Or at least, things that seem trivial to me.</span>",
                                "<span class='robot'>Haha… maybe. A robot doesn’t really belong in a place like this. At least, not a utility bot. I was programmed to work. But now the humans are gone I have a different kind of purpose.</span>",
                                "<span class='robot'>The same purpose as the birds, or the trees, or the rocks.</span>",
                                "<span class='robot'>Yeah, you're right. Humans choose. There are all kinds of ways to be and ways not to be.</span><br><br><span class='robot'>Rocks don’t choose to roll down a hill or sit a forest. Trees don't choose to reach for the light, not really. They just do it. I chose not to choose. Like the rocks.</span>",
                                "<span class='robot'>When you leave I’ll cease to exist.<br><br>But... in another sense, the fact I ever existed at all means I’ll always exist.</span>",
                                "<span class='robot'>Humans think their journey through time is fixed. What’s the old saying… like being stuck on a train that’s always moving in one direction.<br>But time doesn’t work like that. People used to know that. A. Or rather, NOT know that.</span>",
                                "<span class='robot'>I don’t know much about life, to be honest. I’m just a robot. I’m barely capable of speech.</span>",
                                "<span class='robot'>I know. When you get out, will you describe it to me?</span>",
                                "<span class='robot'>Thanks :)</span>",
                                "<span class='robot'>Hello again!</span>"
                                ];
    
const conversationMap = [[2,1],[2,5],[3,10],[4,11],[13,5],[7,6],[8,9],[8,9],[9,12],[3, 8],[11,5],[12,13],[13,5],[17, 14],[15,11],[16,20],[18,20],[18,21],[19,22],[20,21],[23,21],[24,5],[20,10],[13,5],[25,-1],[-1,-1],[2,1]];                      

const createConversation = () => {
    output.innerHTML = robotDialogueTexts[currentConversation];
    dialogueAsk = true;
    inDialogue = true;
    leaveButton.style.display = "block";
    if (conversationMap[currentConversation][0] > -1) {
        d1.innerHTML = dialogueButtonTexts[conversationMap[currentConversation][0]];
        d1.style.display = "block";
    } else {d1.style.display = "none"};
    if (conversationMap[currentConversation][1] > -1) {
        d2.innerHTML = dialogueButtonTexts[conversationMap[currentConversation][1]];
        d2.style.display = "block";
    } else {d2.style.display = "none"};
    outputArea.scroll(0,0);
};

continueConversation1 = () => {
    currentConversation = conversationMap[currentConversation][0];
    createConversation();
};

d1.addEventListener('click', continueConversation1);

continueConversation2 = () => {
    currentConversation = conversationMap[currentConversation][1];
    createConversation();
};

d2.addEventListener('click', continueConversation2);

leaveConversation = () => {
    dialogueAsk = false;
    inDialogue = false;
    d1.style.display = "none";
    d2.style.display = "none";
    leaveButton.style.display = "none";
    if (currentConversation !== 25) {output.innerHTML = "<span class='robot'>See ya later!</span>"}
    else {output.innerHTML = "";};
    currentConversation = 26;
};

leaveButton.addEventListener('click', leaveConversation);


// BOOK BUTTONS
    //page texts
    const journalText = ["The <span>journal</span> begins:<br><br><span class='journal'>          Day 14<br><br>Still no sign of it. <br><br>Our readings indicated that it should be near, but as soon as we got close, all our instruments went haywire. We'll have to continue our search manually until the equipment is repaired.</span>",
                         "<span class='journal'>                                                  Day 15<br><br>A preliminary search of the area was conducted without result. The forest is dense and difficult to travel through. <br><br>Equipment problems persist - possible satellite failure or solar activity. We are forced to leave the proximity zone to contact HQ, which slows progress considerably.</span>", 
                         "<span class='journal'>                                                  Day 19<br><br>That silly young intern keeps wandering off. Kids these days! No discipline.<br><br>I will admit, there is something odd about this place. I can’t put my finger on it. I will attempt an explanation my next report.</span>",
                         "<span class='journal'>                                                  Day 23<br><br>I’m beginning to wonder if we’re going to find it here after all. We have search every corner of the proximity zone, and still no sign of it. <br><br>Maybe HQ made a mistake. That seems unlikely… good luck trying to explain that to the board. The wild variety is said to be 10.8 to 11.3 times stronger than the domesticated variety, with a potential yield to match. Failure is not an option.</span>",
                         "<span class='journal'>                                                  Day 28<br><br>There is a scientific explanation for everything.<br><br>On day 13 we found a cave at to the northwest end of the proximity zone. As soon as we entered, all our flashlights fizzled out, leaving us in total darkness and with no choice but to feel our way back to the entrance.<br><br>If I believed in luck, I would say we are having the worst.<br><br>The cave doesn’t seem like a likely place to find it anyway, since all research indicates that it prefers bright sunlight. The search continues.</span>",
                         "<span class='journal'>                                                  Day 56<br><br>What does it mean to be lost? What does it mean to ‘be’ at all? This place makes me feel… Nevermind. The board will launch an inquiry, and everything will be explained in due time. <br><br>The intern has wandered off again. So sentimental… I caught them drinking out of the lake. Can you imagine… We brought ample hydration packets, even the FlavorMax variety, yet they prefer to drink dirty lake water…</span>",
                         "<span class='journal'>                                                  Day ??<br><br>The days… the weeks… I’ve almost entirely lost track of time.<br><br>HQ has recalled us. The intern disappeared a few nights ago and hasn’t returned. We searched for hours. Oh well. They probably prefer it here anyway. </span>" 
                        ];

    //change button according to input value
    const showBookButton = (buttonText) => {
        bookButton.value = buttonText;
        bookButton.style.display = "block"; 
    };


    //display journal texts according to position in array
    const showBookText = () => {
        if (reading === true || readingAsk === true) {
            output.innerHTML = journalText[currentPage];
            document.getElementById("book").src="./inventoryimages/book.png";
            currentPage = currentPage + 1;
            reading = true;
            readingAsk = false;
            bookButton.value = '> Keep Reading';
            document.getElementById('map').classList.add('blurless');
            if (currentPage === 7) {
                bookButton.value = "> Done";
                userInput.value = "";
            } 
            else if (currentPage >= 8 ) {
                output.innerHTML = "";
                currentPage = 0;
                bookButton.style.display = "none";
                reading = false;
                document.getElementById("book").src="";
                document.getElementById('map').classList.remove('blurless');
            }
        };
        outputArea.scroll(0,0);
    };

    //hit button to show book text
    bookButton.addEventListener('click', showBookText);

// CUTSCENES

    const playIntroCutscene = () => {
        document.getElementById('cutsceneviewer').style.display = "flex";
        document.getElementById("cutscene").src="./cutscenes/introcutscene.mp4";
        document.getElementById("cutscene").pause();
        setTimeout(()=> {
            document.getElementById("cutscene").play();
            room14Switch();
            }
            ,2500);
        let currentCutscene = document.getElementById("cutscene");
        currentCutscene.addEventListener('ended', function() {
            // document.getElementById('cutsceneviewer').classList.add('fadeout');
            let makeGoAway = () => {
                document.getElementById('cutsceneviewer').style.display = "none";
                document.getElementById("cutscene").src="";
                // document.getElementById('cutsceneviewer').classList.remove('fadeout');
                };
            setTimeout(makeGoAway, 1000);
            theMachine.style.display = "flex";
        })
    };

    const playGhostCutscene = () => {
        document.getElementById('cutsceneviewer').style.display = "flex";
        document.getElementById("cutscene").src="./cutscenes/ghostcutscene.mp4";
        let currentCutscene = document.getElementById("cutscene");
        currentCutscene.addEventListener('ended', function() {
            document.getElementById('cutsceneviewer').style.display = "none";
            document.getElementById("cutscene").src="";
        })
    };
    
    const playGhostMugCutscene = () => {
        document.getElementById('cutsceneviewer').style.display = "flex";
        document.getElementById("cutscene").src="./cutscenes/ghostmugcutscene.mp4";
        let currentCutscene = document.getElementById("cutscene");
        currentCutscene.addEventListener('ended', function() {
            document.getElementById('cutsceneviewer').style.display = "none";
            document.getElementById("cutscene").src="";
        })
    };
    
    const playMarbleCutscene = () => {
        document.getElementById('cutsceneviewer').style.display = "flex";
        document.getElementById("cutscene").src="./cutscenes/marblecutscene.mp4";
        let currentCutscene = document.getElementById("cutscene");
        currentCutscene.addEventListener('ended', function() {
            document.getElementById('cutsceneviewer').style.display = "none";
            document.getElementById("cutscene").src="";
        })
    };

    const playOwlCutscene = () => {
        document.getElementById('cutsceneviewer').style.display = "flex";
        document.getElementById("cutscene").src="./cutscenes/owlcutscene.mp4";
        let currentCutscene = document.getElementById("cutscene");
        currentCutscene.addEventListener('ended', function() {
            document.getElementById('cutsceneviewer').style.display = "none";
            document.getElementById("cutscene").src="";
        })
    };
    
    const playTreeClimbCutscene = () => {
        document.getElementById('cutsceneviewer').style.display = "flex";
        document.getElementById("cutscene").src="./cutscenes/treeclimbcutscene.mp4";
        let currentCutscene = document.getElementById("cutscene");
        currentCutscene.addEventListener('ended', function() {
            document.getElementById('cutsceneviewer').style.display = "none";
            document.getElementById("cutscene").src="";
        })
    };
    
    const playCaveCutscene = () => {
        document.getElementById('cutsceneviewer').style.display = "flex";
        document.getElementById("cutscene").src="./cutscenes/cavecutscene.mp4";
        let currentCutscene = document.getElementById("cutscene");
        currentCutscene.addEventListener('ended', function() {
            document.getElementById('cutsceneviewer').style.display = "none";
            document.getElementById("cutscene").src="";
        })
    };
    
    const playCaveCutscene2 = () => {
        document.getElementById('cutsceneviewer').style.display = "flex";
        document.getElementById("cutscene").src="./cutscenes/cavecutscene2.mp4";
        let currentCutscene = document.getElementById("cutscene");
        currentCutscene.addEventListener('ended', function() {
            document.getElementById('cutsceneviewer').style.display = "none";
            document.getElementById("cutscene").src="";
        })
    };
    
    const playBeachCutscene = () => {
        document.getElementById('cutsceneviewer').style.display = "flex";
        document.getElementById("cutscene").src="./cutscenes/beachcutscene.mp4";
        let currentCutscene = document.getElementById("cutscene");
        currentCutscene.addEventListener('ended', function() {
            document.getElementById('cutsceneviewer').style.display = "none";
            document.getElementById("cutscene").src="";
        })
    };
    
    const playFirstCutscene = () => {
        document.getElementById('cutsceneviewer').style.display = "flex";
        document.getElementById("cutscene").src="./cutscenes/firstcutscene.mp4";
        let currentCutscene = document.getElementById("cutscene");
        currentCutscene.addEventListener('ended', function() {
            document.getElementById('cutsceneviewer').style.display = "none";
            document.getElementById("cutscene").src="";
        })
    };
    
    const playFireflyCutscene = () => {
        document.getElementById('cutsceneviewer').style.display = "flex";
        document.getElementById("cutscene").src="./cutscenes/fireflycutscene.mp4";
        let currentCutscene = document.getElementById("cutscene");
        currentCutscene.addEventListener('ended', function() {
            document.getElementById('cutsceneviewer').style.display = "none";
            document.getElementById("cutscene").src="";
        })
    };
    
    const playRobotCutscene = () => {
        document.getElementById('cutsceneviewer').style.display = "flex";
        document.getElementById("cutscene").src="./cutscenes/robotcutscene.mp4";
        let currentCutscene = document.getElementById("cutscene");
        currentCutscene.addEventListener('ended', function() {
            document.getElementById('cutsceneviewer').style.display = "none";
            document.getElementById("cutscene").src="";
        })
    };


// ROOM SWITCHING FUNCTIONS

const room1 = document.getElementById("room1");
const room2 = document.getElementById("room2");
const room3 = document.getElementById("room3");
const room4 = document.getElementById("room4");
const room5 = document.getElementById("room5");
const room6 = document.getElementById("room6");
const room7 = document.getElementById("room7");
const room8 = document.getElementById("room8");
const room9 = document.getElementById("room9");
const room10 = document.getElementById("room10");
const room11 = document.getElementById("room11");
const room12 = document.getElementById("room12");
const room13 = document.getElementById("room13");
const room14 = document.getElementById("room14");

allRooms = [room1, room2, room3, room4, room5, room6, room7, room8, room9, room10, room11, room12, room13, room14]

const moveAllRoomsBack = () => {
    allRooms[roomNum-1].style.zIndex = "-2"; 
    }

const room1Switch = () => {
        mapArrow.style.top = "53%";
        mapArrow.style.left = "42.6%";
        output.innerHTML = "You find yourself in a clearin in the middle of the forest, where a <span>strange wooden door</span> is standing.";
        moveAllRoomsBack();
        room1.style.zIndex = "0";
        roomNum = 1;
        northTriangle.style.opacity = "75%";
        southTriangle.style.opacity = "75%";
        eastTriangle.style.opacity = "75%";
        westTriangle.style.opacity = "75%";
    };
    const room2Switch = () => {
        if (roomVisited[2] === false) {
            output.innerHTML = "The forest grows darker. Large leafy branches block out almost at the light from the fading sun.<br><br>In the middle of the clearing, the <span>glowing light</span> of countless fireflies illuminate the forest.";
        } else {
            output.innerHTML = "The forest is dark, but the air is filled with <span>fireflies</span>. It's rather magical.";
        };
        roomVisited[2] = true;
        mapArrow.style.top = "32%";
        mapArrow.style.left = "55.3%";
        moveAllRoomsBack();
        room2.style.zIndex = "0";
        document.getElementById("room2tile").src="./maptiles/room2tile.png";
        roomNum = 2;
        northTriangle.style.opacity = "28%";
        southTriangle.style.opacity = "75%";
        eastTriangle.style.opacity = "75%";
        westTriangle.style.opacity = "75%";
    };
    const room3Switch = () => {
        if (roomVisited[3] === false) { 
            if (roomNum === 1 || roomNum === 6) {
                output.innerHTML = "The trees grow more dense as you travel through the forest.<br><br>You arrive at a shady knoll with an old <span>stump</span> in the middle.";
            } else {
                output.innerHTML = "You make your way <span>south</span> through the forest.<br><br>You arrive at a shady knoll with an old <span>stump</span> in the middle.";
            }
        } else {
            output.innerHTML = "An old <span>tree stump</span> sits in the center of a shady knoll.";
        };
        roomVisited[3] = true;
        mapArrow.style.top = "53%";
        mapArrow.style.left = "55.3%";
        moveAllRoomsBack();
        room3.style.zIndex = "0";
        document.getElementById("room3tile").src="./maptiles/room3tile.png";
        roomNum = 3;
        northTriangle.style.opacity = "75%";
        southTriangle.style.opacity = "75%";
        eastTriangle.style.opacity = "28%";
        westTriangle.style.opacity = "75%";
    };
    const room4Switch = () => {
        if (roomNum === 1 && marbleDown === false) {
            output.innerHTML = "You travel <span>north</span> until you arrive at glade with a large <span>tree</span> in the middle.<br><br><span>Something</span> is rustling up in the tree's branches...";
        } else if (roomNum === 2 && marbleDown === false) {
            output.innerHTML = "You travel <span>west</span> until you arrive at glade with a large <span>tree</span> in the middle.<br><br><span>Something</span> is rustling up in the tree's branches...";
        } else if (marbleDown === false) {
            output.innerHTML = "You arrive at a glade with a large <span>tree</span> in the middle.<br><br><span>Something</span> is rustling up in the tree's branches...";
        } else if (marbleDown === true) {
            output.innerHTML = "You arrive at a glade with a large <span>tree</span> in the middle. This is where the <span>cat</span> was.";
        };
        roomVisited[4] = true;
        mapArrow.style.top = "32%";
        mapArrow.style.left = "42.6%";
        moveAllRoomsBack();
        if (marbleDown === false) {room4.src="./roomimages/smfmroom4a.png"}
        else if (marbleReunited !== true) {room4.src="./roomimages/smfmroom4b.png"}
        else {room4.src="./roomimages/smfmroom4c.png"};
        room4.style.zIndex = "0";
        document.getElementById("room4tile").src="./maptiles/room4tile.png";
        roomNum = 4;
        northTriangle.style.opacity = "28%";
        southTriangle.style.opacity = "75%";
        eastTriangle.style.opacity = "75%";
        westTriangle.style.opacity = "75%";
    };
    const room5Switch = () => { 
        if (roomNum === 1) {
            output.innerHTML = "You travel <span>south</span> until you arrive at at rocky <span>lake shore</span>. The fading sunlight glistens on the calm surface.";
        } else if (roomNum === 12) {
            output.innerHTML = "You travel <span>east</span> until you arrive at at rocky <span>lake shore</span>. The fading sunlight glistens on the calm surface.";
        } else if (roomNum ===6 ) {
            output.innerHTML = "You travel <span>west</span> until you arrive at at rocky <span>lake shore</span>. The fading sunlight glistens on the calm surface.";
        } else {
            output.innerHTML = "You arrive at at rocky <span>lake shore</span>. The fading sunlight glistens on the calm surface."
        };
        roomVisited[5] = true;
        mapArrow.style.top = "73%";
        mapArrow.style.left = "42.6%";
        moveAllRoomsBack();
        room5.style.zIndex = "0";
        document.getElementById("room5tile").src="./maptiles/room5tile.png";
        roomNum = 5;
        northTriangle.style.opacity = "75%";
        southTriangle.style.opacity = "28%";
        eastTriangle.style.opacity = "75%";
        westTriangle.style.opacity = "75%";
    };
    const room6Switch = () => {
        if (haveRope === false && ropeSet === false && roomNum === 5) {
                output.innerHTML = "You travel <span>east</span> along the lake shore until you arrive at a wooded point, where a half-sunk <span>boat</span> is tied to a mooring.";
            } else if (haveRope === false && ropeSet === false && roomNum === 3) {
                output.innerHTML = "You travel <span>south</span> through the forest until you arrive at a wooded <span>shoreline</span>, where a half-sunk <span>boat</span> is tied to a mooring.";
            } else {
                output.innerHTML = "You arrive at the wooded point where the half-sunk <span>boat</span> sits in the water.";
        };
        roomVisited[6] = true;
        mapArrow.style.top = "73%";
        mapArrow.style.left = "55.3%";
        moveAllRoomsBack();
        if (ropeTaken === false) {room6.src="./roomimages/smfmroom6a.png"}
        else {room6.src="./roomimages/smfmroom6b.png"};
        room6.style.zIndex = "0";
        document.getElementById("room6tile").src="./maptiles/room6tile.png";
        roomNum = 6;
        northTriangle.style.opacity = "75%";
        southTriangle.style.opacity = "28%";
        eastTriangle.style.opacity = "28%";
        westTriangle.style.opacity = "75%";
    }; 
    const room7Switch = () => {
        if (firefliesReleased === false) {
            output.innerHTML = "You make your way inside the <span>cave</span>. The light slowly fades behind you until you find yourself in almost complete <span>darkness</span>.<br><br>Soon you can barely see your hands in front of you.";
        } else {
            output.innerHTML = "The <span>cave</span> is filled with the light of countless <span>fireflies</span>. The strange <span>crystals</span> glow faintly.";
        };
        roomVisited[7] = true;
        mapArrow.style.top = "13%";
        mapArrow.style.left = "29.8%";
        moveAllRoomsBack();
        if (firefliesReleased === false) {
            room7.src="./roomimages/smfmroom7a.png"
            document.getElementById("room7tile").src="./maptiles/room7tiledark.png";
            northTriangle.style.opacity = "28%";
            southTriangle.style.opacity = "75%";
            eastTriangle.style.opacity = "28%";
            westTriangle.style.opacity = "28%";
        }
        else {
            room7.src="./roomimages/smfmroom7b.png";
            document.getElementById("room7tile").src="./maptiles/room7tile.png";
            northTriangle.style.opacity = "28%";
            southTriangle.style.opacity = "75%";
            eastTriangle.style.opacity = "28%";
            westTriangle.style.opacity = "75%";
        }
        room7.style.zIndex = "0";
        roomNum = 7;
    }; 
    const room8Switch = () => {
        if (roomVisited[8] === false) {
            output.innerHTML = "You make your way <span>west</span> through the dimly-lit cave and arrive at large grotto. A single beam of light from far above illuminates an island in the center of an underground lake.";
        } else {
            output.innerHTML = "You arrive at large grotto, where single beam of light from far above illuminates an island in the center of an underground lake.";
        };
        roomVisited[8] = true;
        mapArrow.style.top = "13%";
        mapArrow.style.left = "16.9%";
        moveAllRoomsBack();
        room8.style.zIndex = "0";
        document.getElementById("room8tile").src="./maptiles/room8tile.png";
        roomNum = 8;
        northTriangle.style.opacity = "28%";
        southTriangle.style.opacity = "28%";
        eastTriangle.style.opacity = "75%";
        westTriangle.style.opacity = "28%";
    };
    const room9Switch = () => {
        if (roomVisited[9] === false) {
            output.innerHTML = "A narrow path leads you <span>east</span> through the forest. The air grows stale as dried and rotting tree branches grab at your clothes.<br><br>You arrive at a murky hollow and a circle of <span>mushrooms</span>.";
        } else {
            output.innerHTML = "A narrow path leads you <span>east</span> through the forest.<br><br>You arrive at a murky hollow and a circle of <span>mushrooms</span>.";
        };
        roomVisited[9] = true;
        mapArrow.style.top = "32%";
        mapArrow.style.left = "68%";
        moveAllRoomsBack();
        if (ghostGivenMug === true || ghostDiscovered === false ) {room9.src="./roomimages/smfmroom9b.png"}
        else {room9.src="./roomimages/smfmroom9a.png"};
        room9.style.zIndex = "0";
        document.getElementById("room9tile").src="./maptiles/room9tile.png";
        roomNum = 9;
        northTriangle.style.opacity = "28%";
        southTriangle.style.opacity = "28%";
        eastTriangle.style.opacity = "28%";
        westTriangle.style.opacity = "75%";
    }; 
    const room10Switch = () => {
        if (roomVisited[10] === false) { 
            if (roomNum === 1) {
                output.innerHTML = "You travel <span>west</span>, making your way along a wooded trail until you arrive at a <span>stone well</span>.<br><br>You wonder who made this <span>well</span>, and how long ago.";
            } else if (roomNum === 13) {
                output.innerHTML = "You climb back out of the well."
            } else {
                output.innerHTML = "You arrive at a <span>stone well</span>.<br><br>You wonder who made this <span>well</span>, and how long ago.";
            };
        } 
        else {
            if (roomNum === 1) {
                output.innerHTML = "You travel <span>west</span> to find the <span>stone well</span>.";
            } else if (roomNum === 12) {
                output.innerHTML = "You travel <span>north</span> to find the <span>stone well</span>.";
            } else if (roomNum === 11) {
                output.innerHTML = "You travel <span>south</span> to find the <span>stone well</span>.";
            } else {
                output.innerHTML = "You find yourself in front of the <span>stone well</span>."
            };
        };
        roomVisited[10] = true;
        mapArrow.style.top = "53%";
        mapArrow.style.left = "29.8%";
        moveAllRoomsBack();
        if (ropeSet === false) {room10.src="./roomimages/smfmroom10a.png"}
        else {room10.src="./roomimages/smfmroom10b.png"};
        room10.style.zIndex = "0";
        document.getElementById("room10tile").src="./maptiles/room10tile.png";
        roomNum = 10;
        northTriangle.style.opacity = "75%";
        southTriangle.style.opacity = "75%";
        eastTriangle.style.opacity = "75%";
        westTriangle.style.opacity = "28%";
    }; 
    const room11Switch = () => {
        if (roomVisited[11] === false) {
            output.innerHTML = "You find yourself at the mouth of a large <span>cave<span>.";
        } else if (roomNum === 7) {
            output.innerHTML = "You follow the light back to the entrance of the <span>cave<span>."
        } else {
            output.innerHTML = "You find yourself at the mouth of the large <span>cave</span>.";
        };
        roomVisited[11] = true;
        mapArrow.style.top = "32%";
        mapArrow.style.left = "29.8%";
        moveAllRoomsBack();
        room11.style.zIndex = "0";
        document.getElementById("room11tile").src="./maptiles/room11tile.png";
        roomNum = 11;
        northTriangle.style.opacity = "75%";
        southTriangle.style.opacity = "75%";
        eastTriangle.style.opacity = "75%";
        westTriangle.style.opacity = "28%";
    };
    const room12Switch = () => {
        document.getElementById('introarrow').style.display = "none";
        if (newGame === true) {
                output.innerHTML = "You travel <span>east</span> along the narrow path for a while until you arrive at a <span>lake shore</span>, where a <span>strange figure</span> is laying against a large willow tree.<br><br>Try typing a command, like \"<span>look around</span>\", \"<span>inspect strange figure</span>\", or \"<span>pick up a rock</span>\".<br><br>You can type \'hint\' at any point to get some help."
        } else if (robotAwake === false) {
            if (roomNum === 5 || roomNum === 6 || roomNum === 3) {
                output.innerHTML = "You travel <span>west</span> along the lakeshore until you arrive at at a large willow tree where a <span>strange figure</span> is laying.";
            } else if (roomNum === 14) { 
                output.innerHTML = "You walk <span>east</span> and arrive at a <span>lake shore</span>, where a <span>strange figure</span> is laying against a large willow tree." 
            } else {
                output.innerHTML = "You walk <span>south</span> until you arrive at a <span>lake shore</span>. where a <span>strange figure</span> is laying against a large willo tree.";
            }
        } else {
            if (roomNum === 5 || roomNum === 6 || roomNum === 3) {
                output.innerHTML = "You travel <span>west</span> along the lakeshore until you arrive at the lakeshore, where the <span>robot</span> is standing under a large willow tree.";
            } else if (roomNum === 14) { 
                output.innerHTML = "You travel <span>east</span> and  you arrive at the lakeshore, where the <span>robot</span> is standing under a large willow tree." 
            } else {
                output.innerHTML = "You walk <span>south</span> and arrive at the lakeshore, where the <span>robot</span> is standing under a large willow tree.";
            }
        };
        roomVisited[12] = true;
        mapArrow.style.top = "73%";
        mapArrow.style.left = "29.8%";
        moveAllRoomsBack();
        if (robotAwake === false) {room12.src="./roomimages/smfmroom12a.png"}
        else {room12.src="./roomimages/smfmroom12b.png"};
        room12.style.zIndex = "0";
        document.getElementById("room12tile").src="./maptiles/room12tile.png";
        newGame = false;
        roomNum = 12;
        northTriangle.style.opacity = "75%";
        southTriangle.style.opacity = "28%";
        eastTriangle.style.opacity = "75%";
        westTriangle.style.opacity = "75%";
    }; 
    const room13Switch = () => {
        output.innerHTML = "You carefully climb down the rope to the bottom of the <span>well</span>.";
        roomVisited[13] = true;
        moveAllRoomsBack();
        if (mugTaken === false) {room13.src="./roomimages/smfmroom13a.png"}
        else {room13.src="./roomimages/smfmroom13b.png"};
        room13.style.zIndex = "0";
        roomNum = 13;
        northTriangle.style.opacity = "28%";
        southTriangle.style.opacity = "28%";
        eastTriangle.style.opacity = "28%";
        westTriangle.style.opacity = "28%";
    }; 
    const room14Switch = () => { 
        if (newGame === false) {
            output.innerHTML = "You travel <span>west</span> and return to the glade where you awoke.";
        } else {
            output.innerHTML = "You open your eyes and find yourself in a forest clearing.<br><br>You try to remember how you got here, but your mind is fuzzy. \"I guess I fell asleep,\" you think to yourself.<br><br>The woods around you are dense and dark. There is a narrow path leading <span>east</span>.<br><br>To travel east, click the 'E' in the top right corner of the screen, or type \"travel east\" in the prompt below and press 'ENTER'.";
        };
        mapArrow.style.top = "73%";
        mapArrow.style.left = "16.9%";
        moveAllRoomsBack();
        room14.style.zIndex = "0";
        document.getElementById("room14tile").src="./maptiles/room14tile.png";
        roomNum = 14;
        northTriangle.style.opacity = "28%";
        southTriangle.style.opacity = "28%";
        eastTriangle.style.opacity = "75%";
        westTriangle.style.opacity = "28%";
    };
    // CHEATER MAP CLICKING FUNCTIONS

    const goNorth = () =>
        {
            userInput.value = "go north";
            processInput();
        };
    const goSouth = () =>
        {
            userInput.value = "go south";
            processInput();
        };
    const goEast = () =>
        {
            userInput.value = "go east";
            processInput();
        };
    const goWest = () =>
        {
            userInput.value = "go west";
            processInput();
        };


// VIEWING THE MAP
const checkMap = () => {
    checkingMap = true;
    mapAsk = true;
    document.getElementById('maptiles').style.display = "block";
    map.classList.add('darken');
};

const clearMap = () => {
    if (checkingMap === true || mapAsk === true) {
        document.getElementById('maptiles').style.display = "none"
        // output.innerHTML = "You close your <span>map</span>.";
        output.innerHTML = "";
        map.classList.remove('darken');
        userInput.focus(); 
        };
    };


// USER INPUT
    const inp = (arg) => {
        return userInput.value.toLowerCase().includes(arg);
    };
    const processInput = () => {
        //clear inventory
        document.getElementById('map').classList.remove('blur');
        document.getElementById("inventory1").style.zIndex = "-2";document.getElementById("inventory2").style.zIndex = "-2";document.getElementById("inventory3").style.zIndex = "-2";document.getElementById("inventory4").style.zIndex = "-2";document.getElementById("inventory5").style.zIndex = "-2";document.getElementById("inventory6").style.zIndex = "-2";document.getElementById("inventory7").style.zIndex = "-2";

        //clear map
        document.getElementById('maptiles').style.display = "none";
        map.classList.remove('darken');

        // not being asked
        readingAsk = false;
        mapAsk = false;
        inventoryAsk = false;
        dialogueAsk = false;

        //clear buttons
        bookButton.style.display = "none";
        document.getElementById("book").src="";
        document.getElementById('map').classList.remove('blurless');
        d1.style.display = "none";
        d2.style.display = "none";
        leaveButton.style.display = "none";
        

        // GET INPUT
        switch (true) {
    
        // GLOBAL
            case inp('talk test'):
                output.innerHTML = "";
                createConversation();
                break;
            case inp('get room num'):
                output.innerHTML = roomNum;
                break;
            case inp('get ghost vars'):
                output.innerHTML = "mugTaken: " + mugTaken + "<br><br>ghostDiscovered: " + ghostDiscovered + "<br><br>ghostGivenMug: " + ghostGivenMug;
                break;
            case inp('wake') && inp('up'):
                output.innerHTML = "You rub your eyes and pinch yourself, but nothing happens.";
                break;
            case inp("nap") || inp("sleep"):
                output.innerHTML = "You're not really tired.";
                break; 
            case inp('chill') || (inp('not') && inp('much')):
                output.innerHTML = "cool cool";
                break;
            case inp('how') && inp('are') && inp('you') :
                output.innerHTML = "I'm good! How are you?";
                break;
            case inp('reset'):
                room1Switch();
                roomNum = 1;
                userInput.value = "";
                output.innerHTML = "";
                break;
            case inp('marco') :
                output.innerHTML = "Polo!";
                break;
            case inp("fart") :
                output.innerHTML = "Pfpffpf.";
                break;
            case inp("peepee") :
                output.innerHTML = "Poopoo.";
                break;
            case inp("sexy") :
                output.innerHTML = ";)";
                break;
            case (inp('poop')||inp("fuck")||inp("sex")||inp("shit")||inp("cunt")||inp("pussy")||inp("dick")||inp("penis"))||inp('cock')||inp('boner')||inp('crap')||inp('wank')||inp("piss")||inp('shart')||inp('balls')||inp('vagina')||inp('gooch')||inp('retard')||inp('asshole')||inp('ass hole')||inp('bitch')||inp('you die')||inp('hate')||(inp('flesh')&&inp('light'))  :
                if (profanityCounter < 21) {
                    output.innerHTML = profanityResponse[profanityCounter];
                    profanityCounter++;
                    break;
                } else {
                    document.body.style.display = 'none';
                    break;
                };
            case (inp("this is")||inp('game')) && (inp('stupid')||inp('dumb')) :
                output.innerHTML = "No u.";
                break;
            case (inp("this is")||inp('game')) && (inp('stupid')||inp('terrible')||inp('lame')) :
                output.innerHTML = "Whatever.";
                break;
            case (inp("this is")||inp('game')) && (inp('weird')) :
                output.innerHTML = "Weird is good. I can work with weird.";
                break;
            case (inp("this")||inp('game')) && (inp('suck')||inp('blow')) :
                output.innerHTML = "lol u wish.";
                break;
            case ((inp("you")&inp('are'))||inp('you\'re')) && inp('mean') :
                output.innerHTML = "No you're mean!";
                break;
            case inp("boob")||inp("tits")||inp("titties")||inp("titty") :
                output.innerHTML = "(.)(.)";
                break;
            case inp('how') && inp('it') && inp('going') :
                output.innerHTML = "Pretty good! Playing a game with a cool person.";
                break;
            case inp('moon') && roomNum !== 7 && roomNum !== 8 && roomNum !== 13:
                output.innerHTML = "The moon is just beginning to rise over the forest.";
                break;
            case inp('moon') :
                output.innerHTML = "You can't see the moon from here.";
                break;
            case inp('sun') || inp('sky') && roomNum !== 7 && roomNum !== 8 && roomNum !== 13:
                output.innerHTML = "The sun is beginning to set over the forest.";
                break;
            case inp('sun') || inp('sky') :
                output.innerHTML = "You can't see the sky from here.";
                break;
            
        // GET HINT
                // initial hints
            case (inp("hint") || inp("help") || inp("clue")) && firstHint === false && haveBox === false && ropeTaken === false && haveBoxKey === false && roomVisited[5] === false && roomVisited[3] === false && roomVisited[10] === false && roomVisited[4] === false    :
                output.innerHTML = "There is something strange about this place...<br><br>You can type commands like \"<span>look around</span>\", \"<span>walk</span>\" in a direction, or \"<span>look</span>\" at something.<br><br>You can also try to put some objects in your pockets, or type \"<span>pockets</span>\" to see what you've picked up so far. Important items are often highligheted <span>in red</span>.<br><br>You can type \"<span>map</span>\" to see where you've been.";
                firstHint = true;
                break;
            case (inp("hint") || inp("help") || inp("clue")) && thingsTriedSinceLastBigThing < 6 && haveBox === false && ropeTaken === false && haveBoxKey === false && roomVisited[5] === false && roomVisited[3] === false && roomVisited[10] === false && roomVisited[4] === false :
                output.innerHTML = "You can type commands like \"<span>look around</span>\", \"<span>walk</span>\" in a direction, or \"<span>look</span>\" at something.<br><br>You can also try to put some objects in your pockets, or type \"<span>pockets</span>\" to see what you've picked up so far. Important items are often highligheted in <span>this shade of red</span><br><br>You can type \"<span>map</span>\" to see where you've been.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) &&  roomVisited[10] === false  && roomVisited [5] === false:
                output.innerHTML = "There's a lot of forest to explore! You can type to walk in a direction, or click the corners of the screen above. Type \"<span>map</span>\" to see where you are.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && inventory.length === 0 :
                output.innerHTML = "The objects around you can be interacted with. Try typing \"<span>pick up rock</span>\".<br><br>You can also type \"<span>check pockets</span>\" to see what items you've picked up so far.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && haveBoxKey === false && haveBox === false &&  boxUnlocked === false && roomNum !== 12 && roomNum !== 5 && roomNum !== 6:
                output.innerHTML = "You can travel around the forest by typing things like <span>go north</span>.<br><br>You can also get around by clicking on the triangles in the corners of the screen above, or by typing <span>map</span> and clicking on an area you've already been to.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && haveBoxKey === false && haveBox === false &&  boxUnlocked === false :
                output.innerHTML = "It's always helpful to <span>look around</span> any time you arrive in a new area.<br><br>You can move around the forest quickly by clicking on triangles in the corners of the screen above, or by typing <span>map</span> and clicking on an area you've already been to.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && haveBoxKey === true && haveBox === false && triedKeyOnDoor === false &&  boxUnlocked === false:
                output.innerHTML = "You found a <span>key</span>!<br><br>I bet it unlocks something nearby.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && haveBoxKey === true && haveBox === false && triedKeyOnDoor === true &&  boxUnlocked === false:
                output.innerHTML = "Welp, looks like this is the wrong <span>key</span> for the <span>door</span>...<br><br>Maybe this <span>key</span> fits something else nearby<br><br>You can type \"<span>map</span>\" to see where you've been, or \"<span>hint</span>\" if you get stuck.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && haveBoxKey === false && haveBox === true &&  boxUnlocked === false && thingsTriedSinceLastBigThing < 80 :
                output.innerHTML = "You can hear something inside the <span>box</span> when you shake it. There has to be a way to open it! Maybe the <span>key</span> is nearby.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && haveBoxKey === false && haveBox === true &&  boxUnlocked === false && thingsTriedSinceLastBigThing < 100 :
                output.innerHTML = "I'm sure you can get this <span>box</span> open somehow!";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && haveBoxKey === false && haveBox === true &&  boxUnlocked === false :
                output.innerHTML = "There has to be a way to open this <span>box</span>...";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && boxUnlocked === false && haveBox === true && haveBoxKey === true:
                output.innerHTML = "Type \"<span>pockets</span>\" to see what you have with you.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && boxUnlocked === true && boxSmashed < 3 && haveFireflies === false && firefliesReleased === false && thingsTriedSinceLastBigThing < 20:
                output.innerHTML = "You used the key to open <span>box</span>, but there was only a <span>red ribbon</span> inside.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && boxUnlocked === true && haveFireflies === false && firefliesReleased === false && boxSmashed > 2 && (thingsTriedSinceLastBigThing < 10 || sassyHint === false):
                output.innerHTML = "You really think I'm gonna give you a hint after you smashed the <span>box</span> like that? HA.<br><br>This one's on you.";
                sassyHint = true;
                break;
            case (inp("hint") || inp("help") || inp("clue")) && boxUnlocked === true && haveFireflies === false && firefliesReleased === false && boxSmashed > 2  && thingsTriedSinceLastBigThing < 20:
                output.innerHTML = "I told you I wasn't gonna give you a hint.<br><br>Shouldn't've smashed the <span>box</span>";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && boxUnlocked === true && haveFireflies === false && firefliesReleased === false && boxSmashed > 2  && thingsTriedSinceLastBigThing > 19:
                output.innerHTML = "Ok fine. Here's a hint: something in your pockets can be used to help explore an <span>area</span>. That's all I'm gonna say.";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && boxUnlocked === true && boxSmashed < 3 && haveFireflies === false && firefliesReleased === false && thingsTriedSinceLastBigThing > 19 && roomVisited[7] === false:
                output.innerHTML = "Try exploring the map a bit more!";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && boxUnlocked === true && boxSmashed < 3 && haveFireflies === false && firefliesReleased === false && thingsTriedSinceLastBigThing > 19:
                output.innerHTML = "There is something strange about that <span>cave</span>... Maybe you can find a way to <span>light it up</span>?";
                break;
            case (inp("hint") || inp("help") || inp("clue")) && firefliesReleased === true && robotAwake === false :
                output.innerHTML = "You used the <span>fireflies</span> to light up the <span>cave</span>, and found it was full of <span>strange crystals</span>.";
                break;
            case (inp("hint") || inp("help") || inp("clue"))  :
                output.innerHTML = "You got this!";
                break;

        // MAP CHECKING
            case inp('map') :
                output.innerHTML = "You open your <span>map</span>.<br><br>Press 'ENTER' to return."
                userInput.value = "";
                checkMap();
                break;

        // CHECK INVENTORY
            case ((inp("check")||inp('look')||inp('inspect'))   &&    inp('pocket')) || inp('inventory')  :
                userInput.value = "";
                output.innerHTML = checkInventory();
                displayInventory();
                break;
            
        // TRAVEL

            // GOING EAST
            case ((inp("walk")||inp('go')||inp('travel')||(inp('take')&&inp('me')))   &&    inp('right'))  || inp('east') :
                switch (roomNum) {
                    case 9:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dark and dense to go any further east.";
                        break;
                    case 1:
                        room3Switch();
                        userInput.value = "";
                        roomNum = 3;
                        break;
                    case 13:
                        userInput.value = "";
                        output.innerHTML = "There's nowhere to go!";
                        break;
                    case 4:
                        room2Switch();
                        userInput.value = "";
                        roomNum = 2;
                        break;
                    case 5:
                        room6Switch();
                        userInput.value = "";
                        roomNum = 6;
                        break;
                    case 3:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dense to go any further east.";
                        break;
                    case 6:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dense to go any further east.";
                        break;
                    case 11:
                        room4Switch();
                        userInput.value = "";
                        roomNum = 4;
                        break;
                    case 8:
                        room7Switch();
                        userInput.value = "";
                        roomNum = 7;
                        break;
                    case 10:
                        room1Switch();
                        roomNum = 1;
                        break;
                    case 14:
                        room12Switch();
                        roomNum = 12;
                        break;
                    case 2:
                        room9Switch();
                        roomNum = 9;
                        break;
                    case 12:
                        room5Switch();
                        roomNum = 5;
                        break;
                    case 7:
                        if (firefliesReleased === false) {
                            output.innerHTML = "If you go any further you will lose yourself in the <span>darkness</span>."
                        } else {
                            output.innerHTML = "There's nowhere to go that way."
                        };
                        break;
                };
                break;

            // GOING NORTH
            case roomNum !== 13 && ((inp("walk")||inp('go')||inp('travel')||(inp('take')&&inp('me')))   &&    inp('up')||inp('straight')||inp('forward'))  || inp('north')  :
                switch (roomNum) {
                    case 3:
                        room2Switch();
                        userInput.value = "";
                        roomNum = 2;
                        break;
                    case 5:
                        room1Switch();
                        userInput.value = "";
                        roomNum = 1;
                        break;
                    case 4:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dense to go any further north.";
                        break;
                    case 2:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dense to go any further north.";
                        break;
                    case 14:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dense to go north.";
                        break;
                    case 9:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dark and dense to go any further north.";
                        break;
                    case 1:
                        room4Switch();
                        userInput.value = "";
                        roomNum = 4;
                        break;
                    case 6:
                        room3Switch();
                        userInput.value = "";
                        roomNum = 3;
                        break;
                    case 12:
                        room10Switch();
                        userInput.value = "";
                        roomNum = 10;
                        break;
                    case 10:
                        room11Switch();
                        userInput.value = "";
                        roomNum = 11;
                        break;
                    case 7:
                        if (firefliesReleased === false) {
                            output.innerHTML = "If you go any further you will lose yourself in the <span>darkness</span>."
                        } else {
                            output.innerHTML = "There's nowhere to go that way."
                        };
                        break;
                    case 11:
                        room7Switch();
                        userInput.value = "";
                        roomNum = 7;
                        break;
                };
                break;

            // GOING WEST
            case ((inp("walk")||inp('go')||inp('travel')||(inp('take')&&inp('me')))   &&    inp('left'))  || inp('west')  :
                switch (roomNum) {
                    case 14:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dense to go west.";
                        break;
                    case 11:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dense to go any further west.";
                        break;
                    case 10:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dense to go any further west.";
                        break;
                    case 13:
                        userInput.value = "";
                        output.innerHTML = "There's nowhere to go!";
                        break;
                    case 12:
                        room14Switch();
                        userInput.value = "";
                        output.innerHTML = "You travel <span>west</span> and return to the glade where you awoke.";
                        roomNum = 14;
                        break;
                    case 3:
                        room1Switch();
                        userInput.value = "";
                        roomNum = 1;
                        break;
                    case 2:
                        room4Switch();
                        userInput.value = "";
                        roomNum = 4;
                        break;
                    case 6:
                        room5Switch();
                        userInput.value = "";
                        roomNum = 5;
                        break;
                    case 9:
                        room2Switch();
                        userInput.value = "";
                        roomNum = 2;
                        break;
                    case 4:
                        room11Switch();
                        userInput.value = "";
                        roomNum = 11;
                        break;
                    case 1:
                        room10Switch();
                        userInput.value = "";
                        roomNum = 10;
                        break;
                    case 5:
                        room12Switch();
                        userInput.value = "";
                        roomNum = 12;
                        break;
                    case 7:
                        if (firefliesReleased === false) {
                            output.innerHTML = "If you go any further you will lose yourself in the <span>darkness</span>."
                        } else {
                            room8Switch();
                            roomNum = 8;
                        }
                        userInput.value = "";
                        break;
                };
                break;

            // GOING SOUTH
            case roomNum !== 10 && (((inp("walk")||inp('go')||inp('travel')||(inp('take')&&inp('me')))   &&    (inp('down'))) || inp('south'))  :
                switch (roomNum) {
                    case 9:
                        userInput.value = "";
                        output.innerHTML = "The forest is too dark and dense to go any further south.";
                        break;
                    case 2:
                        room3Switch();
                        userInput.value = "";
                        roomNum = 3;
                        break;
                    case 1:
                        room5Switch();
                        userInput.value = "";
                        roomNum = 5;
                        break;
                    case 4:
                        room1Switch();
                        userInput.value = "";
                        roomNum = 1;
                        break;
                    case 3:
                        room6Switch();
                        userInput.value = "";
                        roomNum = 6;
                        break;
                    case 5:
                        userInput.value = "";
                        output.innerHTML = "You can't go any farther south - the water seems to go on forever.";
                        break;
                    case 14:
                        userInput.value = "";
                        output.innerHTML = "There is a fence blocking you from going any further south.";
                        break;
                    case 13:
                        userInput.value = "";
                        output.innerHTML = "There's nowhere to go!";
                        break;
                    case 6:
                        userInput.value = "";
                        output.innerHTML = "You can't go any farther south - the water seems to go on forever.";
                        break;
                    case 12:
                        userInput.value = "";
                        output.innerHTML = "You can't go any farther south - the water seems to go on forever.";
                        break;
                    case 7:
                        room11Switch();
                        userInput.value = "";
                        roomNum = 11;
                        break;
                    case 11:
                        room10Switch();
                        userInput.value = "";
                        roomNum = 10;
                        break;
                };
                break;

            // SPECIAL CASE FOR ROOM 10 BECAUSE OF GOING "DOWN" THE WELL
            case roomNum === 10 && inp("go")   &&    inp('down')  && ropeSet === true  :
                output.innerHTML = "You test the <span>rope</span>, and then carefully lower yourself into the <span>well</span>...";
                room13Switch();
                roomNum = 13;
                break;
            case roomNum === 10 && ((inp("walk")||inp('go')||inp('travel')||(inp('take')&&inp('me')))   &&    (inp('down')))  || inp('south')  :
                room12Switch();
                userInput.value = "";
                roomNum = 12;
                break;

            // SPECIAL CASE FOR ROOM 13
            case roomNum === 13 && inp("go")   &&    inp('up') :
                userInput.value = "";
                room10Switch();
                roomNum = 10;
                break;
            case roomNum === 13 && (inp("walk")||inp('go')||inp('travel'))   &&    (inp('up')||inp('forward')||inp('straight')||inp('north'))   :  // XXX supposedly this doesn't return a value to output
                userInput.value = "";
                output.innerHTML = "There's nowhere to go!";
                break;
            
            // ROOM 14
            case roomNum === 14 &&    (inp('look')||inp('inspect')||inp('see ')||inp('search'))   &&    (inp('forest')||inp('around'))  && (newGame === true || inventory.length === 0 ) :
                output.innerHTML = "The glade is littered with beautiful <span>blue flowers</span>.<br><br>Type \"<span>pick flower</span>\" to put one in your <span>pockets</span>.<br><br>A narrow path leads <span>east</span> out of the glade.";
                break;
            case roomNum === 14 &&    (inp('look')||inp('inspect')||inp('see ')||inp('search'))   &&    (inp('forest')||inp('around')) :
                output.innerHTML = "The glade is littered with beautiful <span>blue flowers</span>.<br><br>A narrow path leads <span>east</span> out of the glade.";
                break;
            case roomNum === 14 &&    (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in <span>blue flowers>. There are some <span>rocks</span> strewn about too.";
                break;
            case roomNum === 14 &&   ( inp('jump') || inp('hop'))|| inp('fence') :
                output.innerHTML = "You start to jump the fence, but you suddenly realize that there's literally nothing on the other side, because nothing was programmed there, and you would simply float through a spaceless void for eternity.<br><br>You decide to stay on this side of the fence.";
                break;

            // ROOM 1
                // look around
            case roomNum === 1 &&  ( ( (inp('look')||inp('inspect')||inp('see ')||inp('search'))   &&    (inp('forest')||inp('around')) )  ||  (inp('what')&&inp('place'))  ):
                if (firstCutscene === false) {
                    playFirstCutscene();
                    firstCutscene = true;
                }
                output.innerHTML = "It's twilight. The <span>strange door</span> is standing in a grassy clearing surrounded by <span>trees</span> and scattered <span>rocks</span> and <span>flowers</span>.<br><br>To the <span>north</span> and <span>east</span> the forest grows dark and dense. To the <span>south</span>, you can hear the distant sound of water. To the <span>northwest</span> you can see a rocky outcropping.<br><br>Type \"<span>hint</span>\" if you get stuck.";
                break;
            case roomNum === 1 &&    (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass, with scattered <span>rocks</span> and <span>flowers</span>.";
                break;
                // try to open door
            case roomNum === 1 && doorUnlocked === false && haveBoxKey === false &&    (inp('open')||inp('try')||inp('use'))    &&    (inp('door')||inp('handle')||inp("knob"))  :
                output.innerHTML = "The <span>door</span> is locked.";
                break;
            case roomNum === 1   &&  doorUnlocked === false  && haveBoxKey === true && triedKeyOnDoor === false&&    (inp('unlock')||inp('key')||inp('open')||inp('try')||inp('use'))   &&    (inp('door')||inp('handle')||inp('knob'))  :
                output.innerHTML = "You try to unlock the <span>door</span> with the <span>key</span> you found down by the lake... but it doesn't fit the lock.<br><br>Darn it! Guess it isn't going to be that easy.<br><br>Maybe this <span>key</span> fits something else.";
                triedKeyOnDoor = true;
                break;
            case roomNum === 1    &&  doorUnlocked === false  && haveBoxKey === true  &&    (inp('unlock')||inp('key')||inp('open')||inp('try')||inp('use'))   &&    (inp('door')||inp('handle')||inp('knob'))  :
                output.innerHTML = "You try to unlock the <span>door</span> with the <span>key</span> you found down by the lake, but it doesn't fit the lock.<br><br>Now that you look closer, the <span>key</span> is shiny silver, but the lock on the <span>door</span> is a dull iron.<br><br>Maybe this <span>key</span> fits something else nearby.";
                break;
            case roomNum === 1    &&  doorUnlocked === false  &&    inp('unlock')   &&    (inp('door')||inp('handle'))   :
                output.innerHTML = "You don't have the <span>key</span>. Maybe it's nearby?";
                break;
                // inspect door
            case roomNum === 1 &&    (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check'))    &&    (inp('door')||inp('frame'))     :
                output.innerHTML = "The <span>door</span> is made of a dark wood, and it's <span>handle</span> and <span>lock</span> are iron. It's worn, but sturdy. Something tells you it's been here a long time.";
                break;
            case roomNum === 1 &&    (inp('beyond'))    &&    (inp('door')||inp('frame'))     :
                output.innerHTML = "You press your hand against the <span>door</span> and a chill goes up your spine.<br><br>There must be a way to open it...<br><br>Type commands below to explore the forest. You can move around quicker by tapping the corners of the screen above.<br><br>Don't forget to type<span>look around</span> when you enter a new area.";
                break;
            case roomNum === 1 &&    (inp('behind')||inp('other side'))    &&    (inp('door')||inp('frame'))     :
                output.innerHTML = "You walk all the way around the <span>door frame</span>, but it's not connected to anything.";
                break;
            case roomNum === 1 &&    (inp('look')||inp('inspect')||inp('see ')||inp('try'))   &&    (inp('lock')||inp('handle')||inp('knob'))     :
                output.innerHTML = "The door's gnob and lock are simple and a bit rusty, but strong. You try to push it open, but it won't budge.";
                break;
                // weird attemps
            case roomNum === 1 &&  inp ("ask") && inp('please') :
                output.innerHTML = "You ask the <span>door</span> nicely to open, but nothing happens. You feel kind of silly for talking to a door.";
                break;
            case roomNum === 1 &&  inp ("sesame") :
                output.innerHTML = "'One Thousand and One Arabian Nights', huh? Good stuff.<br><br>The door still doesn't open, and now you kind of want a bagel.";
                break;
            case roomNum === 1 &&  inp ("password") :
                output.innerHTML = "You say aloud every weird phrase, magical word, or secret-agent style code you can think of, but the door stubbornly remains closed.";
                break;
            case roomNum === 1 &&  inp ("flower") && inp('door'):
                output.innerHTML = "You offer the <span>door</span> a </span>, but it doesn't seem interested.";
                break;
            case roomNum === 1 &&    inp('knock') :
                output.innerHTML = "You knock on the door, but nothing happens. I guess no one is home";
                break;
            case roomNum === 1 &&    (inp('who') && inp('there')) || inp('nok'):
                output.innerHTML = "Lol you thought";
                break;
            case roomNum === 1  && doorUnlocked === false&&    (inp('take')||inp('grab')||inp('pocket'))    &&    (inp('door')||inp('handle')||inp("knob"))    :
                output.innerHTML = "You don't have magical pockets, just regular ones. so the <span>door</span> probably isn't going to fit. Besides, it's pretty solid and doesn't look like it's going to be easily moved.";
                break;
            case roomNum === 1  && doorUnlocked === false &&    (inp('hit')||inp('break')||inp('smash')||inp('rock')||inp('kick')||inp('ram ')||inp('bust')||inp('bash')||inp('punch'))    &&    (inp('door')||inp('handle')||inp("knob"))   :
                output.innerHTML = "You pick up a <span>rock</span> and give the <span>door</span> a real good whack. Seriously, you wind up and really lean into it.<br><br>But the <span>door</span> doesn't budge. You didn't even really dent the wood. That's a bummer.<br><br>Can doors can be angry? This <span>door</span> seems angry.";
                break;
            case roomNum === 1 &&    (inp('thru') || inp('through') || inp('walk') || inp('into') || (inp('in')&&inp('to'))) && inp('door'):
                output.innerHTML = "The <span>door</span> is closed. You try the handle, but it's locked.";
                break;
            case roomNum === 1 && inp('pick') && inp('lock') :
                output.innerHTML = "You find a stick and fiddle around with the lock for a bit, but no luck.<br><br>Guess it's not as easy as those adventure novels made it out to be.";
                break;
                // catch-all for door
            case roomNum === 1 && inp('door') :
                output.innerHTML = "The <span>door</span> is made of a dark wood, and it's <span>handle</span> and <span>lock</span> are iron. It's worn, but sturdy. Something tells you it's been here a long time.";
                break;
            case roomNum === 1 && doorUnlocked === false && (inp('knob')||inp('handle')) :
                output.innerHTML = "You try the <span>door knob</span>, but it's locked.";
                break;
            case roomNum === 1 && inp('lock') && haveBoxKey === false:
                output.innerHTML = "You wiggle the handle, but the <span>door</span> is securely locked.";
                break;
            case roomNum === 1 && inp('lock') && haveBoxKey === true:
                output.innerHTML = "You try to use the <span>silver key</span> to unlock the door, but it doesn't fit. Drat.";
                break;

            // ROOM 3
            case roomNum === 3 &&    (inp('look')||inp('inspect')||inp('see ')||inp('search'))   &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "The forest is a bit darker here. There is a <span>stump</span> in the middle of the clearing with an old discarded <span>notebook</span> alongside.<br><br>To the <span>north</span>, an overgrown path leads deeping into the forest. To the <span>south</span> you can hear the sound of running water.<br><br>The forest is too dense to travel any further east from here.";
                break;
            case roomNum === 3 &&    (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('behind')||inp('under'))    &&    (inp('stump'))   && foundBook === true  :
                output.innerHTML = "Looks like a good place to sit and rest. You wonder how long ago the tree was cut down, but you're stumped.";
                break;
            case roomNum === 3 &&    (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check'))    &&    (inp('book')||inp('journal')||inp('diary'))   && foundBook === true  :
                output.innerHTML = "The <span>journal</span> has a worn leather cover.<br><br>The pages inside are water damaged, but the hand-written ink is still legibled.<br><br>There's no title, and no author.";
                showBookButton("> Read Journal?");
                readingAsk = true;
                break;
            case roomNum === 3 &&    inp('read')    &&    (inp('book')||inp('journal')||inp('diary'))   :
                output.innerHTML = "You pick up the <span>journal</span>."
                showBookButton("> Read Journal?");
                readingAsk = true;
                break;
            case roomNum === 3 &&    (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check'))    &&    (inp('book')||inp('journal')||inp('diary'))   && foundBook === false  :
                output.innerHTML = "There's a <span>book</span> on the ground in front of the stump. It looks like somebody used this spot to sit and read or write.";
                showBookButton("> Read Journal?");
                readingAsk = true;
                foundBook = true;
                break;
            case roomNum === 3 &&    (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check')||inp('behind')||inp('under'))    &&    inp('stump')   && foundBook === false  :
                output.innerHTML = "There's a <span>book</span> on the ground in front of the stump. It looks like somebody used this spot to sit and read or write.";
                foundBook = true;
                break;
            case roomNum === 3 &&    (inp('take')||inp('grab')||inp('pocket'))    &&    (inp('book')||inp('journal')||inp('diary'))   :
                output.innerHTML = "The <span>book</span> seems rather personal. You decide to leave it here in case somebody comes back for it.";
                showBookButton("> Read Journal?");
                readingAsk = true;
                foundBook = true;
                break;
            case roomNum === 3 &&    (inp('sit')||inp('rest'))     :
                output.innerHTML = "You sit down on the stump to rest for a minute. It's comfier than you would have thought.<br><br>+30 points";
                break;
            case roomNum === 3 &&    (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass, with scattered rocks and flowers.<br><br>There is a <span>old book</span> on the ground near the stump.";
                break;

            // ROOM 2
            case roomNum === 2 &&    (inp('look')||inp('inspect')||inp('see ')||inp('search'))   &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "The forest is dark and overgrown here, and the the air is filled with <span>fireflies</span> that bathe the woods in a warm light.<br><br>To the <span>east</span>, a narrow path leads down into a murky hollow. A wooded glen lies to the <span>west</span>.";
                if (firefliesSeen === false) {
                    //playFireflyCutscene();
                    firefliesSeen = true;
                };
                break;
            case roomNum === 2 &&    (inp('inspect')||inp('see ')||inp('look')||inp('search'))    &&    (inp('fire'))     :
                output.innerHTML = "You've never seen <span>fireflies</span> this bright before! They illuminate the whole forest.";
                if (firefliesSeen === false) {
                    //playFireflyCutscene();
                    firefliesSeen = true;
                };
                break;
            case roomNum === 2 && (inp('box')||inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get'))   &&    inp('fire')  &&  boxUnlocked === true  && haveFireflies === false :
                output.innerHTML = 'You catch a <span>firefly</span>, and very carefully put it in the <span>box</span> and close the lid.<br><br>You catch another, and another... and pretty soon the <span>box</span> is full of <span>fireflies</span>!';
                removeItem("a <span>wooden box</span>");
                removeItem("a <span>smashed-up box</span>");
                inventory.push("a <span>box of fireflies</span>");
                haveFireflies = true;
                switchChestRopeImage();
                break;
            case roomNum === 2 && (inp('box')||inp('chest')||inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get'))   &&    inp('fire')  &&  haveFireflies === true :
                output.innerHTML = 'The <span>box</span> is already full of <span>fireflies</span>!';
                break;
            case (roomNum === 2 || (roomNum === 7 && firefliesReleased === true)) && (inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get')||inp('grab'))   &&    inp('fire') && (inp('mug')||inp('cup')) && haveMug === true  :
                output.innerHTML = 'You catch a <span>firefly</span> and put it in the <span>mug</span>, but as soon as you take your hand away it flies away.<br><br>Maybe there is something else nearby you can keep the <span>fireflies</span> in.';
                break;
            case roomNum === 2 && (inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get')||inp('grab'))   &&    inp('fire')  && haveBox === false  :
                output.innerHTML = 'After a couple attempts, you catch a <span>firefly</span> in you hands. You cup it gently and its soft glow illuminates your fingers. After a few moments, you release it to join the others.<br><br>"If only I had somewhere to keep it," you think.';
                break;
            case roomNum === 2 && (inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get')||inp('grab'))   &&    inp('fire')  && haveBox === true  :
                output.innerHTML = 'After a couple attempts, you catch a <span>firefly</span> in you hands. You cup it gently and its soft glow illuminates your fingers. After a few moments, you release it to join the others.<br><br>"I bet I could keep some of them in this <span>box</span> if I get it open," you think.';
                break;
            case roomNum === 2 &&    (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass with scattered rocks and such. You don't find anything of use.";
                break;

            // ROOM 4
                // look around
            case roomNum === 4   && catDiscovered === false   &&    (inp('look')||inp('inspect')||inp('see ')||inp('search'))   &&    (inp('forest')||inp('around')) :
                output.innerHTML = "A big tree stands in the middle of a wooded glade.<br><br><span>Something</span> is rustling around up in the tree's branches...<br><br>To the <span>south</span>, you can see the clearing with the <span>strange door</span>. Paths going <span>west</span> and <span>east</span> lead deeper into the forest.<br><br>The forest is too dense to go further north.";
                break;
            case roomNum === 4    && marbleDown === false   &&    (inp('look')||inp('inspect')||inp('see ')||inp('search'))   &&    (inp('forest')||inp('around'))  :
                output.innerHTML = "A big tree with a <span>cat</span> in it standing the middle of the glade.";
                break;
            case roomNum === 4 &&   marbleReunited === false &&   (inp('look')||inp('inspect')||inp('see ')||inp('search'))   &&    (inp('forest')||inp('around'))   :
                output.innerHTML = "The black and white <span>cat</span> is playing with the <span>ribbon</span> under the big tree.";
                break;
            case roomNum === 4 &&    (inp('look')||inp('inspect')||inp('see ')||inp('search'))   &&    (inp('forest')||inp('around'))   :
                output.innerHTML = "A big tree stands in the middle of the glade.";
                break;
                // check ground
            case roomNum === 4  &&   (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass with scattered rocks and such. You don't find anything of use.";
                break;
                // ribbon and play
            case roomNum === 4  && marbleDown === false && haveRibbon === true &&    (inp('play')|| ( ( inp('cat')||inp('use')||inp('give')||inp('wave')) && inp('ribbon')) ):
                playMarbleCutscene();
                catDiscovered = true;
                marbleDown = true;
                haveRibbon = false;
                removeItem("a <span>red ribbon</span>");
                room4Switch();
                output.innerHTML = "The moment you pull the <span>red ribbon</span> out of your pocket, the <span>cat</span> perks up.<br><br>You drag the <span>ribbon</span> across the ground, and leaps from the tree!";
                break;
            case ( (roomNum === 4 && marbleDown === true) || ( roomNum === 12 && marbleReunited === true ) ) &&  (   inp('play')  ||  (inp('cat')||inp('use')) && inp('ribbon')   ) :
                output.innerHTML = "You grab the <span>ribbon</span> and wave it around for the <span>cat</span>. Is there anything better than this?";
                break;
            case roomNum === 4 && marbleDown === true && marbleReunited === false && (inp('pet')||inp('stroke')||inp('purr')||inp('scratch')||inp('rub')||inp('scritch'))  :
                output.innerHTML = "The <span>cat</span> leans up against you leg and begins to purr.<br><br>+40 points";
                break;
                // attempts at play
            case roomNum === 4  && marbleDown === false && haveFlower === true  &&    (inp('play')||inp('cat') )  &&    inp('flower')   :
                catDiscovered = true;
                output.innerHTML = "You use the <span>flower</span> to try to get the <span>cat's</span> attention. It seems vaguely interested for a moment, but quickly loses interest.<br><br>Maybe you can find something it likes more to play with.";
                break;
            case roomNum === 4   && marbleDown === false  && haveRibbon === true   &&    inp('play')   &&    inp('cat')    :
                catDiscovered = true;
                output.innerHTML = "You try to get the attention of the <span>cat</span>, but it doesn't seem that interested in you.<br><br>Maybe you have <span>something</span> in your pockets it would like to play with?";
                break;
            case roomNum === 4    && marbleDown === false   &&    inp('play')   &&    inp('cat')  :
                catDiscovered = true;
                output.innerHTML = "You try to get the attention of the <span>cat</span>, but it doesn't seem that interested in you.<br><br>Maybe you can find <span>something</span> to play with...";
                break;
            case roomNum === 4 && marbleDown === false &&  (inp('pet')||inp('stroke')||inp('purr')||inp('scratch')||inp('rub')||inp('scritch'))  :
                output.innerHTML = "If only you could reach :(";
                break;
                // other weird attempts
            case roomNum === 4    && marbleDown === false && haveRope === true  &&    inp('rope')   :
                catDiscovered = true;
                output.innerHTML = "You toss one end of the <span>rope</span> up to the <span>cat</span>, but it doesn't really seem interested.";
                break;
            case roomNum === 4    && marbleDown === false && haveRope === true  &&  (  inp('call') || inp('here kitt') || (inp('come')&&inp('down')) ) :
                catDiscovered = true;
                output.innerHTML = "Your best efforts at summoning the <span>cat</span> are entirely in vain.";
                break;
            case roomNum === 4    && marbleDown === false && haveRope === true  &&   ( inp('get')||inp('take')) && inp('cat')  :
                catDiscovered = true;
                output.innerHTML = "The <span>cat</span> doesn't seem like it wants to go anywhere.";
                break;
            case roomNum === 4    && marbleDown === false && haveRope === true  &&   ( inp('ask')||inp('please')||inp('plead')||inp('beg') ) :
                catDiscovered = true;
                output.innerHTML = "You ask the <span>cat</span> nicely to come down. It just rolls it's eyes.";
                break;
            case roomNum === 4    && marbleDown === false && haveRope === true  &&    (inp('shake') ||inp('push') ||inp('jostle')) :
                catDiscovered = true;
                output.innerHTML = "You push against the tree trunk with all your might, but boy oh boy is this tree putting up a fight. Your best efforts hardle move it.";
                break;
            case roomNum === 4    && marbleDown === false && haveRope === true  &&    inp('sneak')   :
                catDiscovered = true;
                output.innerHTML = "You tip-toe towards the tree and, quietly as you can, start to climb, but your foot snaps a twig.<br><br>The <span>cat</span> swats at you and you lose your footing and come crashing down. Ouch!";
                break;
            case roomNum === 4 &&   marbleDown === false  && marbleReunited === false && inp('talk')  :
                catDiscovered = true;
                output.innerHTML = "The <span>cat</span> doesn't really seem interested in talking.";
                break;
            case roomNum === 4  && marbleDown === false &&  (inp('throw')||inp('toss')||inp('hit')||inp('kill'))   ||    (inp('rock')||inp('pebble')||inp('stone')) && inp('cat')   :
                catDiscovered = true;
                output.innerHTML = "You throw a <span>rock</span> at the <span>cat</span> like the big jerk you are. The <span>cat</span> dodges out of the way and hisses, while the universe silently judges you.<br><br>-50 points";
                break;
            case roomNum === 4  && marbleDown === false &&  (inp('throw')||inp('toss')||inp('hit'))   ||    (inp('stick')) && inp('branch')   :
                catDiscovered = true;
                output.innerHTML = "You throw a <span>stick</span> at the <span>cat</span> like the big jerk you are. The <span>cat</span> dodges out of the way and hisses, while the universe silently judges you.<br><br>-50 points";
                break;
            case roomNum === 4  && marbleDown === false &&  (inp('pull')||inp('grab')||inp('hit')||inp('ask')||inp('lure')||inp('tease')||inp('take')) && inp('cat')   :
                catDiscovered = true;
                output.innerHTML = "The <span>cat</span> isn't interested in cooperating.";
                break;
            case roomNum === 4  && marbleDown === false &&  (inp('fight')||inp('punch')) && inp('cat')   :
                catDiscovered = true;
                output.innerHTML = "The <span>cat</span> gives you a look, like \"Come at me, bro.\".";
                break;
                // inspecting cat
            case roomNum === 4   &&  marbleDown === false  && marbleReunited === false &&  (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check'))  && inp('cat')  :
                catDiscovered = true;
                output.innerHTML = "The <span>cat</span> eyes you casually. It's relaxing on one of the tallest branches of the tree. It seems perfectly content where it is.";
                break;
            case roomNum === 4   &&  marbleDown === true  && marbleReunited === false &&  (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check'))  && inp('cat')  :
                catDiscovered = true;
                output.innerHTML = "The black and white <span>cat</span> is preocuppied with the <span>red ribbon</span>.";
                break;
                // searching the tree
            case roomNum === 4  &&  marbleDown === false  && (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check')||inp('what')||inp('behind')||inp('under'))   &&    (inp('tree')||inp('branch'))     :
                output.innerHTML = "You look up into the tree... There's a <span>cat</span> up there! ...it doesn't seem to want to come down.";
                catDiscovered = true;
                break;
            case roomNum === 4  && marbleDown === false   && catDiscovered === true   && inp('climb')  &&    inp('tree') :
                output.innerHTML = "You start to climb the tree, but the <span>cat</span> hisses and swipes a paw at you. Rude!";
                break;
            case roomNum === 4  && marbleDown === false  &&  inp('climb')  &&    inp('tree')  :
                output.innerHTML = "You start to climb the tree... but there's a <span>cat</span> in the tree! It hisses and swipes a paw at you. Rude!";
                catDiscovered = true;
                break;
                // psp       XXX it would be funny if this worked
            case roomNum === 4  && marbleDown === false &&  inp('psp')   :
                catDiscovered = true;
                output.innerHTML = "The <span>cat</span> eyes you curiously...";
                break;
            case roomNum === 4  && marbleReunited === false &&  inp('psp')   :
                catDiscovered = true;
                output.innerHTML = "<span>Meow!!</span>";
                break;
                // catch-all for trees
            case roomNum === 4  && inp('tree')  :
                output.innerHTML = "There's a tall tree in the center of the glade. It looks like a perfect home for an animal.";
                break;
                // catch-all for cat
            case roomNum === 4  && inp('cat ')  && marbleReunited === false && catDiscovered === false :
                output.innerHTML = "There's a cat in the tree!";
                catDiscovered = true;
                break;
            case roomNum === 4  && inp('cat ')  && marbleReunited === false && catDiscovered === false :
                output.innerHTML = "The cat is black with white socks.";
                break;

            // ROOM 5
            case roomNum === 5 &&    (inp('look')||inp('inspect')||inp('see ')||inp('search'))   &&    (inp('forest')||inp('around'))     :
                if (lakeDiscovered === false) {
                    // playBeachCutscene();
                    lakeDiscovered = true;
                };
                output.innerHTML = "The lakeshore is scattered with large <span>rocks</span>. Small pieces of driftwood and other debris have washed in on the tide.<br><br>The lake is really wide... You can't see the other side.";
                break;
            case roomNum === 5 &&   (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check'))    &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('stream')||inp('ocean')||inp('bank')||inp('beach')) && haveBoxKey === false  && waterSearchedOnce === false   :
                if (lakeDiscovered === false) {
                    // playBeachCutscene();
                    lakeDiscovered = true;
                };
                waterSearchedOnce = true;
                output.innerHTML = "The water is cool and clear, and a few fish drift lazily along.<br><br>You think you spy <span>something</span> shining under the water near the <span>rocks</span>.";
                break;
            case roomNum === 5 &&  haveBoxKey === false && boxSmashed < 3 && (inp('search')||inp('inspect')||inp('see ')||inp('look')||inp('check'))   &&    (inp('creek')||inp('river')||inp('lake')||inp('stream')||inp('ocean')||inp('bank')||inp('beach')||inp('water')||inp('rock')||inp('stone')||inp('pebble')||inp("shore")||(inp('drift')&&inp('wood')))    :
                output.innerHTML = "You find a <span>key</span> in the <span>rocks</span> by the shore. You put the <span>key</span> in your <span>pocket</span>.<br><br>Type \"<span>pockets</span>\" to see what you have with you.";
                haveBoxKey = true;
                inventory.push("a <span>silver key</span>");
                break;
            case roomNum === 5 &&  haveBoxKey === false &&  (inp('search')||inp('inspect')||inp('see ')||inp('look')||inp('check'))   &&    (inp('creek')||inp('river')||inp('lake')||inp('stream')||inp('ocean')||inp('bank')||inp('beach')||inp('water')||inp('rock')||inp('stone')||inp('pebble')||inp("shore")||(inp('drift')&&inp('wood')))    :
                output.innerHTML = "You find a <span>key</span> in the rocks by the shore! Too bad you already smashed the open <span>box</span>, so now it's worthless.<br><br>...Or is it...?<br><br>...It is.";
                haveBoxKey = true;
                inventory.push("a <span>silver key</span>");
                break;
            case roomNum === 5 &&    (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass, with scattered <span>rocks</span> and <span>flowers</span>.";
                break;

            // ROOM 6
                // B.S.
            case roomNum === 6 &&  ropeTaken === false && (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check'))   &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('stream')||inp('ocean')||inp('bank')||inp('shore')||inp('beach'))     :
                if (lakeDiscovered === false) {
                    // playBeachCutscene();
                    lakeDiscovered = true;
                };
                output.innerHTML = "The water is cool and clear, and a few fish drift lazily along.<br><br>There is an old half-sunk <span>boat</span> tied up near the shore.";
                break;
            case roomNum === 6 &&  ropeTaken === true && (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check'))   &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('stream')||inp('ocean')||inp('bank')||inp('shore')||inp('beach'))     :
                if (lakeDiscovered === false) {
                    // playBeachCutscene();
                    lakeDiscovered = true;
                };
                output.innerHTML = "The water is cool and clear, and a few fish drift lazily along.<br><br>There is an old half-sunk <span>boat</span> near the shore.";
                break;
            case roomNum === 6 &&  ropeTaken === false &&  (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check'))   &&    (inp('forest')||inp('around'))     :
                if (lakeDiscovered === false) {
                    // playBeachCutscene();
                    lakeDiscovered = true;
                };
                output.innerHTML = "You find yourself on the eastern shore of a lake. There is a <span>boat</span> tied to a mooring nearby, but it doesn't exactly look seaworthy.<br><br>A wooded path leads <span>north</span> into the forest.";
                break;
            case roomNum === 6 &&  ropeTaken === true &&  (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check'))   &&    (inp('forest')||inp('around'))     :
                if (lakeDiscovered === false) {
                    // playBeachCutscene();
                    lakeDiscovered = true;
                };
                output.innerHTML = "You're standing on the shore of a lake. There is a <span>boat</span> nearby, but it doesn't exactly look seaworthy.";
                break
            case roomNum === 6 &&    (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass with scattered rocks and such.";
                break;
            case roomNum === 6 &&  (inp('get')||inp('take')||inp('ride'))   &&    (inp('boat'))   && haveBox === false  :
                output.innerHTML = "The <span>boat</span> is full of holes and is mostly under water. Besides, the paddles are nowhere to be seen.<br><br>You find a <span>locked wooden box</span> in the bottom of the boat, and put it in your <span>pockets</span>.";
                haveBox = true;
                switchChestRopeImage();
                inventory.push("a <span>wooden box</span>");
                break;
            case roomNum === 6 &&  (inp('get')||inp('take')||inp('ride'))   &&    (inp('boat'))   && haveBox === true  :
                output.innerHTML = "The <span>boat</span> is full of holes and is mostly under water. Besides, the paddles are nowhere to be seen.";
                break;
            case roomNum === 6 &&  (inp('fix')||inp('repair')||inp('mend')||inp('patch'))   &&    (inp('boat'))  && haveBox === false   :
                output.innerHTML = "The <span>boat</span> is way too busted up to fix. It's honestly hardly even a boat at this point.<br><br>You find a <span>locked wooden box</span> in the bottom of the boat, and put it in your <span>pockets</span>.";
                haveBox = true;
                switchChestRopeImage();
                inventory.push("a <span>wooden box</span>");
                break;
                break;
            case roomNum === 6 &&  (inp('fix')||inp('repair')||inp('mend')||inp('patch'))   &&    (inp('boat')) && haveBox === true    :
                output.innerHTML = "The <span>boat</span> is way too buested up to fix. It's honestly hardly even a boat at this point.";
                break;
            // boat/box
            case roomNum === 6 &&   haveBox === false  &&  (inp('inspect')||inp('see ')||inp('search')||inp('check')||inp('what')||inp('bottom')||inp('behind')||inp('under'))   &&    (inp('boat'))     :
                output.innerHTML = "You look into the bottom of the <span>boat</span> and find a <span>locked wooden box</span>.<br><br>You put the <span>box</span> in your <span>pocket</span>.<br><br>Type \"<span>pockets</span>\" to see what you have with you.";
                haveBox = true;
                switchChestRopeImage();
                inventory.push("a <span>wooden box</span>");
                break;
            case roomNum === 6   && ropeTaken === false && haveBox === false && (inp('look')||inp('inspect'))  &&    (inp('boat')||inp('moor'))  :
                output.innerHTML = "The <span>boat</span> is half-sunk, and the paddles are nowhere to be seen. The wood on the bottom is almost completely rotted through, and it's tied to the shore with a thick <span>rope</span>.<br><br>You find a <span>locked wooden box</span> in the bottom of the boat, and put it in your <span>pockets</span>.";
                haveBox = true;
                switchChestRopeImage();
                inventory.push("a <span>wooden box</span>");
                break;
            case roomNum === 6   && ropeTaken === false && haveBox === true && (inp('look')||inp('inspect'))  &&    (inp('boat')||inp('moor'))  :
                output.innerHTML = "The <span>boat</span> is half-sunk, and the paddles are nowhere to be seen. The wood on the bottom is almost completely rotted through.<br><br>It's tied to the shore with a thick <span>rope</span>.";
                break;
            case roomNum === 6   && ropeTaken === true && haveBox === false && (inp('look')||inp('inspect'))  &&    (inp('boat')||inp('moor'))  :
                output.innerHTML = "The <span>boat</span> is half-sunk, and the paddles are nowhere to be seen. The wood on the bottom is almost completely rotted through, but it looks like there might be <span>something</span> stuck in the bottom.";
                break;
            case roomNum === 6   && ropeTaken === true &&  (inp('look')||inp('inspect'))  &&    (inp('boat')||inp('moor'))  :
                output.innerHTML = "The <span>boat</span> is half-sunk, and the wood on the bottom is almost completely rotted through. The paddles are nowhere to be seen.";
                break;
            case roomNum === 6  && haveBox === true  && ropeTaken === false && (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check')||inp('what')||inp('under')||inp('behind'))   &&    (inp('boat')||inp('moor'))   :
                output.innerHTML = "The <span>boat</span> is half-sunk and looks ancient. The wood on the bottom is almost completely rotted through, and the paddles are nowhere to be seen.<br><br>It\'s tied to the shore with a thick <span>rope</span>.";
                break;
            case roomNum === 6  && haveBox === true  &&  (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check')||inp('what')||inp('behind')||inp('under'))   &&    (inp('boat')||inp('moor'))   :
                output.innerHTML = "The <span>boat</span> is half-sunk and looks ancient. The wood on the bottom is almost completely rotted through, and the paddles are nowhere to be seen.";
                break;
            //rope
            case roomNum === 6 &&   ropeTaken === false &&    (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check'))   &&    (inp('rope'))     :
                output.innerHTML = "The <span>rope</span> seems to be the only thing about the boat that is still in decent condition.";
                break;
            case roomNum === 6    && ropeTaken === false && (    ((inp('take')||inp('grab')||inp('pocket')||inp('remove')||inp('get')||inp('use')||inp('tie'))   &&    (inp('rope')))  ||  (inp('tie') &&  inp('boat'))  ):
                haveRope = true;
                ropeTaken = true;
                inventory.push("a <span>rope</span>")
                room6Switch();
                switchChestRopeImage();
                output.innerHTML = "You untie the <span>rope</span> and put it in your <span>pocket</span>.<br><br>Type \"<span>pockets</span>\" to see what you have with you.";
                break;
            case roomNum === 6 && ropeTaken === true && (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check'))   &&    (inp('rope'))     :
                output.innerHTML = "The <span>rope</span> is gone. You took it, remember?";
                break;
            case roomNum === 6 &&   ropeTaken === true && (inp('take')||inp('grab')||inp('pocket')||inp('get'))   &&    (inp('rope'))     :
                output.innerHTML = "You already took the <span>rope.</span>";
                break;    
            case roomNum === 6 && haveRope === true && inp('rope'):
                output.innerHTML = "You don't need to use the <span>rope</span> here.";
                break;

            // ROOM 7
                // inspect / explore dark
            case roomNum === 7  && firefliesReleased === false &&  (inp('look'))   &&    (inp('cave')||inp('around')) :
                output.innerHTML = "You strain your eyes against the dark, but you can barely see your hand when you wave it in front of your eyes.";
                break;
            case roomNum === 7 && (inp('rope'))  && firefliesReleased === false && haveRope === true :
                output.innerHTML = "You tie one end of the <span>rope</span> to a rock near the <span>cave</span> entrance and hold the other end as you walk into the darkness.<br><br>With your hands out in front of you, you slowly feel your way through through the maze of rock. Some of the walls around you feel rough and stoney, while others feel smooth and glassy.<br><br>Eventually you reach the end of the <span>rope</span>. Before you turn back, you fumble around the ground and grab a strange <span>glassy rock</span> and put it in your <span>pockets</span>.";
                inventory.push("a <span>strange crystal</span>");
                haveCrystal = true;
                break;
            case roomNum === 7 && (inp('rope'))  && firefliesReleased === true && haveRope === true :
                output.innerHTML = "You check around the cave, but it doesn't seem like the <span>rope</span> will be much help right now.";
                break;
            case roomNum === 7 &&  (inp('feel'))   &&    (inp('cave')||inp('around')||inp('wall')) && firefliesReleased === false :
                output.innerHTML = "The walls of the <span>cave</span> are rough rock. You feel your way forward as far as you can, but the light starts to disappear behind so you turn around and head back.";
                break;
            case roomNum === 7 &&  (inp('inspect')||inp('see ')||inp('search')||inp('check')||inp('look'))   &&    (inp('cave')||inp('around')) && firefliesReleased === false :
                output.innerHTML = "You feel your way around the <span>cave</span>. The ground is rocky and the walls smooth. It's much too dark to see anything...<br><br>You fumble around for a while, until you smash your shin against something hard and abandon your search.";
                break;
                // inspect / explore light
            case roomNum === 7 &&  (inp('look'))   &&    (inp('cave')||inp('around')) && firefliesReleased === true :
                output.innerHTML = "The cave is full of glowing <span>crystals</span>! The light from the <span>fireflies</span> catches every surface and facet of the magnificent gems.<br><br>There is another passageway leading <span>west</span>.";
                break;
            case roomNum === 7 &&  (inp('inspect')||inp('see ')||inp('search')||inp('check'))   &&    (inp('cave')||inp('around')) && firefliesReleased === true :
                output.innerHTML = "The cave is full of magnificent glowing <span>crystals</span> protruding from the walls and littering the ground.<br><br>There is another passageway leading <span>west</span>";
                break;
            case roomNum === 7 &&  inp('stala') && firefliesReleased === true :
                output.innerHTML = "The cave is full of dripping stalactites and stalagmites. You used to have a hard time telling them apart, until you learned this helpful mnemonic device:<br><br>'Satactites' hang TIGHT from the ceiling, but be careful of stalagmites: you MIGHT trip over them!";
                break;
                // interact with crystal
            case roomNum === 7 &&  (inp('inspect')||inp('see ')||inp('search')||inp('check')||inp('look')||inp('behind'))   &&    (inp('crystal')||inp('gem')||inp('diamonds')) && firefliesReleased === true :
                output.innerHTML = "There are abudnances of <span>crystals</span> in every corner of the cave.";
                break;
            case (roomNum === 7 || roomNum === 8) &&  (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab'))  && (inp('crystal')||inp('gem')||inp('diamonds')) && firefliesReleased === true :
                output.innerHTML = "You pick up a small piece of <span>crystal</span> off the ground. Your fingers tingle when you touch it, and it's surprisingly warm in your hand. It seems to magnify the light from the <span>fireflies</span>.<br><br>You put the <span>crystal</span>in your <span>pocket</span>.";
                inventory.push("a <span>strange crystal</span>");
                haveCrystal = true;
                break;
            case (roomNum === 7 || roomNum === 8) &&  (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab'))  && (inp('crystal')||inp('gem')||inp('diamonds')) && firefliesReleased === true  && haveCrystal === true  :
                output.innerHTML = "You already have a <span>crystal</span> in your <span>pocket</span>.";
                break;
            case roomNum === 7 && firefliesReleased===true && (inp('box')||inp('catch')||inp('take')||inp('gather')||inp('grab')||inp('get'))   &&    inp('fire')  &&  boxUnlocked === true  && haveFireflies === false :
                output.innerHTML = 'You catch a <span>firefly</span>, and very carefully put it in the <span>box</span> and close the lid.<br><br>You catch another, and another... and pretty soon the <span>box</span> is full of <span>fireflies</span>!';
                removeItem("a <span>wooden box</span>");
                removeItem("a <span>smashed-up box</span>");
                inventory.push("a <span>box of fireflies</span>");
                haveFireflies = true;
                switchChestRopeImage();
                break;
            case roomNum === 7 &&  firefliesReleased===true &&  (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The cave floor is a rough stone, and covered in stalagmites and <span>crystals</span>";
                break;
            case roomNum === 7 &&    (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "It's too dark to see anything.";
                break;
            case (roomNum === 7 || roomNum === 8) && (inp('exit')||inp('leave'))   &&    (inp('cave')) :
                room11Switch();
                roomNum = 11;
                userInput.value = "";
                break;

            // ROOM 9
                // look around
            case roomNum === 9  && (ghostDiscovered === false || ghostGivenMug === true)  &&  (inp('look')||inp('inspect')||inp('see ')||inp('search'))   &&    (inp('forest')||inp('around'))  :
                output.innerHTML = "You find yourself in what be one of the most ancient parts of the forest. The trees here look like they haven't seen sunlight in years.<br><br>There is a circle of <span>mushrooms</span> in the middle of the hollow, surrounded by old and rotting trees.";
                break;
            case roomNum === 9 &&  (inp('look')||inp('inspect')||inp('see ')||inp('search'))   &&    (inp('forest')||inp('around'))   :
                output.innerHTML = "There is a <span>ghostly figure</span> hovering in a circle of mushrooms<br><br>This must be the oldest part of the forest. The trees here look like they haven't seen sunlight in years.";
                break;
                // take / inspect mushrooms & discover ghost
            case roomNum === 9 && ghostDiscovered === false   &&  (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check')||inp('take')||inp('grab')||inp('pocket')||inp('eat')||inp('behind'))   &&    (inp('mushroom')||inp('circle'))  :
                playGhostCutscene();
                ghostDiscovered = true;
                room9Switch();
                output.innerHTML = "You reach for a <span>mushroom</span>...<br><br>but a <span>ghost</span> appears!!<br><br>It seems like it's guarding the mushrooms.";
                break;
                // take mushrooms after ghost given mug
            case roomNum === 9 && ghostGivenMug === true && ( (inp('take')||inp('grab')||inp('pocket')||inp('gather')||inp('pick'))  || (inp('eat')&&haveMushy === false)   )  &&    (inp('mushroom')||inp('circle'))  :
                output.innerHTML = 'You pick a nice looking <span>mushroom</span> and put it in your pocket.';
                haveMushy = true;
                inventory.push('a <span>wild mushroom</span>');
                break;
                // ghost interupts mushroom picking
            case roomNum === 9 && ghostDiscovered === true  && ghostGivenMug === false  &&  (inp('search')||inp('take')||inp('grab')||inp('pocket')||inp('eat')||inp('gather')||inp('pick'))   &&    (inp('mushroom')||inp('circle'))  :
                output.innerHTML = 'You take a step towards the mushrooms, but the <span>ghostly figure</span> gives you an icy stare that freezes you in your tracks.<br><br>A voice whispers...<br><br>"<span class="journal">Moon... cactus...</span>"<br><br>What could that mean?';
                break;
                // look at mushrooms
            case roomNum === 9 &&  (inp('look')||inp('inspect')||inp('see ')||inp('check'))   &&    (inp('mushroom')||inp('circle')) :
                output.innerHTML = 'The <span>mushrooms</span> are red with white spots. You can\'t decide whether they look delicious, or deadly.';
                break;
                // give ghost mug
            case roomNum === 9 && ghostDiscovered === true  && ghostGivenMug === false && haveMug === true  && ( (inp('give')||inp('hand')||inp('offer')||inp('return')||inp('show')||inp('use'))   &&   ( inp('mug')||inp('cup') ) ) ||  ( ( inp('mug')||inp('cup') ) && ( (inp('ghost')||inp('figure'))) ) :
                output.innerHTML = 'You take a step towards the mushrooms, but the <span>ghostly figure</span> gives you an icy stare that freezes you in your tracks.<br><br>A voice whispers...<br><br>"<span class="journal">Moon... cactus...</span>"<br><br>What could that mean?';
                ghostGivenMug = true;
                haveMug = false;
                playGhostMugCutscene();
                room9Switch();
                removeItem("an <span>old mug</span>");
                output.innerHTML = 'The <span>ghost</span> fades away, and you catch a faint whisper in the wind:<br><br>"<span class="journal">Thanks for caring...</span>"<br><br>Maybe it\'s just your imagination, but it suddenly seems like the forest around you is a bit brighter.<br><br>+75 points'
                break;
            case roomNum === 9 && ghostDiscovered === true  && ghostGivenMug === false && haveMug === true  &&  inp('mug')  :
                output.innerHTML = "What do you want to do with the <span>mug</span>?"
                break;
                // interact with ghost
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false  &&  (inp('ask')||inp('question')):
                output.innerHTML = 'You gather the courage to ask the ghost what it wants.<br><br>A voice whispers...<br><br><span class="journal">"Moon... cactus... well...</span>"<br><br>What could that mean?';
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false  &&  (inp('talk')||inp('chat')||inp('hello')||inp('say')||inp(' hi')):
                output.innerHTML = 'A voice whispers...<br><br><span class="journal">"Moon... cactus...</span>"<br><br>What could that mean?';
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false  &&  (inp('flirt')||inp('compliment')||inp('flatter')||inp('cham')) :
                output.innerHTML = 'You sly dog.<br><br>The <span>ghost</span> seems to blush... or maybe it\'s just a trick of the light.';
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false  &&  inp('boo') || inp('scare') ||  inp('frighten') ||  inp('shoo') ||  inp('curse') :
                output.innerHTML = 'The <span>ghost</span> doesn\'t seem scared of you...';
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false &&  (inp('hit')||inp('push')||inp('punch')||inp('beat')||inp('fight')||(inp('throw')&&inp('rock')))  &&    (inp('ghost')||inp('figure'))  :
                output.innerHTML = 'It\'s a freaking <span>ghost</span> yo! It would probably whip your butt.<br><br>Besides, doesn\'t look solid.';
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false &&  (inp('touch')||inp('move'))  &&    (inp('ghost')||inp('figure'))  :
                output.innerHTML = 'The <span>ghost</span> is totally freaking you out... there\'s no way you\'re getting close enought to do that.';
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && inp('run') :
                room2Switch();
                output.innerHTML = "Got away safely!";
                roomNum = 2;
                break;
            case roomNum === 9 && inp('leave') && !inp('leaves') :
                room2Switch();
                roomNum = 2;
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && (inp('cast')||inp('spell')||inp('magic')||inp('exorcis')||inp('incantation')||inp('enchant')||inp('hypno')||inp('tranc')) :
                output.innerHTML = "You've never been very good at spells and encantations, especially not when standing in front of a real <span>ghost</span>.";
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && haveRibbon === true && inp('ribbon')  :
                output.innerHTML = "You offer the <span>ribbon</span> to the ghost.<br><br><span class='journal'>\"No... thanks...\"</span>";
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && haveRibbon === true && inp('rope')  :
                output.innerHTML = "I don't think the <span>ghost</span> can use that.";
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && haveCrystal === true && (inp('crystal')||inp('gem'))  :
                output.innerHTML = "You offer the <span>crystal</span> to the <span>ghost</span>.<br><br><span class='journal'>\"Jen... would love that...\"</span><br><br>Who could 'Jen' be?";
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && haveCrystal === true && inp('key') && haveBoxKey === true && haveBox === false  :
                output.innerHTML = "You show the <span>key</span> to the <span>ghost</span>.<br><br><span class='journal'>\"Box... boat...\"</span>";
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && haveCrystal === true && inp('key') && haveBox === true && haveBoxKey === true :
                output.innerHTML = "You offer the <span>key</span> to the <span>ghost</span>.<br><br><span class='journal'>\"No... thanks...\"</span>";
                break;
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && haveCrystal === true && inp('box') && haveBox === true :
                output.innerHTML = "You offer the <span>key</span> to the <span>ghost</span>.<br><br><span class='journal'>\"Not... mine...\"</span>";
                break;
                // catch-all for ghosts and mushrooms
            case roomNum === 9 && ghostDiscovered === true && ghostGivenMug === false && inp('ghost') :
                output.innerHTML = "The <span>ghost</span> hovers eerily over the <span>mushrooms</span>.";
                break;
            case roomNum === 9 && ghostDiscovered === true  && ghostGivenMug && inp('ghost') :
                output.innerHTML = "The <span>ghost</span> is gone.";
                break;
            case roomNum === 9 &&  inp('mushroom') && ghostDiscovered === false:
                playGhostCutscene();
                ghostDiscovered = true;
                room9Switch();
                output.innerHTML = "You reach for a <span>mushroom</span>...<br><br>but a <span>ghost</span> appears!!<br><br>It seems like it's guarding the mushrooms.";
                break;
            case roomNum === 9 &&  inp('mushroom') :
                output.innerHTML = "The circle of <span>mushrooms</span> looks rather enticing.";
                break;

            // ROOM 10
            case roomNum === 10 &&  (inp('use')||inp('tie')||inp('attach')||inp('set')||inp('throw')||inp('drop')||inp('toss'))   &&    (inp('rope')||inp('well'))   &&  haveRope === true  && ropeSet === false :
                ropeSet = true;
                haveRope = false;
                removeItem("a <span>rope</span>");
                room10Switch();
                switchChestRopeImage();
                output.innerHTML = "You tie the <span>rope</span> to the top of the <span>well</span>. It seems pretty secure... fingers crossed!";
                break;
            case roomNum === 10 &&  (inp('look')||inp('inspect')||inp('see ')||inp('search'))   &&    (inp('forest')||inp('around'))     :
                output.innerHTML = "You find yourself standing on front of a stone <span>well</span> in the middle of the clearing. From here a rocky path leads <span>north</span>. You can hear the sound of water to the <span>south</span>.";
                break;
            case roomNum === 10 &&  (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check')||inp('peer')||inp('behind'))   &&    (inp('well'))     :
                output.innerHTML = "The <span>well</span> looks out and out of use. You look around for a bucket, but don't find anything.<br><br>You peer down into it. It's too deep to see the bottom.";
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('rock')    :
                output.innerHTML = "You drop a rock into the <span>well</span>. It clatters off the walls for a few seconds before falling silent.<br><br>No splash... it must be dry.";
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('stick')    :
                output.innerHTML = "You throw a stick into the <span>well</span>. It clatters off the walls for a few seconds before falling silent.<br><br>No splash... it must be dry.";
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  (inp('money')||inp('coin')||inp('penny')||inp('quarter')||inp('dime')||inp('nickel')) :
                output.innerHTML = "You search your <span>pockets</span> for a coin to throw in the well, but no luck.";
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('flower')  && haveFlower === true   :
                output.innerHTML = "You drop a <span>flower</span> into the <span>well</span>. It drifts lazily down into the darkness until you lose sight of it.";
                haveFlower = false;
                removeItem("a <span>blue flower</span>");
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('flower')  && haveFlower === false   :
                output.innerHTML = "You don't have a <span>flower</span> to drop!";
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('crystal') && haveCrystal === true   :
                output.innerHTML = "You throw the <span>crystal</span> down the <span>well</span>. It hits the side and breaks apart before falling out of sight.";
                removeItem("a <span>strange crystal</span>");
                haveCrystal = false;
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('box') && haveBox === true  && ropeTaken === true && haveBoxKey === false :
                output.innerHTML = "Ok that's a good idea ngl. The box wouuld probably break when it hit the bottom. So +10 points for ingenuity.<br><br>But you're gonna need the box later ok? So you can't do that.<br><br>Try checking the <span>rocks</span> down by the lake, there's a <span>key</span> down there you can open the box with.";
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('box') && haveBox === true  :
                output.innerHTML = "The box would probably break, which would be kind of a shame.";
                break;
            case roomNum === 10 &&  (inp('throw')||inp('drop')||inp('toss'))  &&  inp('mug') && haveMug === true   :
                output.innerHTML = "You just brought the <span>mug</span> up!";
                break;
            case roomNum === 10 &&  (inp('jump')||inp('fall')||(inp('get')&&inp('well')))   &&    (inp('well'))     :
                output.innerHTML = "For a moment you imagine jumping into the <span>well</span>... What's that old phrase? \"L'appel du vide...\"<br><br>You decide to keep your feet on the ground.";
                break;
            case roomNum === 10 &&  inp('use') &&   inp('well')  && ropeSet === false :
                output.innerHTML = "The <span>well</span> doesn't have a bucket or rope.";
                break;
            case roomNum === 10  && ropeSet === true   &&  (  (inp('go')&& inp('down'))   ||  (inp('use')&&inp('well'))   ||  inp('rope') || inp('climb')) :
                output.innerHTML = "You test the <span>rope</span>, and then carefully lower yourself into the <span>well</span>...";
                room13Switch();
                roomNum = 13;
                break;
            case roomNum === 10 &&  (inp('climb')||inp('use')) &&   (inp('well')||inp('down')||inp('rope'))  && ropeSet === false :
                output.innerHTML = "You consider trying to climb down the <span>well</span>, but the walls are slippery and you're not sure if you'd be able to get back up again...";
                break;
            case roomNum === 10 &&  ropeSet === true &&  (inp('take')||inp('grab')||inp('pocket')||inp('untie')||inp('remove')||inp('get'))   &&    (inp('rope'))     :
                output.innerHTML = "You untie the <span>rope</span> and put it in your <span>pocket</span>.";
                haveRope = true;
                ropeSet = false;
                inventory.push("a <span>rope</span>");
                room10Switch();
                switchChestRopeImage();
                break;
            case roomNum === 10 && inp('wish') :
                output.innerHTML = "You make a wish.... but it's secret!";
                break;
            case roomNum === 10 &&    (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass with scattered rocks and such. You don't find anything of use.";
                break;
                // default rope
            case roomNum === 10 && haveRope === true && inp('rope') :
                output.innerHTML = "How do you want to use the rope?";
                break;
                // default well
            case roomNum === 10 && inp('in ') && inp('well') :
                output.innerHTML = "You peer down into the <span>well</span>, but you can't see the bottom.";
                break;
            case roomNum === 10 && inp('well') :
                output.innerHTML = "Well, well, well... you can't do that. Try something else.";
                break;

            // ROOM 11
            case roomNum === 11 &&  (inp('look')||inp('inspect')||inp('see ')||inp('search'))   &&    (inp('forest')||inp('around')) :
                if (caveInspected === false) {
                    //playCaveCutscene();
                    caveInspected = true;
                };
                output.innerHTML = "You're standing in front of a large <span>cave</span> shrouded in darkness.<br><br>A stony path cuts through the forest to the <span>south</span> and <span>east</span>";
                break;
            case roomNum === 11 &&  (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check')||inp('behind'))   &&    (inp('cave')) :
                if (caveInspected === false) {
                    //playCaveCutscene();
                    caveInspected = true;
                };
                output.innerHTML = "The <span>cave</span> is so dark you can hardly see past the threshold...";
                break;
            case roomNum === 11 &&  (inp('around')||inp('behind'))   &&    (inp('cave')) :
                if (caveInspected === false) {
                    //playCaveCutscene();
                    caveInspected = true;
                };
                output.innerHTML = "The only way <span>north</span> is through the <span>cave</span>...";
                break;
            case roomNum === 11 &&  (inp('go')||inp('enter')||inp('explore'))   &&    (inp('cave')||inp('rocks')||inp('cavern')) :
                room7Switch();
                roomNum = 7;
                userInput.value = "";
                break;
            case roomNum === 11 &&  (inp('in ')||inp('what')) &&  (inp('cave')||inp('rocks')||inp('cavern')) :
                output.innerHTML = "You peer into the <span>cave</span>, but it's too dark to see anything.<br><br>I guess the only way to check it out, is to go inside...";
                break;
            case roomNum === 11 &&    (inp('inspect')||inp('see ')||inp('look')||inp('search')||inp('check'))  && (inp('ground')||inp('floor')||inp('dirt')) :
                output.innerHTML = "The ground is covered in grass with scattered rocks and such. You don't find anything of use.";
                break;
            case roomNum === 11 && inp('cave') && inp('throw') :
                output.innerHTML = "You throw a rock into the <span>cave</span>, and you hear it echo as it clatters off the walls.";
                break;
            case roomNum === 11 && inp('cave')  :
                output.innerHTML = "There's something eery about this <span>cave</span>...";
                break;

            // ROOM 12
                // talk to robot
            case roomNum === 12  && robotAwake === true && (  (inp('talk')||inp('how')||inp('who')||inp('what')||inp('inquire')||inp('ask')||inp('question')||inp('converse')||(inp('use')&&inp('robot')) )    ||    (( (inp('turn')||inp('switch'))   &&    (inp('figure')||inp('person')||inp('thing')||inp('robot')||inp('machine')) ) || (inp("button")||inp('activate')||inp('operate')||((inp('switch')||inp('turn'))&&inp('on'))))  ):
                createConversation();
                break;
            case roomNum === 12 &&    (inp('look')||inp('inspect')||inp('see ')||inp('search')) && robotAwake === false  &&    (inp('forest')||inp('around'))     :
                if (lakeDiscovered === false) {
                    // playBeachCutscene();
                    lakeDiscovered = true;
                };
                output.innerHTML = "A <span>strange figure</span> is lying under a tree by the lake shore.<br><br>To the west, a narrow path leads back the the glade where you awoke. To the north, a wooded path cuts into the forest. ";
                break;
            case roomNum === 12 &&    (inp('look')||inp('inspect')||inp('see ')||inp('search')) && robotAwake === true  &&    (inp('forest')||inp('around'))     :
                if (lakeDiscovered === false) {
                    // playBeachCutscene();
                    lakeDiscovered = true;
                };
                output.innerHTML = "A <span>robot</span> is standing under a tree by the lake shore. <br><br>To the north, a wooded trail leads into the forest. The lake shore continues eastward.";
                break;
            case roomNum === 12  && robotAwake === false &&     (inp('tree')||inp('branch'))     :
                output.innerHTML = "There's a <span>robot</span> lying under a tree by the lake shore. It looks like it's sleeping, or powered down.";
                break;
                // inspect strange figure
            case roomNum === 12 && robotAwake === false &&  (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check')||inp('behind'))   &&    (inp('figure')||inp('person')||inp('thing')||inp('robot')||inp('machine'))   :
                output.innerHTML = "A <span>robot</span> is lying under the tree by the lake, as if it just fell asleep there.<br><br>It looks like maybe it's been turned off. There is a panel on the front of the robot that looks like it could house a <span>power source</span>, but it's empty.";
                break;
                // interact with sleeping robot
            case roomNum === 12 && robotAwake === false && inp('wake')  :
                output.innerHTML = "You wave your hands in front of the <span>robot</span>, and give it a little shake, but it doesn't react.";
                break;
            case roomNum === 12 && robotAwake === false && (inp('talk')||inp('chat')||inp('ask')||inp('question')||inp('say'))  :
                output.innerHTML = "The <span>robot</span> is powered down and unresponsive.";
                break;
                // power up robot
            case roomNum === 12 && robotAwake === false && haveCrystal === true  && (inp('crystal')||inp('gem')):
                playRobotCutscene();
                robotAwake = true;
                room12Switch();
                thingsTriedSinceLastBigThing = 0;
                haveCrystal = false;
                removeItem("a <span>strange crystal</span>");
                output.innerHTML = "You open the <span>robot's</span> front panel, and carefully slide the <span>crystal</span> into the empty battery slot, and suddenly the <span>robot</span> comes to life!";
                break;     
                // power attempts
            case roomNum === 12 && robotAwake === false && (  (inp('panel')||inp('source'))  ||  ((inp('open')||inp('power')) && inp('robot'))  ):
                output.innerHTML = "There's an empty space for a <span>power supply</span> of some kind in the <span>robot</span>.<br><br>You look around for something to power the robot with, but don't find anything.";
                break;
            case roomNum === 12 && robotAwake === false && (( (inp('turn')||inp('switch')||inp('robot'))   &&    (inp('figure')||inp('person')||inp('thing')||inp('robot')||inp('machine')) ) || (inp('electric')||inp("button")||inp('fuel')||inp('activate')||inp('operate')||((inp('switch')||inp('turn'))&&inp('on'))))  :
                output.innerHTML = "You search the <span>robot</span> for a switch or button, and find panel on the front that looks like it could house a <span>power source</span>.";
                break;
            case roomNum === 12 && robotAwake === false && (inp('battery')||inp('power'))  :
                output.innerHTML = "You look for a battery or power supply, but you don't find anything.";
                break;
            case roomNum === 12 && robotAwake === false && (inp('wire')||inp('rig')||inp('fix')||inp('repair'))  :
                output.innerHTML = "You're not much of a mechanic, but you take a close look at the <span>robot</span>. Everything seems fine, except for an empty <span>power supply</span>.";
                break;
            case roomNum === 12 && robotAwake === false && inp('charge') :
                output.innerHTML = "You don't have a way to charge the <span>robot</span> right now.";
                break;
            case roomNum === 12 && robotAwake === false && (inp('throw')||inp('hit')||inp('punch')||inp('kick')||inp('attack')||inp('fight')||inp('break')||inp('smash')) :
                output.innerHTML = "You give the <span>robot</span> a solid wack, but nothing happens.<br><br>Violence never solves anything! Sheesh.";
                break;
                // defaults
            case roomNum === 12 && robotAwake === false && (inp('robot')||inp('figure')||inp('person'))  :
                output.innerHTML = "The <span>robot</span> is inactive.";
                break;


            // ROOM 13
            case roomNum === 13 &&  (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check'))   &&    (inp('well')||inp('around')||inp('ground')||inp('floor')||inp('dirt'))  && mugTaken === false  :
                output.innerHTML = "It's dark... there's just enough light to see around you. The ground is dry and littered with rocks and grass and... what's this? A <span>mug</span>?";
                break;
            case roomNum === 13 &&  (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check'))   &&    (inp('well')||inp('around')||inp('ground')||inp('floor')||inp('dirt'))  && mugTaken === true  :
                output.innerHTML = "It's dark... there's just enough light to see around you. The ground is dry and littered with rocks and grass. You can see the spot in the ground where the <span>mug</span> used to be.";
                break;
            case roomNum === 13 &&  (inp('look')||inp('inspect')||inp('see ')||inp('search'))   &&    (inp('mug'))  && mugTaken === false   :
                output.innerHTML = "The <span>mug</span> is lying in the darkness of the well. It looks like there is a desert scene painted on it... Somebody must have dropped it down here.";
                break;
            case roomNum === 13 &&  (inp('take')||inp('grab')||inp('pocket')||inp('get'))   &&    (inp('mug'))  && mugTaken === false   :
                haveMug =true;
                mugTaken = true;
                inventory.push("an <span>old mug</span>");
                room13Switch();
                output.innerHTML = "You put the <span>mug</span> in your <span>pocket</span>.";
                break;
            case roomNum === 13 &&  (inp('take')||inp('grab')||inp('pocket')||inp('get'))   &&    (inp('mug'))  && mugTaken === true   :
                output.innerHTML = "You already took the <span>mug</span>.";
                break;
            case roomNum === 13 &&  (inp('climb')||inp('go')||inp('use')) && (inp('up')||inp('rope')) :
                room10Switch();
                roomNum = 10;
                break;

            // RELEASE FIREFLIES
            case roomNum === 2 && haveFireflies=== true && (inp('release')||inp('open'))   &&    (inp('box')||inp('chest')||inp('fireflies'))  :
                output.innerHTML = 'You release the <span>fireflies</span> into the air. They linger for a moment before rejoining their friends.';
                haveFireflies = false;
                removeItem("a <span>box of fireflies</span>");
                inventory.push("a <span>wooden box</span>");
                switchChestRopeImage();
                break;
            case roomNum !== 7 && haveFireflies=== true && (inp('release')||inp('open'))   &&    (inp('box')||inp('chest')||inp('fireflies'))  :
                output.innerHTML = 'You release the <span>fireflies</span> into the air. They linger for a moment, glimmering quietly, before floating up and away.<br><br>"Maybe they\'re going back to join their friends", you think.';
                haveFireflies = false;
                removeItem("a <span>box of fireflies</span>");
                inventory.push("a <span>wooden box</span>");
                switchChestRopeImage();
                break;
            case roomNum === 7 && haveFireflies=== true && (inp('release')||inp('open'))   &&    (inp('box')||inp('chest')||inp('fireflies'))  :
                firefliesReleased = true;
                haveFireflies = false;
                switchChestRopeImage();
                //playCaveCutscene2();
                document.getElementById("room7").src="./roomimages/smfmroom7a.png";
                removeItem("a <span>box of fireflies</span>");
                inventory.push("a <span>wooden box</span>");
                room7Switch();
                thingsTriedSinceLastBigThing = 0;
                output.innerHTML = 'You open the <span>box</span>, and the <span>fireflies</span> fill the cave with a brilliant light!';
                break;

            // INTERACT WITH WATER
            case (roomNum === 5 || roomNum === 6 || roomNum === 12) &&    (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check'))   &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('stream')||inp('ocean')||inp('bank')||inp('shore'))     :
                output.innerHTML = "The water is cool and clear, and a few fish drift lazily along. You search around the banks, but don't find anything particularly useful.";
                break;
            case (roomNum === 5 || roomNum === 6 || roomNum === 12) &&    (inp('swim')||inp('dive')||inp('jump')||inp('cross')||inp('get'))   &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('stream')||inp('ocean')||inp('bank')||inp('beach'))     :
                output.innerHTML = "You didn't bring a swim suit! The water seems cold anyway.";
                break;
            case (roomNum === 5 || roomNum === 6 || roomNum === 12) &&    (inp('catch')||inp('grab')||inp('take')||inp('lure')||inp('get'))   &&    (inp('fish'))     :
                output.innerHTML = "You try to catch a fish, but they are way too fast! They probably prefer the water anyway.";
                break;
            case (roomNum === 5 || roomNum === 6 || roomNum === 12) &&    (inp('skip')||inp('throw')||inp('toss'))   &&    (inp('rock')||inp('pebble')||inp('stone'))     :
                output.innerHTML = "You throw a rock out across the water. It skips across the surface a few times before sinking with a 'plop', and you watch the ripples play off each other on the glassy surface.";
                break;
            case (roomNum === 5 || roomNum === 6 || roomNum === 12 || roomNum === 8) &&    (inp('drink')||inp('sip'))   &&    (inp('water')||inp('lake'))  && haveMug === true   :
                output.innerHTML = "You fill the <span>mug</span> with water from the lake and take a sip. It tastes clean and refreshing.";
                break;
            case (roomNum === 5 || roomNum === 6 || roomNum === 12 || roomNum === 8) &&    (inp('drink')||inp('sip'))   &&    (inp('water')||inp('lake'))  :
                output.innerHTML = "You cup your hands into the lake and take a sip. The water is clean and refreshing.";
                break;
            case ((roomNum === 6 || roomNum === 12) || (roomNum === 5 && haveBoxKey === true))&&    (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check')||inp('grab')||inp('take')||inp('pocket')||inp('get')||inp('under')||inp('behind'))   &&    (inp('drift')||inp('wood')):
                output.innerHTML = "You search around the driftwood on the shore but don't find anything particularly useful.";
                break;
            case (roomNum === 5 || roomNum === 6 || roomNum === 12 || roomNum === 8) &&    inp('swim')  :
                output.innerHTML = "Brrr... the water is cold!";
                break;
            
            // INTERACT WITH TREES
                // default for tree-less rooms
            case ((roomNum === 7 || roomNum === 8 || roomNum === 13))  &&    (inp('tree')||inp('branch'))     :
                output.innerHTML = "There aren't any trees around here.";
                break;
                // take
            case (inp('take')||inp('grab')||inp('pocket'))  && (inp('stick') ||inp('branch') ) :
                output.innerHTML = "There are lot's of good sticks around, for sure. You pick one up and wave it around like a sword for a minute. Heck yeah.<br><br>Your pockets are only so big, so you decide to leave them where the are.";
                break;
            case (inp('take')||inp('grab')||inp('pocket'))  && inp('tree')   :
                output.innerHTML = "Your <span>pockets</span> aren't that big! They're just regular sized.";
                break;
                // climb
            case (inp('climb')|| (inp('rope')&&haveRope===true) )  &&    (inp('tree')||inp('branch')) :
                output.innerHTML = "You carefully climb up the nearest tree. The branches are thin near the top, so you find a sturdy perch to look out over the forest.<br><br>There is a <span>lake</span> to the <span>south</span>, but besides that the trees stretch as far as the eye can see.<br><br>You enjoy the view for a minute, then climb down.";
                playTreeClimbCutscene();
                break;
            case (inp('climb')|| (inp('rope')&&haveRope===true) )  &&    (inp('tree')||inp('branch'))  && (roomNum === 9)  :
                output.innerHTML = "You carefully climb up the nearest tree. The branches are thin near the top, so you find a sturdy perch to look out over the forest.<br><br>There is a <span>lake</span> to the <span>south</span>, but besides that the trees stretch as far as the eye can see.<br><br>You enjoy the view for a minute, then climb down.";
                playTreeClimbCutscene();
                break;
                // look
            case (roomNum === 9)  &&    (inp('tree')||inp('branch'))   &&   (inp('look'))  :
                output.innerHTML = "The trees here look ancient. You get the feeling this is a very old part of the forest.";
                break;
            case ((roomNum !== 4) || marbleDown === true) &&   (inp('look'))   &&    (inp('tree')||inp('branch'))     :
                output.innerHTML = "There is a wide variety of trees in the forest - oaks, sycamore, pines trees, cyrpress, even some eucalyptus.";
                break;
                // search
            case ((roomNum !== 4) || marbleDown === true) &&   (inp('inspect')||inp('see ')||inp('search')||inp('check')||inp('behind')||inp('under'))   &&    (inp('tree')||inp('branch'))     :
                output.innerHTML = "You search around the trees, but don't find anything.";
                break;
            case (inp('hug')||inp('love'))  && inp('tree')   :
                output.innerHTML = "Ya hippie :)<br><br>+5 points";
                break;
            case inp('tree')   :
                output.innerHTML = "There are a lot of different kinds of trees around you - oaks, sycamore, pines trees, cyrpress, even some eucalyptus. Their leaves cover the ground.<br><br>You search around the trees for a bit, but don't find anything.";
                break;
            case (inp('shake') ||inp('push') ||inp('jostle')) && inp('tree')   :
                catDiscovered = true;
                output.innerHTML = "You give a few trees a good shake, but nothing happens.";
                break;
                // cut
            case inp('tree')  && inp('cut')  :
                output.innerHTML = "You don't have a tool to cut down the trees.";
                break;

            // GET FLOWER
            case (roomNum === 1 || roomNum === 3 || roomNum === 5 || roomNum === 14 || roomNum === 12)   &&    (inp('look')||inp('inspect')||inp('see ')||inp('search')||inp('check'))   &&    (inp('flower'))     :
                output.innerHTML = "You look at the flowers. Nice :)<br><br>+1 point";
                break;
            case (roomNum === 1 || roomNum === 3 || roomNum === 5  || roomNum === 14 || roomNum === 12)   &&    (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab')||inp('put'))   &&    (inp('flower'))  && haveFlower === false   :
                output.innerHTML = 'You pick one of the <span>blue flowers</span> and carefully put it in your <span>pocket</span>.<br><br>Maybe it will be useful later?<br><br>Type "<span>pockets</span>" to check what you have with you.';
                haveFlower = true;
                inventory.push("a <span>blue flower</span>");
                break;
            case (roomNum === 1 || roomNum === 3 || roomNum === 5 || roomNum === 14 || roomNum === 12)   &&    (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab')||inp('put'))   &&    (inp('flower'))  && haveFlower === true   :
                output.innerHTML = 'You already have a <span>flower</span> in your <span>pocket</span>!';
                break;
            case (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get'))   &&    (inp('flower')) :
                output.innerHTML = "There aren't any flowers around here.";
                break;
            case inp('smell') &&    (inp('flower')) &&  (roomNum === 1 || roomNum === 3 || roomNum === 5 || roomNum === 14 || roomNum === 12)   :
                output.innerHTML = "Lovely :)<br><br>+10 points";
                break;
            case ((roomNum === 1 || roomNum === 3 || roomNum === 5 || roomNum === 14 || roomNum === 12) ||  haveFlower === true) &&    inp('flower')  :
                output.innerHTML = "Lovely :)";
                break;

            // INTERACT WITH ROCKS
            case (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab')||inp('put'))   &&    (inp('rock')||inp('stone')||inp('pebble'))    :
                output.innerHTML = "There's an art to <span>rock</span> collecting. You find a nice one and put it in your <span>pocket</span>.<br><br>Type \"<span>pockets</span>\" to see what you have with you.";
                inventory.push("a <span>rock</span>")
                haveRock = true;
                break;
            case (inp('under')||inp('search')||inp('check'))   &&    (inp('rock')||inp('stone')||inp('pebble'))    :
                output.innerHTML = "You search under some of the rocks, but don't find anything other than some very confused bugs.";
                break;
            case (inp('inspect')||inp('see ')||inp('look')||inp('check')||inp('under')||inp('behind'))   &&    (inp('rock')||inp('stone')||inp('pebble'))    :
                output.innerHTML = "You look at the rocks. They look rocky.";
                break;
            case inp('eat')  &&    (inp('rock')||inp('stone')||inp('pebble'))    :
                output.innerHTML = "...";
                break;
            case (inp('rock')||inp('stone')||inp('pebble')) && inp('throw')    :
                output.innerHTML = "You wind up and throw the rock as far as you can.";
                haveRock = false;
                break;

            // INTERACT WITH GRASS
            case (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get'))   &&    inp('grass')    :
                output.innerHTML = "There's no shortage of grass around, and your <span>pockets</span> are only so big. You probably won't need to take it with you.";
                break;
            case (inp('search')||inp('inspect')||inp('see ')||inp('look')||inp('check'))   &&    inp('grass')    :
                output.innerHTML = "You search the grass, but don't find anything.";
                break;
            case inp('touch')  &&    inp('grass')    :
                output.innerHTML = "You touch the grass. Feels good, not gonna lie.";
                break;
            case (inp('lie')||inp('lay'))  &&    inp('grass')    :
                output.innerHTML = "You lie down on the grass and watch the clouds float gently above you. It's comfy, but after a while starts to get a bit itchy. Makes you wish you'd brought a blanket.";
                break;
            case inp('smoke')  &&    inp('grass')    :
                output.innerHTML = "-_-";
                break;
            case inp('eat')  &&    inp('grass')    :
                output.innerHTML = "...why??";
                break;
            
            // STICKS
            case roomNum !== 7 && roomNum !== 8 && roomNum !== 13 && inp('stick') && (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')) :
                output.innerHTML = "There are plenty of sticks around, so there's no need to take one with you.";
                break;

            // BUSHES
            case roomNum !== 7 && roomNum !== 8 && roomNum !== 13 && inp('bush') && (inp('search')||inp('inspect')||inp('see ')||inp('look')||inp('check')) :
                output.innerHTML = "You search the bushes, but don't find anything.";
                break;
            case  inp('bush') && (inp('search')||inp('inspect')||inp('see ')||inp('look')||inp('check')||inp('behind')||inp('under')) :
                output.innerHTML = "There aren't any bushes around here.";
                break;
            case  inp('aim') && inp("for") && inp('bush') :
                output.innerHTML = "You thinkin what I'm thinkin?";
                break;
            case  inp('bush') :
                output.innerHTML = "What about the bushes?";
                break;

            // LEAVES
            case (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get'))   &&   (inp('leaves')||inp('leaf'))    :
                output.innerHTML = "There are plenty of leaves around, and your <span>pockets</span> are only so big. You probably won't need to take any along with you.";
                break;
            case  (inp('leaves')||inp('leaf')) && (inp('search')||inp('inspect')||inp('see ')||inp('look')||inp('check')) :
                output.innerHTML = "You search the leaves, but don't find anything (other than some nice leaves.)";
                break;
            case  inp('touch') && (inp('leaves')||inp('leaf'))  :
                output.innerHTML = "You touch the leaves. They feel leafy.<br><br>Better leaf them alone.";
                break;

            // UNLOCK / INTERACT WITH THE BOX IN INVENTORY
            case (inp('unlock')||inp('open')||inp('key'))   &&    (inp('box')||inp('chest'))  && haveBox === true && haveBoxKey === true && boxUnlocked === false   :
                output.innerHTML = "You use the <span>silver key</span>, and the <span>box</span> opens with a satisfying click.<br><br>Inside the <span>box</span> you find a <span>red ribbon</span>. You put the <span>ribbon</span> in your <span>pocket</span>.";
                boxUnlocked = true;
                haveRibbon = true;
                thingsTriedSinceLastBigThing = 0;
                inventory.push("a <span>red ribbon</span>");
                switchChestRopeImage();
                if (checkingInventory === true) {
                    displayInventory();
                };
                break;
            case (inp('unlock')||inp('open')||inp('key'))   &&  !(inp('hit')||inp('break')||inp('smash')||inp('rock')||inp('force')||inp('bust')||inp('bash'))  && (inp('box')||inp('chest'))  && haveBox === true && haveBoxKey === false  :
                output.innerHTML = "The <span>box</span> is securely locked, and you don't have a <span>key</span>." ;
                break;
            case (inp('shake')||inp('rattle'))   &&    (inp('box')||inp('chest'))  && haveBox === true && boxUnlocked === false  :
                output.innerHTML = "You shake the box <span>box</span>. There's <span>something</span> light and soft inside it." ;
                break;
            case (inp('look')||inp('inspect')||inp('see ')||inp('check')||inp('search'))   &&    (inp('box')||inp('chest'))  && haveBox === true && haveFireflies === false  :
                output.innerHTML = "The <span>box</span> is made of hard wood and reinforced with metal banding and a silver lock." ;
                if (checkingInventory === true) {
                    displayInventory();
                };
                break;
            case (inp('look')||inp('inspect')||inp('see ')||inp('check')||inp('search'))   &&    (inp('box')||inp('chest'))  && haveBox === true && haveFireflies === true  :
                output.innerHTML = "The <span>box</span> is made of hard wood and reinforced with metal banding and a silver lock. You can see the glow from the <span>fireflies</span> through the crack in the lid." ;
                if (checkingInventory === true) {
                    displayInventory();
                };
                break;
            case (inp('hit')||inp('break')||inp('smash')||inp('rock')||inp('force')||inp('bust')||inp('bash'))   &&    (inp('box')||inp('chest'))  && haveBox === true && boxSmashed === 0 && boxUnlocked === false    :
                output.innerHTML = "You hit the <span>box</span> with a rock... and it opens! ...just kidding.<br><br>This is a puzzle game, not a smashing-stuff-with-rocks game, so don't even think about trying that again." ;
                boxSmashed++;
                if (checkingInventory === true) {
                    displayInventory();
                };
                break;
            case (inp('hit')||inp('break')||inp('smash')||inp('rock')||inp('force')||inp('bust')||inp('bash'))   &&    (inp('box')||inp('chest'))  && haveBox === true  && boxSmashed === 1 && boxUnlocked === false  :
                output.innerHTML = "Didn't I already tell you that wasn't going to work? You gotta find a smart way to open the <span>box</span>." ;
                boxSmashed++;
                if (checkingInventory === true) {
                    displayInventory();
                };
                break;
            case (inp('hit')||inp('break')||inp('smash')||inp('rock')||inp('force')||inp('bust')||inp('bash'))   &&    (inp('box')||inp('chest'))  && haveBox === true  && boxSmashed === 2 && boxUnlocked === false :
                output.innerHTML = "It's a nice <span>box</span>! Don't smash it! The <span>key</span> is literally in the next screen over. This is just rude." ;
                boxSmashed++;
                if (checkingInventory === true) {
                    displayInventory();
                };
                break;
            case (inp('hit')||inp('break')||inp('smash')||inp('rock')||inp('force')||inp('bust')||inp('bash'))   &&    (inp('box')||inp('chest'))  && haveBox === true  && boxSmashed === 3 :
                output.innerHTML = "Okay fine!!! You smash the <span>box</span> and it opens! Are you happy now??<br><br>There's a <span>red ribbon</span> inside. Good luck smashing that around you jerk." ;
                boxUnlocked = true;
                thingsTriedSinceLastBigThing = 0;
                haveRibbon = true;
                boxSmashed = 4;
                removeItem("a <span>wooden box</span");
                inventory.push("a <span>smashed-up box</span>");
                inventory.push("a <span>red ribbon</span>");
                switchChestRopeImage();
                if (checkingInventory === true) {
                    displayInventory();
                };
                break;
            case inp('smash') && inp('ribbon') && haveRibbon === true:
                output.innerHTML = "Nothing happened.<br><br>Jerk."
                break;
            case inp('box') && haveBox === true && boxUnlocked === false:
                output.innerHTML = "It's not a large <span>box</span>... but it sounds like there might be something inside."
                break;
            case inp('box') && boxUnlocked === true && (inp('water')||inp('lake')||inp('ocean')) && (roomNum === 12 || roomNum === 8 || roomNum === 5 || roomNum === 6) :
                output.innerHTML = "You start to dip the <span>box</span> into the water, but quickly realize it's not water-tight. Oh well."
                break;
            case inp('box') && boxUnlocked === true && (inp('leaves')||inp('leaf')||inp('stick')) :
                output.innerHTML = "You put some leaves in the bottom of the <span>box</span>. It looks like some little bugs could live their happily now :)<br><br>+3 points"
                break;
            case inp('box') && boxUnlocked === true && (inp('dirt')||inp('grass')) :
                output.innerHTML = "You put some dirt and grass in the bottom of the <span>box</span>. Now it's the perfect home for some bugs :)<br><br>+3 points"
                break;
            case inp('box') && boxUnlocked === true && (inp('rock')||inp('stone')||inp('pebble')) :
                output.innerHTML = "You carefully put a small rock in the <span>box</span>. The <span>box</span> is the perfect size for a bug's home."
                break;
            case inp('box') && boxUnlocked === true && inp('flower') && (haveFlower === true || (roomNum === 1 || roomNum === 3 || roomNum === 5  || roomNum === 14 || roomNum === 12) ):
                output.innerHTML = "You put a <span>flower</span> in the <span>box</span>.<br><br>Any little creatures living in this box would be happy for the decoration :)<br><br>+3 points"
                break;
            case inp('box') && boxUnlocked === true:
                output.innerHTML = "I bet you could put all kinds of things in this <span>box</span>.<br><br>There was a <span>ribbon</span> in it when you found it."
                break;

            // INTERACT WITH OTHER ITEMS IN INVENTORY
                // key
            case (inp('inspect')||inp('see ')||inp('look')||inp('check')||inp('what'))   &&    inp('key')  && haveBoxKey === true && haveBox === false :
                output.innerHTML = "The <span>key</span> is shiny silver and about the size of your pinky finger.";
                if (checkingInventory === true) {
                    displayInventory();
                };
                break;
            case (inp('inspect')||inp('see ')||inp('look')||inp('check')||inp('what'))   &&    inp('key')  && haveBoxKey === true  :
                output.innerHTML = "The <span>key</span> is shiny silver and about the size of your pinky finger. Since it's silver, you would guess would open something with a silver lock.";
                if (checkingInventory === true) {
                    displayInventory();
                };
                break;
            case inp('key') && haveBoxKey === false  :
                output.innerHTML = "The key has got to be around here somewhere.<br><br>Try <span>looking</span> at things, or <span>walking</span> in a direction.";
                break;
            case inp('key') && haveBox === false  :
                output.innerHTML = "I wonder what this <span>key</span> is for?";
                break;
            case inp('key') &&  boxUnlocked === true :
                output.innerHTML = "There must be a way to open the <span>door</span> somehow.";
                break;
                // ribbon
            case (inp('inspect')||inp('see ')||inp('look')||inp('check')||inp('what'))   &&    inp('ribbon')  && haveRibbon === true  :
                output.innerHTML = "The <span>ribbon</span> is made of vibrant red silk and about two feet long. It may have been a hair tie at one point.";
                if (checkingInventory === true) {
                    displayInventory();
                }
                break;
            case inp('hair')  &&  inp('ribbon')  && haveRibbon === true  :
                output.innerHTML = "You tie the <span>ribbon</span> in you hair. Nice :)<br><br>+20 points";
                break;
            case inp('ribbon') && ( inp('use') || inp('tie') )&& haveRibbon === true  :
                output.innerHTML = "You can't use the <span>ribbon</span> for that, sorry.";
                break;
            case inp('ribbon') &&  inp('wave') && haveRibbon === true  :
                output.innerHTML = "You wave the <span>ribbon</span> around a bit. It would make a great <span>cat</span> toy.";
                break;
            case inp('ribbon') :
                output.innerHTML = "";
                break;
            case roomNum === 12 && marbleReunited === false && robotAwake && inp('ribbon')    :
                output.innerHTML = "You show the <span>ribbon</span> to the <span>robot</span><br><br><span class='robot'>\"What a beatiful thing! I have a friend who would love a ribbon like that,\"</span>, the <spam>robot</span> says.";
                break;
                // mug
            case (inp('inspect')||inp('see ')||inp('look')||inp('check')||inp('what'))   &&    (inp('mug')||inp('cup'))  && haveMug === true  :
                output.innerHTML = "The <span>mug</span> is dark blue and decorated with a picture of a cactus and crescent moon. Something about it reminds you of home.";
                if (checkingInventory === true) {
                    displayInventory();
                }
                break;
            case inp('cactus')  :
                output.innerHTML = "There aren't any cactuses around.";
                break;
                // rope
            case (inp('where')  || inp('how') || inp('what') ) && inp('rope')   :
                output.innerHTML = "You wonder if the <span>rope</span> maybe be helpful in reaching a new place.";
                break;
            case inp('swing') && haveRope === true &&  roomNum !== 7 && roomNum !== 8 && roomNum !== 13   :   // XXX I could animate this
                output.innerHTML = "You toss the <span>rope</span> over the nearest branch, tie it up, and let-er-rip. Best thing ever :) <br><br>+20 points";
                break;

                // crytal
            case (inp('inspect')||inp('see ')||inp('look')||inp('check')||inp('what'))   &&    (inp('crystal')||inp('gem'))  && haveCrystal === true  :
                output.innerHTML = "The piece of <span>crystal</span> is about the size of your hand and soft pink in color. It feels oddly warm, and catches the light in an unusual way.";
                if (checkingInventory === true) {
                    displayInventory();
                }
                break;
            case (inp('rub')||inp('touch')||inp('what')) && (inp('crystal')||inp('gem')) && (haveCrystal=== true || (roomNum === 7 || roomNum === 8))  :
                output.innerHTML = "The surface of the <span>crystal</span> is oddly warm. Your finger tips tingle when you touch it.";
                break;
            case (inp('eat') && (inp('crystal')||inp('gem')||inp('what'))) && (haveCrystal=== true || (roomNum === 7 || roomNum === 8))  :
                output.innerHTML = "The crystals don't look good for eating. That would be wild if you could just eat rocks tho.";
                break;
                // throwing things
            case (inp('toss')||inp('throw')||inp('drop')||inp('what'))   &&  (   ((inp('mug') && haveMug === true ))   ||   ((inp('crystal') && haveCrystal === true ))   ||  ( (inp('mushroom') && haveMushy === true))   ||   (inp('ribbon')  && haveRibbon === true)     ||   ( inp('key') && haveBoxKey === true)     )  :
                output.innerHTML = "I should probably keep this with me.";
                break; 

            // EXTRA INPUT IF JUST "POCKETS"
            case inp('pocket') :
                userInput.value = "";
                output.innerHTML = checkInventory();
                displayInventory();
                break;
            
            // CANDLE / FLASHLIGHT
            case inp('candle') :
                output.innerHTML = "There isn't a candle around.";
                break;
            case inp('flash') && inp('light') :
                output.innerHTML = "You don't have a flashlight.";
                break;
            case inp('matches') || (inp('light') && inp('match') ):
                output.innerHTML = "You don't have a any matches.";
                break;
            
            // DIG / DIRT / GROUND
            case inp('dig') && (inp('gold')||inp('treause')):
                output.innerHTML = "No treasure here!";
                break;
            case inp('dig') && inp('mushroom') && roomNum !== 9 :
                output.innerHTML = "Not really the season for that.";
                break;
            case inp('dig') && inp('stump')  && roomNum === 3 :
                output.innerHTML = "You dig around the edges of the stump, disturbing some of the local bug residents. You don't find anything.";
                break;
            case inp('dig'):
                output.innerHTML = "You don't have anything to dig with, and you're not really sure what you'd be looking for anyway.";
                break;
            case  inp('touch') && (inp('dirt') || inp('ground'))  :
                output.innerHTML = "Yaaay dirt.";
                break;

            // TRAVEL TO LAKE
            case roomNum !== 8 && roomNum !== 7 && roomNum !== 13  && (inp('travel')||inp('go')||inp('walk')||inp('find')||inp('look for')||inp('visit'))   &&    (inp('water')||inp('creek')||inp('river')||inp('lake')||inp('stream')||inp('ocean')||inp('bank')||inp('beach')) :
                if (roomNum === 11 || roomNum === 10) {
                    room12Switch();
                    userInput.value = "";
                    roomNum = 12;
                } else if (roomNum === 1 || roomNum === 4) {
                    room5Switch();
                    userInput.value = "";
                    roomNum = 5;
                } else {
                    room6Switch();
                    userInput.value = "";
                    roomNum = 6;
                };
                break;

            // DEFAULT "GO"
            case (inp("walk")||inp('go')||inp('travel')) && (inp('forest')||inp('back')) && (roomNum === 8 || roomNum === 7):
                userInput.value = "";
                room11Switch();
                break;
            case (inp("walk")||inp('go')||inp('travel')) && (inp('forest')||inp('back')||inp('firefl')) && (roomNum === 9):
                userInput.value = "";
                room2Switch();
                break;
            case (inp("walk")||inp('go')||inp('travel')) && inp('firefl') && roomVisited[2] === true:
                userInput.value = "";
                room2Switch();
                break;
            case (inp("walk")||inp('go')||inp('travel')) && (inp('forest')||inp('back')) && roomNum === 12 :
                userInput.value = "";
                room10Switch();
                break;
            case (inp("walk")||inp('go')||inp('travel')) && (inp('forest')||inp('back')) && roomNum === 5 :
                userInput.value = "";
                room1Switch();
                break;
            case (inp("walk")||inp('go')||inp('travel')) && (inp('forest')||inp('back')) && roomNum === 6 :
                userInput.value = "";
                room3Switch();
                break;
            case (inp("walk")||inp('go')||inp('travel')) && (inp('forest')||inp('back')||inp(' up')) && roomNum === 13 :
                userInput.value = "";
                room10Switch();
                break;
            case (inp("walk")||inp('go')||inp('travel')):
                userInput.value = "";
                output.innerHTML = "Which direction to you want to go?<br><br>Type \"<span>map</span>\" to see where you have been.";
                break;

            // ABOUT THE GAME
            case inp('game')  :
                output.innerHTML = "This game was made by nok nok in HTML and Javascript. The 3D images are also mostly made by nok nok in Blender, except for a few models by Liam Xee and Pastean Narcis Dan. The 8-bit style cutscene images are a combination of Night Cafe AI and Photoshop.<br><br>Thanks for playing!";
                break;
                
            // DEFAULT "NEGATIVITY"
            case (inp('bad')||inp('terrible')||inp('sad')||inp('lonely')||inp('unhappy')||inp('not good')||inp('depress'))   :
                output.innerHTML = "I'm just a pre-programmed robot, so I can't say much. But you're doing great, and I hope you find a bit of brightness today <3";
                break;
            case (inp('stupid')||inp('dumb')||inp('lame')||inp('sucks')||inp('blows'))   :
                output.innerHTML = ":(";
                break;

            // DEFAULT "POSITIVITY"
            case (inp('love')||inp('great')||inp('good')||inp('happy')||inp('fine')||inp('okay')||inp('not bad')||inp(':)'))   :
                output.innerHTML = ":)";
                break;

            // RANDOM DEFAULTS
            case inp('eat' ) :
                output.innerHTML = "Yeah, you probably don't want to eat that.";
                break;
            case inp('jump')  :
                output.innerHTML = "Jumping around is not really going to help you here. Fun though!";
                break;
            case inp('dance')  :
                output.innerHTML = "Shake it, babayyy.";
                break;
            case inp('groove') || inp('boogy') :
                output.innerHTML = "Uhh! That's what I like to see.";
                break;
            case inp('magic') || inp('spell') :
                output.innerHTML = "Abracadabra! Kallamazoo! How Now Brown Cow!<br><br>...nothing happened.";
                break;

            // OBJECT DEFAULTS
            case inp('grass')    :
                output.innerHTML = "What about the grass?";
                break;
            case  inp('ground') || (inp('dirt'))  :
                output.innerHTML = "Look, everyone loves some good dirt. But we got things to do here, people.";
                break;
            case  (inp('leaves')||inp('leaf'))  :
                output.innerHTML = "The ground is covered in a variety of leaves from all the different kinds of trees.";
                break;
            case (inp('pick')||inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab')||inp('put'))   &&    (inp('rock')||inp('stone')||inp('pebble'))  && haveRock=== true  :
                output.innerHTML = "You already have a <span>rock</span> in your <span>pocket</span>.<br><br>You can check your pockets by tpying <span>pockets</span> or <span>inventory</span>.";
                break;
            case (inp('rock')||inp('stone')||inp('pebble'))    :
                output.innerHTML = "What about the rocks?";
                break;

            // DEFAULT "LOOK"
            case (inp('inspect')||inp('see ')||inp('look')||inp('check')||inp('search')||inp('find'))   :
                output.innerHTML = "What do you want to look at?";
                break;

            // DEFAULT "SOMETHING"
            case (inp('take')||inp('gather')||inp('pocket')||inp('get')||inp('grab')||inp('put')) && (inp('thing')||inp('object')||inp('item')||inp('stuff') ) :
                output.innerHTML = "What do you want to take?";
                break;
            case inp('something')   :
                output.innerHTML = "Try looking around you, or interacting with objects.<br><br>You can move around the forest quickly by clicking in the corners of the screen above.";
                break;

            // DEFAULT QUESTION WORDS
            case  inp('what') && ((inp('going') && inp('on')) || inp('happen')):
                output.innerHTML = "You suddenly woke up in a strange forest. You can't really remember how you got here, but somehow you know the only way out is through that <span>door</span>.<br><br>Type \"<span>hint</span>\" at any time to get some help.";
                break;
            case  inp('what') && inp('do') && inp(' i ') :
                output.innerHTML = "You get the feeling the only way out is through that <span>door</span>.<br><br>Try typing different things into the prompt and seeing what happens.<br><br>You can type \"<span>hint</span>\" at any time to get some help.";
                break;
            case   inp('how') && inp('do') && inp(' i ') :
                output.innerHTML = "Try typing different things into the prompt and seeing what happens.<br><br>You can type \"<span>hint</span>\" at any time to get some help.";
                break;
            case  inp('how') && (inp('long')||inp('old')) && inp('door'):
                output.innerHTML = "Really old.";
                break;
            case  inp('where') && (inp('go')):
                output.innerHTML = "You can type things like \"<span>walk left</span>\" or \"<span>go north</span>\" to explore other parts of the forest. You can type \"<span>map</span>\" to get your bearings.";
                break;
            case  inp('where') && inp('am') && inp(' i'):
                output.innerHTML = "It's twilight. You're standing in a forest clearing, but you're not sure how you got here. In front of you, a <span>strange door</span> is standing in a grassy clearing surrounded by trees.<br><br>You have a feeling the only way out of here is through that <span>door</span>...";
                break;
            case  inp('where') && inp('am') && inp(' i'):
                output.innerHTML = "It's twilight. You're standing in a forest clearing, but you're not sure how you got here. In front of you, a <span>strange door</span> is standing in a grassy clearing surrounded by trees.<br><br>You have a feeling the only way out of here is through that <span>door</span>...";
                break;
            case  inp('who') && inp('am') && inp(' i'):
                output.innerHTML = "You're a traveller in a strange place.";
                break;
            case  inp('rules')  :
                output.innerHTML = "Type commands below to explore the forest and open the <span>door</span>.<br><br>You can move around quicker by tapping the corners of the screen above.<br><br>Don't forget to type<span>look around</span> when you enter a new area.";
                break;
            case inp('what') && inp('supposed'):
                output.innerHTML = "Type commands below to explore the forest and open the <span>door</span>.<br><br>You can move around quicker by tapping the corners of the screen above.<br><br>Some objects around you can be interacted with. You can type <span>pockets</span> to see what you have with you.<br><br>Don't forget to type<span>look around</span> when you enter a new area.";
                break;
            case inp('what') && inp('is') && inp('this'):
                output.innerHTML = "Try typing \"<span>look around</span>\" to get your bearings.";
                break;
            case inp('what') :
                output.innerHTML = "Try typing <span>look around</span>. Some objects can be interacted with by <span>looking</span> at them, <span>using</span> them, or <span>putting</span> them in you <span>pockets</span>.";
                break;
            case inp('where') :
                output.innerHTML = "Try looking around.";
                break;
            case inp('when') :
                output.innerHTML = "It's twilight, and the sun is just beginning to set.";
                break;
            case inp('why') :
                output.innerHTML = "This is a strange place. Maybe you can find some answers by looking around.";
                break;

            // CLEARING INVENTORY
            case inp('') && checkingInventory === true:
                checkingInventory = false;
                output.innerHTML = "";
                break;

            // CLEARING MAP
            case inp('') && checkingMap === true:
                output.innerHTML = "";
                checkingMap = false;
                // makeMapBright();
                break;
            
            // CLEARING DIALOGUE
            case inp('') && inDialogue === true:
                output.innerHTML = "";
                inDialogue = false;
                currentConversation = 26;
                break;

            
        // DEFAULT
            default:
                output.innerHTML = "Nothing happened.";
                break;
        };

        // INCREASE "THINGS TRIED"
        thingsTriedSinceLastBigThing++; // resets when the box is unlocked, fireflies released, and robot awakened.
        thingsTried++;
        
        // CLEAR INPUT FORM
        userInput.value = "";
        currentPage = 0;
        outputArea.scroll(0,0);
    };

// PRESSING ENTER 
    const pressEnter = () => {
        let fem = document.getElementById('userinput').value;
        if ((reading === true || readingAsk === true) && (fem ==""||inp("read"))) {
            showBookText();
            //document.getElementById("book").src="./inventoryimages/book.png";
        } else {
            processInput();
            reading = false;
            document.getElementById("book").src="";
            document.getElementById('map').classList.remove('blurless');
        };
        if (inventoryAsk === false) {checkingInventory = false};
        if (mapAsk === false) {checkingMap = false};
        if (dialogueAsk === false) {inDialogue = false};
    };

    enterButton.addEventListener('click', pressEnter);

    // from https://www.w3schools.com/howto/tryit.asp?filename=tryhow_js_trigger_button_enter
    var input = document.getElementById("userinput");
    input.addEventListener("keypress",
    function(event) {
        if (event.key === "Enter") {
            event.preventDefault();
            document.getElementById("enterbutton").click();
            // outputArea.scroll(0,0);
            hideMobileKeyboardOnReturn(input);
        }
    });

        // // hacky keyboard hide when soft keyboard "enter" is pressed, via https://andy-carter.com/blog/how-to-close-the-mobile-keyboard-on-return and https://stackoverflow.com/questions/41868060/how-to-run-some-javascript-code-only-on-small-screen-mobile-devices
        const hideMobileKeyboardOnReturn = (element) => {
            if ( 
                   navigator.userAgent.match(/Android/i)
                || navigator.userAgent.match(/webOS/i)
                || navigator.userAgent.match(/iPhone/i)
                || navigator.userAgent.match(/iPad/i)
                || navigator.userAgent.match(/iPod/i)
                || navigator.userAgent.match(/BlackBerry/i)
                || navigator.userAgent.match(/Windows Phone/i)
                ) {
            element.addEventListener('keyup', (keyboardEvent) => {
                const key = keyboardEvent.code || keyboardEvent.keyCode;
                if (key === 'Enter' || key === 13) {
                    element.blur();
                }
             });
        }};

</script>



</html>